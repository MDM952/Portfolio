<!DOCTYPE html>
<html lang="en" dir="ltr">

    <head>
        <meta charset="utf-8">
        <title>Projekt I üåê</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
        <link rel="stylesheet" href="css\modal.css">
        <link rel="stylesheet" href="css/css_project_page.css">
        <link rel="stylesheet" href="css/cssmaster.css">
        <link rel="icon" href="C:\Users\konra\Documents\W≈Çasne\Programowanie\HTML CSS Javascript Course\Web Developement 15\6 - Bootstrap Tindog\css\favicon.ico">
      
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Montserrat&display=swap" rel="stylesheet">
        <script src="https://kit.fontawesome.com/1c9ad4b785.js" crossorigin="anonymous"></script>

        <link rel="stylesheet" href="scripts\code highlight\styles\idea.min.css"/>
        <script src="scripts\code highlight\highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>

        <script type="text/javascript" id="MathJax-script" async
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
        </script>

        

      </head>
  <body>
      
    <section class="jumbotron text-center" id="top">
      <div class="container", style="padding: 40px;">
        <h2>Model przewidujƒÖcy ceny mieszka≈Ñ w Warszawie z uwzglƒôdnieniem odleg≈Ço≈õci</h2>
        <p class="lead text-muted">
          Autorski projekt z w≈Çasnorƒôcznie zebranymi danymi. 
          <br>
          Wizualizacja, analiza danych, przetwarzanie danych przestrzennych w QGIS, nauczanie maszynowe.<br>
        </p>

        <div style="height: 40px;"></div>

        <div class="container">
          <div class="row justify-content-md-center">
            <div class="col col-lg-4">
              <div class="accordion" id="accordionPanelsStayOpenExample" style="width: 450px;">
                <div class="accordion-item">
                  <h2 class="accordion-header" style="margin: auto;">
                    <button class="accordion-button" type="button" data-bs-toggle="collapse" 
                    data-bs-target="#panelsStayOpen-collapseTwelve" aria-expanded="true" aria-controls="panelsStayOpen-collapseTwelve">
                    Kontakt ‚Ü¥
                    </button>
                  </h2>
                  <div id="panelsStayOpen-collapseTwelve" class="accordion-collapse collapse" style="margin-top: 20px; margin-bottom: 20px">
                    <div class="accordion-body" style="padding: 5px" >
  <!-- The text field -->
  
                        <div class="container">
                          <div class="row" style="padding:0px">
                            <div class="col">

                              <div style="margin: auto; padding: auto;">
                                <input type="text" 
                                id="myInput" 
                                class="form-control form-control-sm" 
                                value="konrad.jarominiak0@gmail.com" disabled
                               style="width: 220px">
                              </div>


                            </div>
                            <div class="col">

                              <div style="margin: auto; padding: auto;">
                                <button type="button" class="btn btn-outline-secondary btn-sm" style="width: 140px; margin: 0;" onclick="myFunction()">skopiuj do schowka</button>
                              </div>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col">
                              <div style="width: 220px; margin-top: 10px;">
                                <a
                                href="https://www.linkedin.com/in/konrad-jarominiak-941ba0294/"
                                class="btn btn-outline-primary btn-sm"
                                style="width: 120px; border-color: #0a66c2; "
                                >
                                LinkedIn
                                </a>
                              </div>

                              </div>
                            <div class="col">
                               
                            </div>
                          </div>
                        </div>
  
  
  
  
  <!-- The button used to copy the text -->
  
  
  <!-- The toast -->
                        <div aria-live="polite" aria-atomic="true" style="position: relative; min-height: 0px;">
                          <div class="toast" style="position: absolute; top: 0px; right: 0; width:250px">
                            <div class="toast-body">
                              Skopiowano do schowka!
                            </div>
                          </div>
                        </div>
                        
                    </div>
                  </div>
                </div>
    
              </div>   
            </div>

            <div class="col col-lg-4">
              

              <div style="width: 450px; padding-top: 15px; padding-bottom: 15px;">
                <a
                href="index.html"
                class="btn btn-secondary my-2"
                >Powr√≥t do strony g≈Ç√≥wnej</a>
              </div>

            </div>
          </div>
        </div>


        <div class="true_center">
          <div class="row" style="margin:margin-top: 40px; width: 100%">
            <div class="col col-sm">
           </div>
            <div class="col col-sm">

            </div>
          </div>
        </div>





        

      </div>
  </section>

    <span class="border border-0">

    <div class="container">
      <div class="row">
        <div class="col-md-9">

          <div class="tresc wstep">
            <h4 id="wstep-header">1. Wstƒôp</h4>
            Niniejszy projekt data science ma na celu przedstawienie prostego sposobu na wykorzystanie danych przestrzennych w modelowaniu data science.
            W projekcie sprawdzono jak du≈ºe znaczenie odgrywa odleg≈Ço≈õƒá mieszkania do centrum miasta i
             do najbli≈ºszej stacji metra na rynku mieszkaniowym w Warszawie. 
            W projekcie wykorzystano:
<li>Selenium i Beautiful Soup w celu zebrania danych</li>
<li>SQLAlchemy do przechowania danych w bazie danych</li>
<li>GIS do wyznaczenia odleg≈Ço≈õci oraz przedstawienia mieszka≈Ñ z zebranych ofert na mapie Warszawy</li>
<li>Pandas do przetworzenia i oczyszczenia danych</li>
<li>Matplotlib i Seaborn do wizualizacji danych</li>
<li>sci-kit learn i TensorFlow Keras do stworzenia modeli</li>

          </div>

          <div class="tresc zebranie_danych">
            <h4 id="zebranie_danych-header">2. Zebranie danych</h4>

            Do zebrania danych wstƒôpnych danych wykorzystano Selenium webdriver, czyli narzƒôdzie umo≈ºlwiajƒÖce zautomatyzowanie funkcjonalno≈õci przeglƒÖdarki. 
            Wstƒôpne dane (indeksy, linki i powiat) zebrano z pewnej strony z ofertami mieszka≈Ñ z wynikami dla Warszawy. 
            Wykorzystano tu Selenium ze wzglƒôdu na fakt, ≈ºe oferty ≈Çadowane sƒÖ wraz z przewijaniem strony przez u≈ºytkownika ‚Äì Beautiful Soup nie wy≈Çapa≈Çoby ≈ºadnych ofert.
            Dane przechowano przy pomocy SQLAlchemy:
            <pre><code> <!-- Kod bazy danych -->
class Links(Base):  
    __tablename__ = "Links"  
    numer = Column("numer", Integer, primary_key=True)  
    powiat = Column("powiat", String)  
    link = Column("link", String)  

    def __init__(self, numer, powiat, link):  
        self.numer = numer  
        self.link = link  
        self.powiat = powiat  

    def __repr__(self):  
        return f"({self.numer}, {self.powiat}, {self.link})"
            </code></pre>
            W sumie uzyskano 3600 link√≥w, z czego czƒô≈õƒá zawiera≈Ça linki do ofert poza WarszawƒÖ, 
            kt√≥re uwzglƒôdniono w mapie utworzonej w QGIS.
            <br>
            Do zebrania szczeg√≥≈Çowych danych r√≥wnie≈º zastosowano Selenium. 
            Web scraping przy pomocy Beautiful Soup by≈Çby szybszy i o wiele prostszy, ale nie umo≈ºliwi≈Çby zebrania wsp√≥≈Çrzƒôdnych z zaembedowanej mapy google. 
            Bez przewijania strony, poni≈ºsza mapa nie by≈Çaby widoczna i mo≈ºliwa do zescrapowania.
            <img src="css\p1_images\embed mapy googli.png" style="margin: 36px; ;">
            <br>
            Zbierania wsp√≥≈Çrzƒôdnych dokonywano przy pomocy poni≈ºszego kodu:
            <pre><code> <!-- Kod dla zbierania LATT LONG-->
try:  
    driver.execute_script("arguments[0].scrollIntoView();",  
                          driver.find_element(By.ID, 'map')  
                          )  
except NoSuchElementException:  
    driver.refresh()  
    driver.execute_script("arguments[0].scrollIntoView();",  
                          driver.find_element(By.ID, 'map')  
                          )
# ...
map_link = driver.find_element(By.XPATH, "//a[contains(@href,'apiv3')]")  
coord = map_link.get_attribute('href').split('ll=')[1].split('&')[0].split(',')  
coord_dict = {  
    'lat': float(coord[0]),  
    'long': float(coord[1])  
    }  
            </code></pre>
            Pozosta≈Çe dane zbierane by≈Çy g≈Ç√≥wnie w nastƒôpujƒÖcy spos√≥b: dla ka≈ºdego elementu z listy `all_topics` zbierano warto≈õƒá z tabeli szczeg√≥≈Ç√≥w na stronie. 
            W przyk≈Çadzie dla g≈Ç√≥wnych informacji nie zdarza≈Ço siƒô aby funkcja separujƒÖca dane z tekstu zwraca≈Ça warto≈õƒá `None`, zamiast tego zwraca≈Ça 'Zapytaj' 
            gdy danych nie doprecyzowano. W sekcji oczyszczania danych te dane zosta≈Çy poprawione i zastƒÖpione. 
            <br>
            <pre><code> <!-- Kod dla zbierania danych g≈Ç√≥wnych -->
def separate_value(text, topic):  
    try:  
        value = text.find_element(By.CSS_SELECTOR, f'div[aria-label="{topic}"]')  
        value = value.text.split(topic)[1].replace('\n', '')  
        return value  
    except NoSuchElementException:  
        return None  
  
  
all_topics = ["Powierzchnia", "Liczba pokoi", "Piƒôtro", "Powierzchnia dzia≈Çki", 
              "Czynsz", "Forma w≈Çasno≈õci", "Stan wyko≈Ñczenia",  
              "Balkon / ogr√≥d / taras", "Miejsce parkingowe", "Ogrzewanie"]  
  
try:  
    main_info_dict = driver.find_element(By.CSS_SELECTOR, 'div[data-testid="ad.top-information.table"]')  
except NoSuchElementException:  
    driver.refresh()  
    collect_info(link, numer)  
    return  
  
main_dict = {}  
for topic in all_topics:  
    main_dict[topic] = separate_value(main_info_dict, topic)
            </code></pre>
            W≈õr√≥d wszystkich ofert znalaz≈Ça siƒô niema≈Ça ilo≈õƒá ofert deweloper√≥w, w≈õr√≥d kt√≥rych nie zosta≈Çy podane ≈ºadne dane z informacji dodatkowych, 
            np. rynek wt√≥rny/pierwotny, winda czy rodzaj zabudowy. Te dane r√≥wnie≈º uzupe≈Çniono w sekcji oczyszczania danych.

            Zapisania danych ofert dokonano w ten sam spos√≥b co przy zbieraniu samych ofert i da≈Ço poni≈ºszƒÖ tabelƒô, wy≈õwietlanƒÖ w SQLLiteStudio:
            <br><br>
            <img src="css\p1_images\SQL dane szczeg√≥≈Çowe.png" style="width: 98%;">
          </div>

          <div class="tresc przetworzenie_w_QGIS">
            <h4 id="QGIS-header">3. Mapa i przetworzenie danych w QGIS</h4>
            Tabelƒô zawierajƒÖcƒÖ szczeg√≥≈Çowe dane za≈Çadowano do programu QGIS wraz warstwƒÖ dzielnic Warszawy oraz stacji metra. 
            Do wyznaczenia odleg≈Ço≈õci wykorzystano dwa narzƒôdzia wektorowe: 
            <li>
            liniowa odleg≈Ço≈õƒá do najbli≈ºszego huba, do obliczenia odleg≈Ço≈õci do centrum Warszawy 
            (na potrzeby tego projektu uznano stacjƒô ≈öwiƒôtokrzyskƒÖ za centrum)
            </li>
            <li>
            macierz odleg≈Ço≈õci do obliczenia odleg≈Ço≈õci do najbli≈ºszej stacji metra, 
            tu obliczono odleg≈Ço≈õci do najbli≈ºszych piƒôciu, a nastƒôpnie przefiltrowano tabelƒô
            </li>
            Efektem przetworzenia danych w QGIS jest mapa mieszka≈Ñ oraz dwie nowe kolumny z odleg≈Ço≈õciami, kt√≥re zosta≈Çy wykorzystane w modelowaniu. 
            Kilka mieszka≈Ñ w okolicach Ursynowa nie zosta≈Ço poprawnie przefiltrowanych, niemniej nie powinny mieƒá one znaczenia, ze wzglƒôdu na ich niedu≈ºƒÖ odleg≈Ço≈õƒá od stacji metra.
          
            <br><br>


            <img class="myImg" src="css\p1_images\Warszawa.png"  style="width: 95%;">
            <div id="myModal" class="modal">
              <div class="opacity-background close">
                <span class="close">&times;</span>
              </div>
              <img class="modal-content" id="img01">
              <div id="caption"></div>
            </div>


          </div>

          <div class="tresc oczyszczenie_danych">
            <h4 id="pandas-header">4. Oczyszczenie danych w Pandas</h4>
            Wstƒôpne sprawdzenie rodzaju danych w tabeli przedstawia siƒô nastƒôpujƒÖco:
            <pre><code class="language-python"> <!-- kod typy danych -->
              numer int64 
              link object 
              Cena int64 
              powierzchnia object 
              powierzchnia_dzialki float64 
              lokalizacja object 
              n_pokojow int64 pietro object 
              czynsz object 
              wlasnosc object 
              wykonczenie object 
              zewnatrz object # taras, ogr√≥d, balkon
              parking object 
              ogrzewanie object 
              rynek object 
              ogloszenie object 
              rok_budowy object 
              zabudowa object 
              winda object 
              latt float64 
              long float64 
              Dystans do Swietokrzyskiej float64 
              najblizsza stacja object 
              dystans do najblizszej stacji [m] float64
              dtype: object
            </code></pre>

            Oczyszczenie danych polega≈Ço na:
            <ol>
              <li>
                Zamianie warto≈õci na dane liczbowe, w przypadku kolumn takich jak cena czy powierzchnia wymaga≈Ço usuniƒôcia element√≥w z tektstu takich jak m¬≤, 
                zamianie przecink√≥w na kropki i og√≥lnƒÖ zmianƒô typu danych na int i float
              </li>
              <li>
                Zamianie p√≥l z 'Zapytaj' i NaN czyli niereprezentowalnych brakujƒÖcych warto≈õci na 
                takie kt√≥re mia≈Çy sens w kontek≈õcie tabeli i danego wiersza np.:
                <pre><code class="language-python"> <!-- kod blok a winda -->
blok_a_winda = {0:None, 1:'blok'}
df['zabudowa'] = df['zabudowa'].fillna(df['winda'].map(blok_a_winda))
                </code></pre>
                Innym przyk≈Çadem uzupe≈Çnienia danych jest wykorzystanie Beautiful Soup. 
                Przy pomocy tego scrapera sprawdzono, czy opis oferty zawiera wyra≈ºenia takie jak 'wymaga remontu' i uzupe≈Çniono kolumny.
                <pre><code class="language-python"> <!-- kod BS4 i remont -->
def parse_remont(link):
    response = requests.get(link, headers=HEADERS)
    soup = BeautifulSoup(response.content, 'html.parser')
    
    try:
        opis = soup.find('div',{'data-cy':'adPageAdDescription'}).text
        ad_title = soup.find('h1',{'data-cy':'adPageAdTitle'}).text
    except AttributeError: # przypadki gdy oferta zosta≈Ça usuniƒôta
        return
        
    lista_remont = ['do remontu', 'wymaga remontu', 'wymagajƒÖce remontu', 'wymagajƒÖcy remontu', 
                    'czƒô≈õciowego remontu', 'generalnego remontu', 
                    'ca≈Çkowitego remontu', 'do odnowy', 'do odnowienia', ]

    for r in lista_remont:
        if r in ad_title or r in opis:
            return 'do remontu'
        else:
            return 'do zamieszkania'
            
df.loc[df['wykonczenie'] == 'Zapytaj', 'wykonczenie'] 
= df.loc[df['wykonczenie'] == 'Zapytaj', 'link'].apply(lambda x: parse_remont(x))
                </code></pre>
              </li>
              <li>
                Usuniƒôto zbƒôdne kolumny i kolumny ze zbyt du≈ºƒÖ ilo≈õciƒÖ brakujƒÖcych danych, np. 'w≈Çasno≈õƒá' czy 'og≈Çoszenie'
              </li>
              <li>
                Zastosowano OneHotEncoding przy pomocy pandas.get_dummies - z kolumny 'zabudowa' utworzono cztery nowe kolumny: 'apartamentowiec', 'blok', 'dom', 'kamienica'. Je≈ºeli dane mieszkanie znajduje siƒô w bloku, w kolumnie 'blok' bƒôdzie warto≈õƒá 1, a w pozosta≈Çych 0.
                <br>
                W przypadku kolumny 'zewnƒÖtrz' zastosowano w≈Çasne funkcje do uzupe≈Çnienia kolumn, ze wzglƒôdu na fakt, ≈ºe w jednym mieszkaniu mo≈ºe wystƒôpowaƒá kilka opcji np. balkon i taras jednocze≈õnie:
                <pre><code class="language-python"> <!-- kod dummies dla zewnƒÖtrz1 -->
def get_balkon(text):
    if 'balkon' in text:
        return 1
    else:
        return 0

def get_ogrod(text):
    if 'ogr√≥dek' in text:
        return 1
    else:
        return 0

def get_taras(text):
    if 'taras' in text:
        return 1
    else:
        return 0

df["balkon"] = df["zewnatrz"].apply(lambda x: get_balkon(x))
df["ogrod"] = df["zewnatrz"].apply(lambda x: get_ogrod(x))
df["taras"] = df["zewnatrz"].apply(lambda x: get_taras(x))
                </code></pre>                
              </li>

            </ol>



          </div>

          <div class="tresc AKORDEONY"> <!-- PoczƒÖtek wizualizacji i akordeonu -->
            <h4 id="wizualizacja-header">5. Wizualizacja danych</h4>




            
          <div class="accordion" id="accordionPanelsStayOpenExample"> 
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button" type="button" data-bs-toggle="collapse"
                  data-bs-target="#panelsStayOpen-collapseOne" aria-expanded="true" aria-controls="panelsStayOpen-collapseOne">
                  <img src="css\p1_images\Histogram cen.png" style="max-width:100%" alt="">
                </button>
              </h2>
              <div id="panelsStayOpen-collapseOne" class="accordion-collapse collapse">
                <div class="accordion-body">
                  <pre><code class="language-python">
sns.set_style("ticks")
fig, ax = plt.subplots(figsize=(9,6),)
ax.set_ylabel("Czƒôsto≈õƒá")
sns.histplot(df['Cena'], color='olivedrab').set_title('Histogram cen')
                                                </code></pre>
                </div>
              </div>
            </div>
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                  data-bs-target="#panelsStayOpen-collapseTwo" aria-expanded="false" aria-controls="panelsStayOpen-collapseTwo">
                  <img src="css\p1_images\Pude≈Çkowy cen dzielnice.png" style="max-width:100%" alt="">
                </button>
              </h2>
              <div id="panelsStayOpen-collapseTwo" class="accordion-collapse collapse">
                <div class="accordion-body">
                  <pre><code class="language-python">
fig, ax = plt.subplots(figsize=(9,6))
plt.xticks(rotation=-66)
chart  = sns.boxplot(data=df, y='Cena', x='lokalizacja', 
    order=df.groupby('lokalizacja').median()['Cena'].sort_values(ascending=True).index.tolist(),)
    
f = lambda x, pos: f'{x/10**6:,.0f}M'
chart.yaxis.set_major_formatter(ticker.FuncFormatter(f))
chart.set(xlabel='Dzielnica', ylabel='Cena')
chart.set_title('Wykres pude≈Çkowy cen w zale≈ºno≈õci od dzielnicy')
                                                </code></pre>
                </div>
              </div>
            </div>
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                  data-bs-target="#panelsStayOpen-collapseThree" aria-expanded="false"
                  aria-controls="panelsStayOpen-collapseThree">
                  <img src="css\p1_images\Pude≈Çkowy cen dzielnice mini.png" style="max-width:100%" alt="">
                </button>
              </h2>
              <div id="panelsStayOpen-collapseThree" class="accordion-collapse collapse">
                <div class="accordion-body">
                  <pre><code class="language-python">
sns.set_style("ticks")
fig, ax = plt.subplots(figsize=(9,6))
plt.xticks(rotation=-60)

chart  = sns.boxplot(data=df.drop(df[df.Cena >= 2500000].index), y='Cena', x='lokalizacja', 
    order=df.drop(df[df.Cena >= 2500000].index).groupby('lokalizacja')
    .median()['Cena'].sort_values(ascending=True).index.tolist(),
    )

f = lambda x, pos: f'{x/10**6:,.1f}M'
chart.yaxis.set_major_formatter(ticker.FuncFormatter(f))

chart.set(xlabel='Dzielnica', ylabel='Cena')
chart.set_title('Wykres pude≈Çkowy cen w zale≈ºno≈õci od dzielnicy')
                  </code></pre>
                </div>
              </div>
            </div>

            <li class="opis_wiz">
              Najta≈Ñsza oferta to lokal us≈Çugowy w Weso≈Çej, o powierzchni 20 m¬≤, kt√≥ry mo≈ºe pe≈Çniƒá funkcjƒô mieszkalnƒÖ, do wyko≈Ñczenia, nieca≈Çe 13 km od stacji ≈öwiƒôtokrzyska. Niska cena wydaje siƒô uzasadniona.
            </li>
          </div>


          <div class="accordion" id="accordionPanelsStayOpenExample">
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button" type="button" data-bs-toggle="collapse" 
                data-bs-target="#panelsStayOpen-collapseFour" aria-expanded="true" aria-controls="panelsStayOpen-collapseFour">
<img src="css\p1_images\Pude≈Çkowy powierzchni dzielnice mini.png"  alt="">
                </button>
              </h2>
              <div id="panelsStayOpen-collapseFour" class="accordion-collapse collapse">
                <div class="accordion-body">
                  <pre><code class="language-python">
fig, ax = plt.subplots(figsize=(9,6))
plt.xticks(rotation=-66)

chart  = sns.boxplot(data=df, y='powierzchnia', x='lokalizacja', 
    order=df.groupby('lokalizacja').median()['powierzchnia'].sort_values(ascending=True).index.tolist(),
    palette='tab20b'
    )

chart.set(xlabel='Dzielnica', ylabel='Powierzchnia [m¬≤]')
chart.set_title('Wykres pude≈Çkowy powierzchni w zale≈ºno≈õci od dzielnicy')
                                      </code></pre>
                </div>
              </div>
            </div>
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button" type="button" data-bs-toggle="collapse" 
                data-bs-target="#panelsStayOpen-collapseFive" aria-expanded="true" aria-controls="panelsStayOpen-collapseFive">
<img src="css\p1_images\Histogram powierzchni.png" style="max-width: 100%;" alt="">
                </button>
              </h2>
              <div id="panelsStayOpen-collapseFive" class="accordion-collapse collapse">
                <div class="accordion-body">
                  <pre><code class="language-python">
fig, ax = plt.subplots(figsize=(9, 6))
ax.set_ylabel("Czƒôsto≈õƒá")
chart =sns.histplot(df['powierzchnia'], bins=57, edgecolor=None, element='step', color='navy')
chart.set_title('Histogram powierzchni')
chart.set(xlabel='Powierzchnia [m¬≤]', ylabel='Czƒôsto≈õƒá')
                                      </code></pre>
                </div>
              </div>
            </div>
          </div>
          <li class="opis_wiz">
            Wykres wyra≈∫nie wsp√≥≈Çkszta≈Çtny do histogramu cen - wiƒôkszo≈õƒá ofert to mieszkania do 100 m¬≤ w cenie do 1-1,2 mil z≈Ç.           
          </li>

          <div class="accordion" id="accordionPanelsStayOpenExample">
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button" type="button" data-bs-toggle="collapse" 
                data-bs-target="#panelsStayOpen-collapseSix" aria-expanded="true" aria-controls="panelsStayOpen-collapseSix">
<img src="css\p1_images\XY sq i n pokoi.png" style="max-width:100%" alt="">
                </button>
              </h2>
              <div id="panelsStayOpen-collapseSix" class="accordion-collapse collapse">
                <div class="accordion-body">
                  <pre><code class="language-python">
# Kod tylko dla lewego wykresu
chart = sns.jointplot(data=df, x='powierzchnia', y='Cena', 
                      hue='zabudowa', kind='scatter', cmap='Mako', 
ylim=(-1500000, 16000000), xlim=(-50, 500), linewidth = 0, height=8,
palette={"apartamentowiec": "slateblue", 
         "blok": "tan", 
         "kamienica": "mediumaquamarine", 
         "dom": "crimson"})
f = lambda x, pos: f'{x/10**6:,.0f}M'
chart.ax_joint.yaxis.set_major_formatter(ticker.FuncFormatter(f))
chart.ax_joint.set_xlabel("Powierzchnia [m¬≤]")
chart.ax_joint.set_ylabel("Cena [z≈Ç]")
                                      </code></pre>
                </div>
              </div>
            </div>
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button" type="button" data-bs-toggle="collapse" 
                data-bs-target="#panelsStayOpen-collapseSeven" aria-expanded="true" aria-controls="panelsStayOpen-collapseSeven">
<img src="css\p1_images\XY sq i dystans.png" style="max-width:100%" alt="">
                </button>
              </h2>
              <div id="panelsStayOpen-collapseSeven" class="accordion-collapse collapse">
                <div class="accordion-body">
                  <pre><code class="language-python">
# Kolumny nie uwzglƒôdnione w modelowaniu
df['Przedzia≈Ç km do ≈öwiƒôtokrzyskiej'] = df['Dystans do Swietokrzyskiej'] / 1000
df['Przedzia≈Ç km do ≈öwiƒôtokrzyskiej'] = df['Przedzia≈Ç km do ≈öwiƒôtokrzyskiej'].apply(np.floor).astype('int')
df['Przedzia≈Ç km do najbli≈ºszej stacji'] = df['dystans do najblizszej stacji [m]'] / 1000
df['Przedzia≈Ç km do najbli≈ºszej stacji'] = df['Przedzia≈Ç km do najbli≈ºszej stacji'].apply(np.floor).astype('int')
# Kod tylko dla prawego wykresu
chart = sns.jointplot(data=df, x='powierzchnia', y='Cena', hue='Przedzia≈Ç km do najbli≈ºszej stacji', kind='scatter', 
              ylim=(-1500000, 16000000), xlim=(-50, 500), linewidth = 0, height=6,
              palette="mako")
f = lambda x, pos: f'{x/10**6:,.0f}M'
plt.legend(title="Przedzia≈Ç km do najbli≈ºszej stacji", labels=['0-2 km', '2-5 km', '5-7 km', '10-12 km', '10-12 km'])
chart.ax_joint.yaxis.set_major_formatter(ticker.FuncFormatter(f))
chart.ax_joint.set_xlabel("Powierzchnia [m¬≤]")
chart.ax_joint.set_ylabel("Cena [z≈Ç]")

                                      </code></pre>
                </div>
              </div>
            </div>
          </div>


          <li class="opis_wiz">
            Rozrzut cen w stosunku do powierzchni jest do≈õƒá znaczny, oznacza to, ≈ºe na cenƒô r√≥wnie≈º wp≈Çywa wiele innych czynnik√≥w  - 
            tu np. widaƒá ≈ºe aparatamenty cechujƒÖ siƒô wy≈ºszƒÖ cenƒÖ ni≈º inne rodzaje zabudowy, a mieszkania z dala od stacji (dzielnice Weso≈Ça, Wawer) majƒÖ wyra≈∫nie ni≈ºsze ceny.
          </li>
          <li class="opis_wiz">
            Oferta mieszkania z dwoma pokojami i powierzchniƒÖ 216 m¬≤ to lokal mieszkalny o powierzchni 116 m¬≤ wraz z lokalem us≈Çugowym 100 m¬≤, k√≥ry wymaga wyko≈Ñczenia. 
            <br>Oferta zosta≈Ça usuniƒôta pzed modelowaniem. 
          </li>


          <div class="accordion" id="accordionPanelsStayOpenExample">
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button" type="button" data-bs-toggle="collapse" 
                data-bs-target="#panelsStayOpen-collapseSeven" aria-expanded="true" aria-controls="panelsStayOpen-collapseSeven">
<img src="css\p1_images\Histogram zabudowa.png" style="max-width:100%" alt="">                </button>
              </h2>
              <div id="panelsStayOpen-collapseSeven" class="accordion-collapse collapse">
                <div class="accordion-body">

                  <pre><code>
fig, ax = plt.subplots(figsize=(9,6))
plt.xticks(rotation=-60)
chart = sns.histplot(
    df,
    x="lokalizacja", hue="zabudowa",
    multiple="stack",
    palette="viridis",)
chart.set_title('Rodzaj zabudowy')
chart.set(xlabel='Dzielnica', ylabel='Ilo≈õƒá')
                  </code></pre>

                </div>
              </div>
            </div>
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" 
                data-bs-target="#panelsStayOpen-collapseEight" aria-expanded="false" aria-controls="panelsStayOpen-collapseEight">
<img src="css\p1_images\Kolumnowy stan mieszka≈Ñ.png" style="max-width:100%" alt="">
                </button>
              </h2>
              <div id="panelsStayOpen-collapseEight" class="accordion-collapse collapse">
                <div class="accordion-body">

                  <pre><code>
fig, ax = plt.subplots(figsize=(9,6))
plt.xticks(rotation=-60)
chart = sns.histplot(
    df,
    x="lokalizacja", hue="wykonczenie",
    multiple="stack",
    palette="flare",)
chart.set_title('Stan mieszka≈Ñ')
chart.set(xlabel='Dzielnica', ylabel='Ilo≈õƒá')
                  </code></pre>

                </div>
              </div>
            </div>
          </div>
          <li class="opis_wiz">
            Du≈ºa ilo≈õƒá mieszka≈Ñ do wyko≈Ñczenia na Ursusie to osiedle jednego dewelopera z liczbƒÖ ok. 120 ma≈Çych mieszka≈Ñ oznaczonych jako apartmanety.
            <br>
          </li>
<br>
          
          <div class="accordion" id="accordionPanelsStayOpenExample">
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button" type="button" data-bs-toggle="collapse" 
                data-bs-target="#panelsStayOpen-collapseTen" aria-expanded="true" aria-controls="panelsStayOpen-collapseTen">
<img src="css\p1_images\Odleg≈Ço≈õci.png" style="max-width:100%" alt="">               </button>
              </h2>
              <div id="panelsStayOpen-collapseTen" class="accordion-collapse collapse">
                <div class="accordion-body">
<pre><code>
  fig, ax = plt.subplots(figsize=(9,6))
  sns.histplot(df['Dystans do Swietokrzyskiej'],  
                      label="L do stacji ≈öwiƒôtokrzyska", 
                      kde=False, element="step", 
                      alpha=0.3)
  sns.histplot(df["dystans do najblizszej stacji [m]"],  
                      label="L do najbli≈ºszej stacji metra [m]", 
                      kde=False, element="step", alpha=0.3)
  ax.set_title('Odleg≈Ço≈õci do stacji metra')
  ax.set(xlabel='Odleg≈Ço≈õƒá [m]', ylabel='Czƒôsto≈õƒá')
  plt.legend() 
</code></pre>                </div>
              </div>
            </div>
          </div>

<br>

          <div class="accordion" id="accordionPanelsStayOpenExample">
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button" type="button" data-bs-toggle="collapse" 
                data-bs-target="#panelsStayOpen-collapseNine" aria-expanded="true" aria-controls="panelsStayOpen-collapseNine">
<img src="css\p1_images\Korelacje.png" style="max-width: 100%;">                </button>
              </h2>
              <div id="panelsStayOpen-collapseNine" class="accordion-collapse collapse">
                <div class="accordion-body">
<pre><code>
  fig, ax = plt.subplots(figsize=(9,8))
sns.heatmap(df.corr(), cmap='RdBu_r', annot=True, annot_kws={"fontsize":7},
    fmt=".2f",
    xticklabels=['Cena', 'Powierzchnia', 'Liczba pokoj√≥w', 'Piƒôtro', 'Parking', 'Rok budowy', 
    'Winda', '[m] do Centrum', '[m] do najbli≈ºszej stacji', 'Balkon', 'Ogr√≥d', 'Taras', 'Do remontu',
    'Do wyko≈Ñczenia', 'Do zamieszkania', 'Rynek pierwotny', 'Rynek wt√≥rny', 'Apartamentowiec', 'Blok', 'Dom', 'Kamienica'],
    yticklabels=['Cena', 'Powierzchnia', 'Liczba pokoj√≥w', 'Piƒôtro', 'Parking', 'Rok budowy', 
    'Winda', '[m] do Centrum', '[m] do najbli≈ºszej stacji', 'Balkon', 'Ogr√≥d', 'Taras', 'Do remontu',
    'Do wyko≈Ñczenia', 'Do zamieszkania', 'Rynek pierwotny', 'Rynek wt√≥rny', 'Apartamentowiec', 'Blok', 'Dom', 'Kamienica'])
</code></pre>                </div>
              </div>
            </div>
          </div>


          <br>
          <div class="wiz_uwagi">
            <h6 id="uwagi-header">Uwagi dotyczƒÖce korelacji</h6>
            <li>Wykres korelacji reprezentuje zale≈ºno≈õci warto≈õci miƒôdzy atrybutami. Je≈ºeli warto≈õƒá jest pozytywna, oznacza to ≈ºe wraz ze wzrostem warto≈õci w danej kolumnie, warto≈õƒá w danym wierszu r√≥wnie≈º wzro≈õnie, je≈ºeli bƒôdzie ujemna, zmaleje. Warto≈õci korelacji bli≈ºej 0 oznaczajƒÖ, ≈ºe  atrybut ma ma≈Çe znaczenie. 
            </li>
            <li>Pierwszym wartym zaznaczenia wnioskiem jest fakt, ≈ºe atrybuty odleg≈Ço≈õci do centrum i najbli≈ºszej stacji metra majƒÖ niema≈Çe znaczenie - sƒÖ to jedne z wiƒôkszych wynik√≥w (-0,24 i -0,2) po najwy≈ºej korelujƒÖcymi z cenƒÖ powierzchniƒÖ i liczbƒÖ pokoi. 
            </li>
            <li>Innymi znaczƒÖcymi atrybutami sƒÖ rodzaje zabudowy, w szczeg√≥lno≈õci blok (cena maleje) i apartamentowiec (cena ro≈õnie). Znaczna wiƒôkszo≈õƒá najdro≈ºszych mieszka≈Ñ by≈Ça apartamentowcami.
            </li>
            <li>Dom okaza≈Ç siƒô nieistotny, trzeba r√≥wnie≈º zaznaczyƒá, ≈ºe ilo≈õƒá ofert dom√≥w (tu po≈ÇƒÖczono domy wolnostojƒÖce i szeregowce) by≈Ça niedu≈ºa. Mo≈ºliwe, ≈ºe uwzglƒôdnienie teren√≥w takich jak podmiejskie rejony Piaseczna z wieloma osiedlami dom√≥w jednorodzinnych da≈Çyby bardziej interesujƒÖce wyniki. 
            </li>
            <li>Co prawda jest zauwa≈ºalna bardzo du≈ºa korelacja miƒôdzy rokiem budowy a kamienicƒÖ, mo≈ºna przypuszczaƒá ≈ºe powinna byƒá jeszcze wiƒôksza. W≈õr√≥d ofert znajdowa≈Ço siƒô kilka kamienic, gdzie za rok budowy najprawdopodobniej podano rok generalnego remontu.
            </li>
            <li>InteresujƒÖca jest r√≥wnie≈º bliska zeru korelacja miƒôdzy tarasem a domem. Taras ma r√≥wnie≈º do≈õƒá wysokƒÖ korelacjƒô z cenƒÖ, powierzchniƒÖ i apartamentowcem, wiƒôc mo≈ºliwe jest ≈ºe dotyczƒÖ one np. rozleg≈Çych taras√≥w na dachach budynk√≥w.
            </li>
            <li>Stan mieszkania okaza≈Ç siƒô r√≥wnie≈º do≈õƒá nieznaczny w stosunku do ceny, niemniej rozk≈Çad korelacji - negatywny dla stanu do remontu i do wyko≈Ñczenia i pozytywny dla stanu do zamieszkania jest logiczny.
            </li>
          </div>
          
          <br> <br>
          Na ko≈Ñcu wykonano prosty Dashboard w programie Power BI. 
          Dziƒôki zastosowaniu etykietek, po przefiltrowaniu np. mieszka≈Ñ w odleg≈Ço≈õci do 1,5 km od stacji metra, mo≈ºna wyeksportowaƒá tabelƒô z linkami do takich ofert.
          <br>

          <div class="center"; style="height: 364px; width: 644px; border:solid; border-color: black; border-width: 2px;">
            <div style="position:relative;width:fit-content;height:fit-content;">
              <a style="position:absolute;top:20px;right:1rem;opacity:0.8;" href="https://clipchamp.com/watch/brMlZsUl7Ua?utm_source=embed&utm_medium=embed&utm_campaign=watch">
                  <img loading="lazy" style="height:22px;" src="https://clipchamp.com/e.svg" alt="Made with Clipchamp" />
              </a>
              <iframe allow="autoplay;" allowfullscreen style="border:none" src="https://clipchamp.com/watch/brMlZsUl7Ua/embed" width="640" height="360"></iframe>
          </div>
        </div>


          </div>

          <div class="tresc modelowanie">
            <h4 id="modelowanie-header">Modelowanie</h4>
            Po oczyszczeniu danych pozosta≈Ço tylko dobranie danych dla wytrenowania modelu.
            Modelowanie przeprowadzono przy pomocy prostej regresji liniowej z biblioteki scikit-learn oraz sieci neuronowej TensorFlow. 
            <br><br>
            Regresja liniowa polega na znalezieniu zale≈ºno≈õci miƒôdzy warto≈õciƒÖ przewidywanƒÖ (zmienna obja≈õniana)
            a predyktorami (zmienne obja≈õniajƒÖce) poprzez dopasowanie wag predyktor√≥w. 
            R√≥wnanie regresji liniowej przedstawia siƒô nastƒôpujƒÖco:

            $$y = Œ≤_0 + Œ≤_1 x_1 + Œ≤_2 x_2 + \dots + Œ≤_n x_n + \epsilon$$

            gdzie: 
            <li>\(y\) to zmienna obja≈õniana, zale≈ºna, to co model przewiduje</li>
            <li>\(x_i\) to zmienna obja≈õniajƒÖca, niezale≈ºna, inaczej predyktor</li>
            <li>\(Œ≤_i\) to wsp√≥≈Çczynnik kierunkowy regresji, element kt√≥ry dobiera model podczas trenowania </li>
            <li>\(\epsilon\) to nieskracalny b≈ÇƒÖd modelu</li>            
 
            <br>
            Z kolei sieƒá neuronowa na≈õladuje dzia≈Çanie ludzkiego m√≥zgu - jest zbudowana z wielu poziom√≥w neuron√≥w przetwarzajƒÖcych dane. 
            Ka≈ºdy pojedynczy neuron w danym poziomie jest po≈ÇƒÖczony ze wszystkimi neuronami w sƒÖsiadujƒÖcych poziomach. 
            Proces modelowania przy pomocy sieci neuronowej zaczyna siƒô wprowadzaniem danych w warstwie wej≈õciowej,
            nastƒôpnie nastƒôpuje propagacja w prz√≥d, dane sƒÖ przekazywane kolejnym neuronom w kolejnych warstwach, wraz dobraniem wagi dla danego parametru.
            Neurony sƒÖ aktywowane na podstawie funkcji aktywacyjnej, w tym projekcie wykorzystano ReLU (Rectified Linear Unit) ze wzglƒôdu na jej proste i szybkie dzia≈Çanie.
            Po propagacji w prz√≥d nastƒôpuje propagacja wsteczna, podczas kt√≥rej aktualizowane sƒÖ wagi i bias (obciƒÖ≈ºenie) idƒÖc od warstwy ko≈Ñcowej do wej≈õciowej.
            Sieci neuronowe majƒÖ zastosowanie w wielu zagadnieniach w nauczaniu maszynowym, zaczynajƒÖc od regresji, a ko≈ÑczƒÖc na Chatbotach.
            <br>
            <img src="css\p1_images\w≈Çasna sieƒá.png" style="width: 98%; max-height: 300px; margin: auto; object-fit: contain; padding: 15px;" alt="">
            <br><br>
            
            Przed modelowaniem usuniƒôto kolumny 'pierwotny' (rynek) i 'do zamieszkania', 
            poniewa≈º nie sƒÖ one ju≈º potrzebne - 0 w kolumnie 'do wyko≈Ñczenia' i 0 w kolumnie 'do remontu' wystarczƒÖ. 
            Przy skorzystaniu z funkcji get_dummies mo≈ºna skorzystaƒá z drop_first=True by osiƒÖgnƒÖƒá ten efekt. 
            Tu zosta≈Ço to zrobione dopiero na tym etapie w celu ja≈õniejszej wizualizacji korelacji. 
            <br><br>
            We wszystkich modelach test_size w Train-Test-Split ustawiono na 0.3 co oznacza, ≈ºe 70% danych zosta≈Ço przeznaczone na wytrenowanie modelu, 
            a 30% na sprawdzenie. 
            <div style="height: 5px;"></div>
            Przy modelowaniu sieciƒÖ neuronowƒÖ wykorzystano narzƒôdzie MinMaxScaler, 
            kt√≥re normalizuje warto≈õci na podstawie ich odchylenia standardowego oraz najmniejszej i najwiƒôkszej warto≈õci,
            tak aby by≈Çy w przedziale od 0 do 1. Dziƒôki temu b≈Çƒôdy wynikajƒÖce z r√≥≈ºnic w wielko≈õciach warto≈õci (np. powierzchnia mieszkania a dystans do centrum) 
            oraz ich wag i obciƒÖ≈ºe≈Ñ zostanƒÖ zminimalizowane.
            <div style="height: 5px;"></div>
            Podczas modelowania nadano r√≥wnie≈º Dropout=0.2 przy ka≈ºdej warstwie neuronowej. 
            Dropout powoduje losowe wy≈ÇƒÖczenie czƒô≈õci neuron√≥w w warstwie, dziƒôki czemu model jest mniej podatny na overfitting - 
            zbyt dok≈Çadne dopasowanie modelu pod treningowy zestaw danych, przez co stanie siƒô on mniej uniwersalny.
            Wykorzystano te≈º EarlyStopping - narzƒôdzie kt√≥re zatrzymuje trening modelu w momencie gdy podany parametr przestanie siƒô poprawiaƒá, tu validation loss.
            Narzƒôdzie okaza≈Ço siƒô zbƒôdne - przy ilo≈õci epok (iteracji przez treningowy zbi√≥r danych) modelu ustawionej na 800 model nie zosta≈Ç zatrzymany. 
            Ilo≈õci epok nie zwiƒôkszono ze wzglƒôdu na minimalne r√≥≈ºnice b≈Çƒôd√≥w miƒôdzy 800 a 1600 epokami.

            <br><br>
            Do ewaluacji modelu wykorzystano:
            <li>MAE - Mean Absolute Error - ≈õredni b≈ÇƒÖd bezwzglƒôdny</li>
            <li>RMSE - Root Mean Squared Error - pierwiastek b≈Çƒôdu ≈õredniokwadratowego - bardziej wyczulony na du≈ºe b≈Çƒôdy, 
            mo≈ºna go ≈Çatwo interpretowaƒá dziƒôki pierwiastkowi (bez pierwiastka znany jako MSE)</li>
            <li>R¬≤ - wsp√≥≈Çczynnik determinacji - osiƒÖga warto≈õci od 0 do 1, wy≈ºsza warto≈õƒá oznacza lepiej dopasowanƒÖ liniƒô regresji</li>
            <br>

            $$MAE=\frac{1}{n}\sum^n_{i=1}|y_i-\hat{y_i}|$$	
            <!-- MAE - ≈õredni b≈ÇƒÖd bezwzglƒôdny - ≈õrednia z sumy warto≈õci bezwzglƒôdnych b≈Çƒôd√≥w -->
            $$RSME=\sqrt{\frac{1}{n}\sum^n_{i=1}(y_i-\hat{y_i})^2}$$
            $$R^2=1-\frac{\sum^n_{i=1}(y_i-\hat{y_i})^2}{\sum^n_{i=1}(y_i-\overline{y_i})^2}$$
            gdzie: 
            <li>\(\sum(y_i-\hat{y_i})^2\) to suma kwadrat√≥w pozosta≈Ço≈õci, tzw. residuals, potƒôga r√≥≈ºnicy miƒôdzy warto≈õciƒÖ prawdziwƒÖ a warto≈õciƒÖ przewidywanƒÖ</li>
            <li>\(\sum(y_i-\overline{y_i})^2\) to suma kwadrat√≥w og√≥≈Çem, potƒôga r√≥≈ºnicy miƒôdzy prawdziwƒÖ warto≈õciƒÖ a ≈õredniƒÖ tego rodzaju warto≈õci</li>
            <!-- RMSE - pierwiastek b≈Çƒôdu ≈õredniokwadratowego - bardziej wyczulony na du≈ºe b≈Çƒôdy, mo≈ºna go ≈Çatwo interpretowaƒá dziƒôki pierwiastkowi (bez pierwiastka znany jako MSE) -->
            <br>
            MAE, MSE i RMSE sƒÖ warto≈õciami, kt√≥re chcemy zminimalizowaƒá podczas budowania modelu. 
            
            Na wykresach rozrzutu zaznaczono r√≥wnie≈º liniƒô wzd≈Çu≈º kt√≥rej przebiega≈Çaby idealna koncentracja przewidywanych punkt√≥w. 
            Punkt znajdujƒÖcy siƒô bli≈ºej tej linii bƒôdzie oznacza≈Ç mniejszy b≈ÇƒÖd. 
            Gdyby model opiera≈Ç siƒô tylko na jednej warto≈õci (np. powierzchni mieszkania) czyli nie by≈Ç modelem regresji wielokrotnej, 
            mo≈ºliwe by≈Çoby wyprowadzenie faktycznej linii funkcji regresji liniowej. 
            
            Na wykresach po prawej przedstawiono dystrybucjƒô warto≈õci residuals, 
            im wiƒôcej warto≈õci bli≈ºej 0, tym lepiej.

            <br><br>Modelowanie przeprowadzono dla kilku r√≥≈ºnych przedzia≈Ç√≥w. 
            Na potrzeby tego sprawozdania przedstawiono wyniki dla dw√≥ch przedzia≈Ç√≥w. 
             - najpierw usuniƒôto mieszkania powy≈ºej 9 000 000 z≈Ç. 
            Wyniki przedstawiono poni≈ºej. 
            <br><br>

            <div class="card mb-6" style="max-width: 900px;">
              <div class="row g-0">
                <div class="col-md-8">
                  <img src="css\p1_images\9mil reg.png" class="img-fluid rounded-start" alt="...">
                </div>
                <div class="col-md-4">
                  <div class="card-body">
                    <h5 class="card-title">Regresja liniowa <br> do 9 mln z≈Ç</h5>
                    <li>MAE: 251 527 [z≈Ç]</li>
                    <li>RMSE: 393 270 [z≈Ç]</li>
                    <li>R¬≤: 0.80</li>     
                  </div>
                </div>
              </div>
            </div>

            <div style="height: 5px;"></div>

            <div class="card mb-6" style="max-width: 900px;">
              <div class="row g-0">
                <div class="col-md-8">
                  <img src="css\p1_images\9mil keras.png" class="img-fluid rounded-start" alt="...">
                </div>
                <div class="col-md-4">
                  <div class="card-body">
                    <h5 class="card-title">Regresja TensorFlow<br> do 9 mln z≈Ç</h5>
                    <li>MAE: 697 458 [z≈Ç]</li>
                    <li>RMSE: 1 106 752 [z≈Ç]</li>
                    <li>R¬≤: 0.75</li>                    
                  </div>
                </div>
              </div>
            </div>
            <br>
            Mimo wysokiego wyniku R¬≤ i EV taki model nie jest zbyt praktyczny - ≈õrednie b≈Çƒôdy sƒÖ zbyt wysokie, w szczeg√≥lno≈õci 
            w przypadku RMSE dla sieci neuronowej TensorFlow gdzie RMSE wynosi ponad 1 mln z≈Ç, czyli trochƒô wiƒôcej ni≈º ≈õrednia cena mieszkania w zestawie danych. 
            Jest tu te≈º wyra≈∫nie widoczny efekt badania RMSE, kt√≥ry jest bardziej 'wyczulony' na warto≈õci mocno odbiegajƒÖce od warto≈õci ≈õrednich. 
            Dlatego w kolejnym podej≈õciu przedzia≈Ç danych ograniczono do cen od 125 000 do 2 500 000 mln z≈Ç. <br><br>
             
            
            <div class="card mb-6" style="max-width: 900px;">
              <div class="row g-0">
                <div class="col-md-8">
                  <img src="css\p1_images\2mil reg.png" class="img-fluid rounded-start" alt="...">
                </div>
                <div class="col-md-4">
                  <div class="card-body">
                    <h5 class="card-title">Regresja liniowa <br> do 2,5 mln z≈Ç</h5>
                    <li>MAE: 147 788 [z≈Ç]</li>
                    <li>RMSE: 211 835 [z≈Ç]</li>
                    <li>R¬≤: 0.75</li>     
                  </div>
                </div>
              </div>
            </div>

            <div style="height: 5px;"></div>

            <div class="card mb-6" style="max-width: 900px;">
              <div class="row g-0">
                <div class="col-md-8">
                  <img src="css\p1_images\2mil keras.png" class="img-fluid rounded-start" alt="...">
                </div>
                <div class="col-md-4">
                  <div class="card-body">
                    <h5 class="card-title">Regresja TensorFlow<br> do 2,5 mln z≈Ç</h5>
                    <li>MAE: 412 673 [z≈Ç]</li>
                    <li>RMSE: 557 260 [z≈Ç]</li>
                    <li>R¬≤: 0.74</li>                    
                  </div>
                </div>
              </div>
            </div>

            <br><br>
            Poni≈ºej przedstawiono ceny trzech mieszka≈Ñ przewidziane przez modele. 
            Dane mieszka≈Ñ zosta≈Çy wprowadzone w formie Pythonowego dictionary, a nastƒôpnie utworzono z nich jednowierszowƒÖ tabelƒô Pandas.
            W przypadku przewidywania cen mieszka≈Ñ przez TensorFlow r√≥wnie≈º nale≈ºa≈Ço u≈ºyƒá narzƒôdzia MinMaxScaler.
            <br><br>

            <table class="table table-hover">
              <thead>
                <tr>
                  <th scope="col">Mieszkanie</th>
                  <th scope="col">LR <9 mln z≈Ç</th>
                  <th scope="col">TF <9 mln z≈Ç</th>
                  <th scope="col">LR <2,5 mln z≈Ç</th>
                  <th scope="col">TF <2,5 mln z≈Ç</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <th scope="row">37 m¬≤, blok, W≈Çochy</th>
                  <td>365 607 z≈Ç</td>
                  <td>516 649 z≈Ç</td>
                  <td>494 160 z≈Ç</td>
                  <td>531 320 z≈Ç</td>
                </tr>
                <tr>
                  <th scope="row">54 m¬≤, apartament, Kabaty</th>
                  <td>394 026 z≈Ç</td>
                  <td>628 492 z≈Ç</td>
                  <td>577 780 z≈Ç</td>
                  <td>667 709 z≈Ç</td>
                </tr>
                <tr>
                  <th scope="row">96 m¬≤, apartament, Natolin</th>
                  <td>1 501 197 z≈Ç</td>
                  <td>1 358 248 z≈Ç</td>
                  <td>1 397 107 z≈Ç</td>
                  <td>1 519 427 z≈Ç</td>

                </tr>
              </tbody>
            </table>
            <br>
            <h4 id="wnioski-header">7. Wnioski</h4>
            <h6>
              Na podstawie wynik√≥w z tabeli oraz interpretacji wykres√≥w i b≈Çƒôd√≥w wyciƒÖgniƒôto nastƒôpujƒÖce wnioski:
            </h6>
            <li>Model regresji liniowej mocno zani≈ºa warto≈õci mieszka≈Ñ w najni≈ºszym przedziale cen - do ok. 500 tys. z≈Ç.</li>
            <li>Natomiast w przedziale od ok. 0,5 do 1 mln z≈Ç ceny sƒÖ lekko zawy≈ºone.</li>
            <li>Ceny mieszka≈Ñ powy≈ºej 1,5 mln z≈Ç r√≥wnie≈º sƒÖ zani≈ºane, im dro≈ºsze mieszkania tym rozrzut przewidywanych cen jest wiƒôkszy,
              ze wzglƒôdu na mniejszƒÖ ilo≈õƒá takich ofert w zestawie danych do wytrenowanie celnego modelu.</li>
            <li>W przypadku sprawdzonych mieszka≈Ñ z tabeli, model TF<9 mln z≈Ç okaza≈Ç siƒô do≈õƒá trafny.
            Wysokie warto≈õci MEA i RMSE najprawdopodobniej wynikajƒÖ z ofert mieszka≈Ñ powy≈ºej 2 mln z≈Ç. 
            Niemniej do zbudowania modeli przydatnych do przewidywania cen tak drogich mieszka≈Ñ, 
            niezbƒôdna by≈Çaby wiƒôksza ilo≈õƒá drogich mieszka≈Ñ w zestawie danych.</li>
            <li>Cena mieszkania na Kabatach wydaje siƒô mocno zani≈ºona we wszystkich przypadkach, 
            mimo niema≈Çej powierzchni i ≈õwietnej lokalizacji wzglƒôdem stacji metra. 
            JednƒÖ z przyczyn mo≈ºe byƒá korelacja atrybutu 'apartament' z ma≈ÇƒÖ powierzchniƒÖ lub innymi atrybutami - 
            wiele ofert bardzo ma≈Çych mieszka≈Ñ zosta≈Ço otagowanych przez deweloper√≥w jako aparatamenty, 
            r√≥wnie≈º podczas oczyszczania danych wiele brakujƒÖcych danych w kolumnie 'zabudowa' mog≈Ço zostaƒá b≈Çƒôdnie przypisanych.</li>
          
            <br>
            <h6>Sugestie jak ulepszyƒá modele:
            </h6>
            <li>Dodanie wiƒôcej danych, np. z danych archiwalnych lub innych stron z ofertami mieszkƒÖ≈Ñ</li>
            <li>Zastosowanie lepszych metod podczas oczyszczania danych np. czƒô≈õciejsze uzupe≈Çnienie przy pomocy BeautifulSoup</li>
            <li>Dodanie nowych atrybut√≥w: w przypadku wiƒôkszego i bardziej wyr√≥wnanego  zestawu danych mo≈ºna by wykorzystaƒá
             one-hot encoding dla kolumny dzielnica - r√≥≈ºnice korelacji miƒôdzy cenƒÖ a dzielnicƒÖ by≈Çyby interesujƒÖce same w sobie i 
             byƒá mo≈ºe poprawi≈Çyby jako≈õƒá modeli.
            Np. mo≈ºna by siƒô spodziewaƒá, ≈ºe mieszkania w Weso≈Çej bƒôdƒÖ korelowaƒá z ni≈ºszƒÖ cenƒÖ ni≈º mieszkania na Mokotowie.
            Niestety obecnie w zestawie danych jest niewiele  ofert z dzielnic takie jak Weso≈Ça czy Remembert√≥w, 
            co mog≈Çoby spowodowaƒá np. znaczƒÖce zani≈ºenie przewidywanych ofert z tych dzielnic.
            </li>
            <li>
              Zastosowanie lepszych modeli i metod nauczania maszynowego, np. zastosowaƒá walidacjƒô krzy≈ºowƒÖ lub regularyzacjƒô.
            </li>
            <br>
            <h4 id="poprawki-header">8. LASSO, XGBoost, SHAP</h4>
            Do tego projektu postanowi≈Çem wr√≥ciƒá ze ≈õwie≈ºo zdobytƒÖ wiedzƒÖ na temat regularyzacji, 
            bardziej zaawansowanych algorytm√≥w nauczania maszynowego oraz metod analizy modeli. 
            <li>LASSO - metoda regularyzacji regresji liniowej, umo≈ºliwajƒÖca wyeliminowanie nieistotnych cech. Tu wykorzystana do wizualizacji znaczenia cech.</li>
            <li>XGBoostRegressor - model poprawiajƒÖcy siƒô poprzez uwzglƒôdninie wynik√≥w z ka≈ºdej poprzedniej iteracji</li>
            <li>SHAP - narzƒôdzie wyja≈õniajƒÖce, jak model przewidzia≈Ç szukanƒÖ dla danej pr√≥bki</li>

            <br>
            <h5>LASSO</h5>
           LASSO - Least Absolute Shrinkage and Selection Operator to odmiana regresji liniowej, kt√≥ra wykorzystuje regularyzacjƒô L1.
           <div style="height: 5px;"></div>

           Regularyzacja L1 polega na zmniejszeniu obciƒÖ≈ºenia (bias) poprzez na≈Ço≈ºenie kary na wsp. kierunkowy warto≈õciƒÖ Œª (lambda). 
           Dziƒôki niej mo≈ºna zmniejszyƒá lub ca≈Çkowiecie ‚Äûwy≈ÇƒÖczyƒá‚Äù wagƒô nieistotnej cechy. 	
           Warto≈õƒá Œª mo≈ºna dobieraƒá poprzez walidacjƒô krzy≈ºowƒÖ, technikƒô dziƒôki kt√≥rej mo≈ºna znale≈∫ƒá najepsze hiperparametry modelu lub podzia≈Ç zestawu danych na zestaw treningowy i testowy.
           Szuka siƒô minimalnej warto≈õci funkcji straty z poni≈ºszego wzoru:

           $$\underset{\gamma}{argmin} \; \sum^n_{i=1}(y_i - \hat{y_i})^2 + \lambda \sum^p_{j=1} |\hat\beta_j|$$

           gdzie: 
           <li>\((y_i-\hat{y_i})^2\) to residuals</li>
           <li>\(\lambda\) to hiperparametr regularyzacji, odpowiada za kurczenie siƒô (shrinkage) wa≈ºno≈õci cech </li>
           <li>\(\beta_i\) to wsp. kierunkowy regresji danej cechy</li>
           <div style="height: 15px;"></div>
           Lasso nie zosta≈Ço tu wykorzystane do utworzenia modelu, ale do wskazania, kt√≥re cechy zestawu danych sƒÖ istotne oraz jakƒÖ majƒÖ wagƒô.
           U≈ºyto tu moetody lasso_paths i wykre≈õlono zale≈ºno≈õƒá miƒôdzy warto≈õciƒÖ Œª a wsp√≥≈Çczynnikami wagi cech. 
           Zestaw danych jest ten same, ograniczony do pr√≥bek o cenach od 125 000 do 2 500 000 z≈Ç.

           <div style="height: 15px;"></div>

           <img class="myImg" src="css\p1_images\Lasso paths.png"  style="width: 95%;">
           <div id="myModal" class="modal">
             <div class="opacity-background close">
               <span class="close">&times;</span>
             </div>
             <img class="modal-content" id="img01">
             <div id="caption"></div>
           </div>

           <div style="height: 15px;"></div>

           
           
           
           O≈õ X reprezentuje wzrost warto≈õci Œª, czyli karƒô.
           Odleg≈Ço≈õƒá od 0 na osi y wskazuje na istotno≈õƒá cechy, a krzywe poni≈ºej 0 wskazujƒÖ, ≈ºe wzrost danej cechy obni≈ºy przewidywanƒÖ cenƒô, nie ≈ºe sƒÖ mniej istotne.
           <br>
           Z wykresu mo≈ºna odczytaƒá, ≈ºe cechy takie jak <span style="font-weight: 600;">powierzchnia mieszkania, dystans do ≈öwiƒôtokrzyskiej i dystans do najbli≈ºszej stacji metra oraz blok</span>
           sƒÖ najistotniejszymi cechami z zestawu danych. Oczywi≈õcie powierzchnia jest zdecydowanie najwa≈ºniejsza. Widoczne jest r√≥wnie≈º ≈ºe cechy te najd≈Çu≈ºej ‚Äûprzetrwa≈Çy‚Äù wzrost Œª, w przeciwie≈Ñstwie do np. roku budowy.

           <br>
           <br>

           <h5>XGBoost</h5>
           XGBoost, a w≈Ça≈õciwie eXtremeGradientBoostRegressor to jeden z najbardziej skutecznych i celnych algorytm√≥w uczenia maszynowego stosowany do zagadnie≈Ñ z regresji i klasyfikacji.
           Jest oparty na zespole drzew decyzyjnych, w kt√≥rym ka≈ºde drzewo jest do≈õƒá s≈Çabym modelem przewidujƒÖcym, zwykle majƒÖcym od 3 do 5 poziom√≥w g≈Çƒôboko≈õci. 
           Z ka≈ºdƒÖ iteracjƒÖ XGBoostRegressor buduje poprawki na podstawie poprzednich wynik√≥w i b≈Çƒôd√≥w. 
           W przypadku tu przeprowadzonego modelu, b≈Çƒôdy by≈Çy liczone na podstawie funkcji straty z <span style="font-weight: 600;">SSR</span>, czyli <span style="font-weight: 600;">Sum of Squared Residuals</span> - \((y_i-\hat{y_i})^2\) 
          , a hiperparametry znalezione przy pomocy walidacji krzy≈ºowej to ilo≈õƒá drzew r√≥wna 100 i g≈Çƒôboko≈õƒá drzew r√≥wna 5. Model osiƒÖgnƒÖ≈Ç bardzo wysokƒÖ celno≈õƒá 84%:

           <div class="card mb-6" style="max-width: 900px; padding: 10px;">
            <div class="row g-0">
              <div class="col-md-8">
                <img src="css\p1_images\XGB scatter perfect.png" class="img-fluid rounded-start" alt="...">
              </div>
              <div class="col-md-4">
                <div class="card-body">
                  <h5 class="card-title">XGBoostRegressor<br> do 2.5 mln z≈Ç</h5>
                  <li>MAE: 115 486 [z≈Ç]</li>
                  <li>RMSE: 166 262 [z≈Ç]</li>
                  <li>R¬≤: 0.84</li>     
                </div>
              </div>
            </div>
          </div>

          <!-- <br>
          <img src="css\p1_images\XGB residuals.png" style="max-width: 98%;  margin: auto; object-fit: contain; padding: 15px;" alt="">
          <br><br> -->


          <div class="card mb-6" style="max-width: 900px; padding: 10px;">
            <div class="row g-0">
              <div class="col-md-12">
                <img src="css\p1_images\XGB residuals.png" class="img-fluid rounded-start" alt="...">
              </div>

            </div>
          </div>

          </div>

        </div>
      </span>
        <div class="col-md-3" style="padding-left: 36px;"> <!-- SIDEBAR -->
          <div class="sticky">
            <p>Nawigacja:</p>
            <a href="#top">1. Wstƒôp</a> <br>
            <a href="#zebranie_danych-header">2. Zebranie danych</a> <br>
            <a href="#QGIS-header">3. Mapa i przetworzenie danych w QGIS</a> <br>
            <a href="#pandas-header">4. Oczyszczenie danych w Pandas</a> <br>
            <a href="#wizualizacja-header">5. Wizualizacja danych</a> <br>
            <a href="#uwagi-header" style="margin-left:15px">Uwagi dotyczƒÖce korelacji</a> <br>
            <a href="#modelowanie-header">6. Modelowanie</a> <br>
            <a href="#wnioski-header">7. Wnioski</a> <br>
            <a href="#poprawki-header">8. LASSO, XGBoost, SHAP</a>

            <hr style="width: 200px; margin-top: 26px; margin-bottom: 20px">

            <a href="#top">Powr√≥t do poczƒÖtku</a> <br>
          </div>
        </div>
    </div>
      
    <section class="jumbotron text-center">
      <div class="container", style="padding-top: 90px;">
        <p>
          <a href="#top" class="btn btn-outline-secondary my-2 botbuttons" >Powr√≥t do poczƒÖtku</a>
          <a href="index.html"class="btn btn-secondary my-2 botbuttons" >Powr√≥t do strony g≈Ç√≥wnej</a>
        </p>
      </div>
  </section>

    <div id="footer", class="bottom", style="font-size:0.77em;">      
          <p style="margin:5px;">&copy; <script>document.write(new Date().getFullYear());</script> Konrad Jarominiak</p>
          <p>Wykorzystano:
            <a href="https://getbootstrap.com/" class="footer-link">Bootsrap 5</a>,
            <a href="https://highlightjs.org/" class="footer-link">highlight.js</a>,
            <a href="https://www.mathjax.org/" class="footer-link">MathJax</a> </p>
        </div>

    <script>hljs.highlightAll();</script>
    <script src="scripts\modal.js"></script>
  </body>
</html>