<!DOCTYPE html>
<html lang="en" dir="ltr">

    <head>
        <meta charset="utf-8">
        <title>Portfolio üêí</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
        <link rel="stylesheet" href="css/css_project_page.css">
        <link rel="stylesheet" href="css/cssmaster.css">
        <link rel="icon" href="C:\Users\konra\Documents\W≈Çasne\Programowanie\HTML CSS Javascript Course\Web Developement 15\6 - Bootstrap Tindog\css\favicon.ico">
      
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Montserrat&display=swap" rel="stylesheet">
        <script src="https://kit.fontawesome.com/1c9ad4b785.js" crossorigin="anonymous"></script>

        <link rel="stylesheet" href="scripts\code highlight\styles\idea.min.css"/>
        <script src="scripts\code highlight\highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>

        <script type="text/javascript" id="MathJax-script" async
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
        </script>

      </head>
  <body>
      
    <section class="jumbotron text-center">
        <div class="container">
          <h1>Konrad Jarominiak - porftolio</h1>
          <p class="lead text-muted">
            Oto kilka projekt√≥w z dziedzin data science, danych przestrzennych i wizualizacji danych.
          </p>
          <p>
            <a
              href="https://getbootstrap.com/docs/4.4/examples/album/#"
              class="btn btn-primary my-2"
              >Main call to action</a
            >
            <a
              href="https://getbootstrap.com/docs/4.4/examples/album/#"
              class="btn btn-secondary my-2"
              >Secondary action</a
            >
          </p>
        </div>
    </section>

    <span class="border border-0">

    <div class="container">
      <div class="row">
        <div class="col-md-8">

          <div class="tresc wstep">
            <h4 id="wstep-header">1. Wstƒôp</h4>
            Niniejszy projekt data science mia≈Ç na celu przedstawienie prostego sposobu na wykorzystanie danych przestrzennych w modelowaniu data science.
            W projekcie sprawdzono jak du≈ºe znaczenie odgrywa odleg≈Ço≈õƒá mieszkania do centrum miasta i 
            odleg≈Ço≈õci mieszkania do najbli≈ºszej stacji metra na rynku mieszkaniowym w Warszawie. 
            W projekcie wykorzystano:
<li>Selenium i Beautiful Soup w celu zebrania danych</li>
<li>SQLAlchemy do przechowania danych w bazie danych</li>
<li>GIS do wyznaczenia odleg≈Ço≈õci oraz przedstawienia mieszka≈Ñ z zebranych ofert na mapie Warszawy</li>
<li>Pandas do przetworzenia i oczyszczenia danych</li>
<li>Matplotlib i Seaborn do wizualizacji danych</li>
<li>sci-kit learn i Keras do stworzenia modelu</li>

          </div>

          <div class="tresc zebranie_danych">
            <h4 id="zebranie_danych-header">2. Zebranie danych</h4>

            Do zebrania danych wstƒôpnych danych wykorzystano Selenium webdriver, czyli narzƒôdzie umo≈ºlwiajƒÖce zautomatyzowanie funkcjonalno≈õci przeglƒÖdarki. 
            Wstƒôpne dane (indeksy, linki i powiat) zebrano z pewnej strony z ofertami mieszka≈Ñ z wynikami dla Warszawy. 
            Wykorzystano tu Selenium ze wzglƒôdu na fakt, ≈ºe oferty ≈Çadowane sƒÖ wraz z przewijaniem strony przez u≈ºytkownika ‚Äì Beautiful Soup nie wy≈Çapa≈Çoby ≈ºadnych ofert.
            Dane przechowano przy pomocy SQLAlchemy:
            <pre><code> <!-- Kod bazy danych -->
class Links(Base):  
    __tablename__ = "Links"  
    numer = Column("numer", Integer, primary_key=True)  
    powiat = Column("powiat", String)  
    link = Column("link", String)  

    def __init__(self, numer, powiat, link):  
        self.numer = numer  
        self.link = link  
        self.powiat = powiat  

    def __repr__(self):  
        return f"({self.numer}, {self.powiat}, {self.link})"
            </code></pre>
            W sumie uzyskano 3600 link√≥w z czego czƒô≈õƒá zawiera≈Ça linki do ofert po za WarszawƒÖ. 
            Na potrzeby stworzenia mapy w QGIS nie przefiltrowano wynik√≥w tylko do Warszawy.
            <br>
            Do zebrania szczeg√≥≈Çowych danych r√≥wnie≈º zastosowano Selenium. 
            Web scraping przy pomocy Beautiful Soup by≈Çby szybszy i o wiele prostszy, ale nie umo≈ºliwi≈Çby zebrania wsp√≥≈Çrzƒôdnych z zaembedowanej mapy google. 
            Bez przewijania strony, poni≈ºsza mapa nie by≈Çaby widoczna i mo≈ºliwa do zescrapowania.
            <img src="css\p1_images\embed mapy googli.png" style="margin: 10px auto 10px; width: 100%;">
            <br>
            Zbierania wsp√≥≈Çrzƒôdnych dokonywano przy pomocy poni≈ºszego kodu:
            <pre><code> <!-- Kod dla zbierania LATT LONG-->
try:  
    driver.execute_script("arguments[0].scrollIntoView();",  
                          driver.find_element(By.ID, 'map')  
                          )  
except NoSuchElementException:  
    driver.refresh()  
    driver.execute_script("arguments[0].scrollIntoView();",  
                          driver.find_element(By.ID, 'map')  
                          )
# ...
map_link = driver.find_element(By.XPATH, "//a[contains(@href,'apiv3')]")  
coord = map_link.get_attribute('href').split('ll=')[1].split('&')[0].split(',')  
coord_dict = {  
    'lat': float(coord[0]),  
    'long': float(coord[1])  
    }  
            </code></pre>
            Pozosta≈Çe dane zbierane by≈Çy g≈Ç√≥wnie w nastƒôpujƒÖcy spos√≥b: dla ka≈ºdego elementu z listy `all_topics` zbierano warto≈õƒá z tabeli szczeg√≥≈Ç√≥w na stronie. 
            W przyk≈Çadzie dla g≈Ç√≥wnych informacji nie zdarza≈Ço siƒô aby funkcja separujƒÖca dane z tekstu zwraca≈Ça warto≈õƒá `None`, zamiast tego zwraca≈Ça 'Zapytaj' 
            gdy danych nie doprecyzowano. W sekcji oczyszczania danych te dane zosta≈Çy poprawione i zastƒÖpione. 
            <br>
            <pre><code> <!-- Kod dla zbierania danych g≈Ç√≥wnych -->
def separate_value(text, topic):  
    try:  
        value = text.find_element(By.CSS_SELECTOR, f'div[aria-label="{topic}"]')  
        value = value.text.split(topic)[1].replace('\n', '')  
        return value  
    except NoSuchElementException:  
        return None  
  
  
all_topics = ["Powierzchnia", "Liczba pokoi", "Piƒôtro", "Powierzchnia dzia≈Çki", "Czynsz", "Forma w≈Çasno≈õci", "Stan wyko≈Ñczenia",  
                    "Balkon / ogr√≥d / taras", "Miejsce parkingowe", "Ogrzewanie"]  
  
try:  
    main_info_dict = driver.find_element(By.CSS_SELECTOR, 'div[data-testid="ad.top-information.table"]')  
except NoSuchElementException:  
    driver.refresh()  
    collect_info(link, numer)  
    return  
  
main_dict = {}  
for topic in all_topics:  
    main_dict[topic] = separate_value(main_info_dict, topic)
            </code></pre>
            W≈õr√≥d wszystkich ofert znalaz≈Ça siƒô niema≈Ça ilo≈õƒá ofert deweloper√≥w, w≈õr√≥d kt√≥rych nie zosta≈Çy podane ≈ºadne dane z informacji dodatkowych, 
            np. rynek wt√≥rny/pierwotny, winda czy rodzaj zabudowy. Te dane r√≥wnie≈º uzupe≈Çniono w sekcji oczyszczania danych.

            Zapisanie danych ofert dokonano w ten sam spos√≥b co przy zbieraniu samych ofert i da≈Ço poni≈ºszƒÖ tabelƒô, wy≈õwietlanƒÖ w SQLLiteStudio:
            <br><br>
            <img src="css\p1_images\SQL dane szczeg√≥≈Çowe.png" style="width: 98%;">
          </div>

          <div class="tresc przetworzenie_w_QGIS">
            <h4 id="QGIS-header">3. Przetworzenie danych w QGIS</h4>
            Tabelƒô zawierajƒÖcƒÖ szczeg√≥≈Çowe dane za≈Çadowano do programu QGIS wraz warstwƒÖ dzielnic Warszawy oraz stacji metra. 
            Do wyznaczenia odleg≈Ço≈õci wykorzystano dwa narzƒôdzia wektorowe: 
            <li>
            liniowa odleg≈Ço≈õƒá do najbli≈ºszego huba, do obliczenia odleg≈Ço≈õci do centrum Warszawy 
            (na potrzeby tego projektu uznano stacjƒô ≈öwiƒôtokrzyskƒÖ za centrum)
            </li>
            <li>
            macierz odleg≈Ço≈õci do obliczenia odleg≈Ço≈õci do najbli≈ºszej stacji metra, 
            tu obliczono odleg≈Ço≈õci do najbli≈ºszych piƒôciu, a nastƒôpnie przefiltrowano tabelƒô
            </li>
            Efektem przetworzenia danych w QGIS jest mapa mieszka≈Ñ oraz dwie nowe kolumny z odleg≈Ço≈õciami, kt√≥re zosta≈Çy wykorzystane w modelowaniu. 
            Kilka mieszka≈Ñ w okolicach Ursynowa nie zosta≈Ço poprawnie przefiltrowanych, niemniej nie powinny mieƒá one znaczenia, ze wzglƒôdu na ich niedu≈ºƒÖ odleg≈Ço≈õƒá od stacji metra.
          
            <br><br>
            <img src="css\p1_images\Warszawa.png" style="width: 95%;" alt="">
          </div>

          <div class="tresc oczyszczenie_danych">
            <h4 id="pandas-header">4. Oczyszczenie danych w Pandas</h4>
            Wstƒôpne sprawdzenie rodzaju danych w tabeli przedstawia siƒô nastƒôpujƒÖco:
            <pre><code class="language-python"> <!-- kod typy danych -->
              numer int64 
              link object 
              Cena int64 
              powierzchnia object 
              powierzchnia_dzialki float64 
              lokalizacja object 
              n_pokojow int64 pietro object 
              czynsz object 
              wlasnosc object 
              wykonczenie object 
              zewnatrz object # taras, ogr√≥d, balkon
              parking object 
              ogrzewanie object 
              rynek object 
              ogloszenie object 
              rok_budowy object 
              zabudowa object 
              winda object 
              latt float64 
              long float64 
              Dystans do Swietokrzyskiej float64 
              najblizsza stacja object 
              dystans do najblizszej stacji [m] float64
              dtype: object
            </code></pre>

            Oczyszczenie danych polega≈Ço na:
            <ol>
              <li>
                Zamianie warto≈õci na dane liczbowe, w przypadku kolumn takich jak cena czy powierzchnia wymaga≈Ço usuniƒôcia element√≥w z teksu takich jak m¬≤, 
                zamianie przecink√≥w na kropki i og√≥lnƒÖ zmianƒô typu danych na int i float
              </li>
              <li>
                Zamianie p√≥l z 'Zapytaj' i NaN czyli niereprezentowalnych brakujƒÖcych warto≈õci na 
                takie kt√≥re mia≈Çy sens w kontek≈õcie tabeli i danego wiersza np.:
                <pre><code class="language-python"> <!-- kod blok a winda -->
blok_a_winda = {0:None, 1:'blok'}
df['zabudowa'] = df['zabudowa'].fillna(df['winda'].map(blok_a_winda))
                </code></pre>
                Innym przyk≈Çadem uzupe≈Çnienia danych jest wykorzystanie Beautiful Soup. 
                Przy pomocy tego scrapera sprawdzono, czy opis oferty zawiera wyra≈ºenia takie jak 'wymaga remontu' i uzupe≈Çniono kolumny.
                <pre><code class="language-python"> <!-- kod BS4 i remont -->
def parse_remont(link):
    response = requests.get(link, headers=HEADERS)
    soup = BeautifulSoup(response.content, 'html.parser')
    
    try:
        opis = soup.find('div',{'data-cy':'adPageAdDescription'}).text
        ad_title = soup.find('h1',{'data-cy':'adPageAdTitle'}).text
    except AttributeError: # przypadki gdy oferta zosta≈Ça usuniƒôta
        return
        
    lista_remont = ['do remontu', 'wymaga remontu', 'wymagajƒÖce remontu', 'wymagajƒÖcy remontu', 
                    'czƒô≈õciowego remontu', 'generalnego remontu', 
                    'ca≈Çkowitego remontu', 'do odnowy', 'do odnowienia', ]

    for r in lista_remont:
        if r in ad_title or r in opis:
            return 'do remontu'
        else:
            return 'do zamieszkania'
            
df.loc[df['wykonczenie'] == 'Zapytaj', 'wykonczenie'] 
= df.loc[df['wykonczenie'] == 'Zapytaj', 'link'].apply(lambda x: parse_remont(x))
                </code></pre>
              </li>
              <li>
                Usuniƒôto zbƒôdne kolumny i kolumny ze zbyt du≈ºƒÖ ilo≈õciƒÖ brakujƒÖcych danych, np. 'w≈Çasno≈õƒá' czy 'og≈Çoszenie'
              </li>
              <li>
                Zastosowano OneHotEncoding przy pomocy pandas.get_dummies - z kolumny 'zabudowa' utworzono cztery nowe kolumny: 'apartamentowiec', 'blok', 'dom', 'kamienica'. Je≈ºeli dane mieszkanie znajduje siƒô w bloku, w kolumnie 'blok' bƒôdzie warto≈õƒá 1, w pozosta≈Çych 0.
                <br>
                W przypadku kolumny 'zewnƒÖtrz' zastosowano w≈Çasne funkcje do uzupe≈Çnienia kolumn, ze wzglƒôdu na fakt, ≈ºe w jednym mieszkaniu mogƒÖ wystƒôpowaƒá kilka opcji np. balkon i taras jednocze≈õnie:
                <pre><code class="language-python"> <!-- kod dummies dla zewnƒÖtrz1 -->
def get_balkon(text):
    if 'balkon' in text:
        return 1
    else:
        return 0

def get_ogrod(text):
    if 'ogr√≥dek' in text:
        return 1
    else:
        return 0

def get_taras(text):
    if 'taras' in text:
        return 1
    else:
        return 0

df["balkon"] = df["zewnatrz"].apply(lambda x: get_balkon(x))
df["ogrod"] = df["zewnatrz"].apply(lambda x: get_ogrod(x))
df["taras"] = df["zewnatrz"].apply(lambda x: get_taras(x))
                </code></pre>                
              </li>

            </ol>



          </div>

          <div class="tresc AKORDEONY"> <!-- PoczƒÖtek wizualizacji i akordeonu -->
            <h4 id="wizualizacja-header">5. Wizualizacja danych</h4>
          <div class="accordion" id="accordionPanelsStayOpenExample"> 
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button" type="button" data-bs-toggle="collapse"
                  data-bs-target="#panelsStayOpen-collapseOne" aria-expanded="true" aria-controls="panelsStayOpen-collapseOne">
                  <img src="css\p1_images\Histogram cen.png" alt="">
                </button>
              </h2>
              <div id="panelsStayOpen-collapseOne" class="accordion-collapse collapse">
                <div class="accordion-body">
                  <pre><code class="language-python">
sns.set_style("ticks")
fig, ax = plt.subplots(figsize=(9,6),)
ax.set_ylabel("Czƒôsto≈õƒá")
sns.histplot(df['Cena'], color='olivedrab').set_title('Histogram cen')
                                                </code></pre>
                </div>
              </div>
            </div>
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                  data-bs-target="#panelsStayOpen-collapseTwo" aria-expanded="false" aria-controls="panelsStayOpen-collapseTwo">
                  <img src="css\p1_images\Pude≈Çkowy cen dzielnice.png" alt="">
                </button>
              </h2>
              <div id="panelsStayOpen-collapseTwo" class="accordion-collapse collapse">
                <div class="accordion-body">
                  <pre><code class="language-python">
fig, ax = plt.subplots(figsize=(9,6))
plt.xticks(rotation=-66)
chart  = sns.boxplot(data=df, y='Cena', x='lokalizacja', 
    order=df.groupby('lokalizacja').mean()['Cena'].sort_values(ascending=True).index.tolist(),)
    
f = lambda x, pos: f'{x/10**6:,.0f}M'
chart.yaxis.set_major_formatter(ticker.FuncFormatter(f))
chart.set(xlabel='Dzielnica', ylabel='Cena')
chart.set_title('Wykres pude≈Çkowy cen w zale≈ºno≈õci od dzielnicy')
                                                </code></pre>
                </div>
              </div>
            </div>
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                  data-bs-target="#panelsStayOpen-collapseThree" aria-expanded="false"
                  aria-controls="panelsStayOpen-collapseThree">
                  <img src="css\p1_images\Pude≈Çkowy cen dzielnice mini.png" alt="">
                </button>
              </h2>
              <div id="panelsStayOpen-collapseThree" class="accordion-collapse collapse">
                <div class="accordion-body">
                  <pre><code class="language-python">
sns.set_style("ticks")
fig, ax = plt.subplots(figsize=(9,6))
plt.xticks(rotation=-60)

chart  = sns.boxplot(data=df.drop(df[df.Cena >= 2500000].index), y='Cena', x='lokalizacja', 
    order=df.drop(df[df.Cena >= 2500000].index).groupby('lokalizacja')
    .mean()['Cena'].sort_values(ascending=True).index.tolist(),
    )

f = lambda x, pos: f'{x/10**6:,.1f}M'
chart.yaxis.set_major_formatter(ticker.FuncFormatter(f))

chart.set(xlabel='Dzielnica', ylabel='Cena')
chart.set_title('Wykres pude≈Çkowy cen w zale≈ºno≈õci od dzielnicy')
                  </code></pre>
                </div>
              </div>
            </div>

            <li class="opis_wiz">
              Najta≈Ñsza oferta to lokal us≈Çugowy w Weso≈Çej, o powierzchni 20 m¬≤, kt√≥ry mo≈ºe pe≈Çniƒá funkcjƒô mieszkalnƒÖ, do wyko≈Ñczenia, nieca≈Çe 13 km od stacji ≈öwiƒôtokrzyska. Niska cena wydaje siƒô uzasadniona.
            </li>
          </div>


          <div class="accordion" id="accordionPanelsStayOpenExample">
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button" type="button" data-bs-toggle="collapse" 
                data-bs-target="#panelsStayOpen-collapseFive" aria-expanded="true" aria-controls="panelsStayOpen-collapseFive">
<img src="css\p1_images\Histogram powierzchni.png" alt="">
                </button>
              </h2>
              <div id="panelsStayOpen-collapseFive" class="accordion-collapse collapse">
                <div class="accordion-body">
                  <pre><code class="language-python">
fig, ax = plt.subplots(figsize=(9, 6))
ax.set_ylabel("Czƒôsto≈õƒá")
chart =sns.histplot(df['powierzchnia'], bins=57, edgecolor=None, element='step', color='navy')
chart.set_title('Histogram powierzchni')
chart.set(xlabel='Powierzchnia [m¬≤]', ylabel='Czƒôsto≈õƒá')
                                      </code></pre>
                </div>
              </div>
            </div>
          </div>
          <li class="opis_wiz">
            Wykres wyra≈∫nie wsp√≥≈Çkszta≈Çtny do histogramu cen - wiƒôkszo≈õƒá ofert to mieszkania do 100 m¬≤ w cenie do 1-1,2 mil z≈Ç.           
          </li>

          <div class="accordion" id="accordionPanelsStayOpenExample">
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button" type="button" data-bs-toggle="collapse" 
                data-bs-target="#panelsStayOpen-collapseSix" aria-expanded="true" aria-controls="panelsStayOpen-collapseSix">
<img src="css\p1_images\XY sq i n pokoi.png" style="width:100%" alt="">
                </button>
              </h2>
              <div id="panelsStayOpen-collapseSix" class="accordion-collapse collapse">
                <div class="accordion-body">
                  <pre><code class="language-python">
# Kod tylko dla lewego wykresu
chart = sns.jointplot(data=df, x='powierzchnia', y='Cena', 
                      hue='zabudowa', kind='scatter', cmap='Mako', 
ylim=(-1500000, 16000000), xlim=(-50, 500), linewidth = 0, height=8,
palette={"apartamentowiec": "slateblue", 
         "blok": "tan", 
         "kamienica": "mediumaquamarine", 
         "dom": "crimson"})
f = lambda x, pos: f'{x/10**6:,.0f}M'
chart.ax_joint.yaxis.set_major_formatter(ticker.FuncFormatter(f))
chart.ax_joint.set_xlabel("Powierzchnia [m¬≤]")
chart.ax_joint.set_ylabel("Cena [z≈Ç]")
                                      </code></pre>
                </div>
              </div>
            </div>
          </div>
          <li class="opis_wiz">
            Oferta mieszkania z dwoma pokojami i powierzchniƒÖ 216 m¬≤ to lokal mieszkalny o powierzchni 116 m¬≤ wraz z lokalem us≈Çugowym 100 m¬≤, k√≥ry wymaga wyko≈Ñczenia. 
            <br>Oferta zosta≈Ça usuniƒôta pzed modelowaniem. 
          </li>


          <div class="accordion" id="accordionPanelsStayOpenExample">
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button" type="button" data-bs-toggle="collapse" 
                data-bs-target="#panelsStayOpen-collapseSeven" aria-expanded="true" aria-controls="panelsStayOpen-collapseSeven">
<img src="css\p1_images\Histogram zabudowa.png" alt="">                </button>
              </h2>
              <div id="panelsStayOpen-collapseSeven" class="accordion-collapse collapse">
                <div class="accordion-body">

                  <pre><code>
fig, ax = plt.subplots(figsize=(9,6))
plt.xticks(rotation=-60)
chart = sns.histplot(
    df,
    x="lokalizacja", hue="zabudowa",
    multiple="stack",
    palette="viridis",)
chart.set_title('Rodzaj zabudowy')
chart.set(xlabel='Dzielnica', ylabel='Ilo≈õƒá')
                  </code></pre>

                </div>
              </div>
            </div>
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" 
                data-bs-target="#panelsStayOpen-collapseEight" aria-expanded="false" aria-controls="panelsStayOpen-collapseEight">
<img src="css\p1_images\Kolumnowy stan mieszka≈Ñ.png" alt="">
                </button>
              </h2>
              <div id="panelsStayOpen-collapseEight" class="accordion-collapse collapse">
                <div class="accordion-body">

                  <pre><code>
fig, ax = plt.subplots(figsize=(9,6))
plt.xticks(rotation=-60)
chart = sns.histplot(
    df,
    x="lokalizacja", hue="wykonczenie",
    multiple="stack",
    palette="flare",)
chart.set_title('Stan mieszka≈Ñ')
chart.set(xlabel='Dzielnica', ylabel='Ilo≈õƒá')
                  </code></pre>

                </div>
              </div>
            </div>
          </div>

<br>
          
          <div class="accordion" id="accordionPanelsStayOpenExample">
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button" type="button" data-bs-toggle="collapse" 
                data-bs-target="#panelsStayOpen-collapseTen" aria-expanded="true" aria-controls="panelsStayOpen-collapseTen">
<img src="css\p1_images\Odleg≈Ço≈õci.png" style="width: 100%;">                </button>
              </h2>
              <div id="panelsStayOpen-collapseTen" class="accordion-collapse collapse">
                <div class="accordion-body">
<pre><code>
  fig, ax = plt.subplots(figsize=(9,6))
  sns.histplot(df['Dystans do Swietokrzyskiej'],  
                      label="L do stacji ≈öwiƒôtokrzyska", 
                      kde=False, element="step", 
                      alpha=0.3)
  sns.histplot(df["dystans do najblizszej stacji [m]"],  
                      label="L do najbli≈ºszej stacji metra [m]", 
                      kde=False, element="step", alpha=0.3)
  ax.set_title('Odleg≈Ço≈õci do stacji metra')
  ax.set(xlabel='Odleg≈Ço≈õƒá [m]', ylabel='Czƒôsto≈õƒá')
  plt.legend() 
</code></pre>                </div>
              </div>
            </div>
          </div>

<br>

          <div class="accordion" id="accordionPanelsStayOpenExample">
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button" type="button" data-bs-toggle="collapse" 
                data-bs-target="#panelsStayOpen-collapseNine" aria-expanded="true" aria-controls="panelsStayOpen-collapseNine">
<img src="css\p1_images\Korelacje.png" style="width: 100%;">                </button>
              </h2>
              <div id="panelsStayOpen-collapseNine" class="accordion-collapse collapse">
                <div class="accordion-body">
<pre><code>
  fig, ax = plt.subplots(figsize=(9,8))
sns.heatmap(df.corr(), cmap='RdBu_r', annot=True, annot_kws={"fontsize":7},
    fmt=".2f",
    xticklabels=['Cena', 'Powierzchnia', 'Liczba pokoj√≥w', 'Piƒôtro', 'Parking', 'Rok budowy', 
    'Winda', '[m] do Centrum', '[m] do najbli≈ºszej stacji', 'Balkon', 'Ogr√≥d', 'Taras', 'Do remontu',
    'Do wyko≈Ñczenia', 'Do zamieszkania', 'Rynek pierwotny', 'Rynek wt√≥rny', 'Apartamentowiec', 'Blok', 'Dom', 'Kamienica'],
    yticklabels=['Cena', 'Powierzchnia', 'Liczba pokoj√≥w', 'Piƒôtro', 'Parking', 'Rok budowy', 
    'Winda', '[m] do Centrum', '[m] do najbli≈ºszej stacji', 'Balkon', 'Ogr√≥d', 'Taras', 'Do remontu',
    'Do wyko≈Ñczenia', 'Do zamieszkania', 'Rynek pierwotny', 'Rynek wt√≥rny', 'Apartamentowiec', 'Blok', 'Dom', 'Kamienica'])
</code></pre>                </div>
              </div>
            </div>
          </div>


          <br>
          <div class="wiz_uwagi">
            <h4 id="uwagi-header">Uwagi dotyczƒÖce korelacji</h4>
            <li>Wykres korelacji reprezentuje zale≈ºno≈õci warto≈õci miƒôdzy atrybutami. Je≈ºeli warto≈õƒá jest pozytywna, oznacza to ≈ºe wraz ze wzrostem warto≈õci w danej kolumnie, warto≈õƒá w danym wierszu r√≥wnie≈º wzro≈õnie, je≈ºeli bƒôdzie ujemna, zmaleje. Warto≈õci korelacji bli≈ºej 0 oznaczajƒÖ, ≈ºe  atrybut ma ma≈Çe znaczenie. 
            </li>
            <li>Pierwszym wartym zaznaczenia wnioskiem jest fakt, ≈ºe atrybuty odleg≈Ço≈õci do centrum i najbli≈ºszej stacji metra majƒÖ niema≈Çe znaczenie - sƒÖ to jedne z wiƒôkszych wynik√≥w (-0,24 i -0,2) po najwy≈ºej korelujƒÖcymi z cenƒÖ powierzchniƒÖ i liczbƒÖ pokoi. 
            </li>
            <li>Innymi znaczƒÖcymi atrybutami sƒÖ rodzaje zabudowy, w szczeg√≥lno≈õci blok (cena maleje) i apartamentowiec (cena ro≈õnie). Znaczna wiƒôkszo≈õƒá najdro≈ºszych mieszka≈Ñ by≈Ça apartamentowcami.
            </li>
            <li>Dom okaza≈Ç siƒô nieistotny, trzeba r√≥wnie≈º zaznaczyƒá, ≈ºe ilo≈õƒá ofert dom√≥w (tu po≈ÇƒÖczonych dom√≥w wolnostojƒÖcych i szeregowc√≥w) by≈Ça niedu≈ºa. Mo≈ºliwe ≈ºe uwzglƒôdnienie teren√≥w takich jak podmiejskie rejony Piaseczna z wieloma osiedlami dom√≥w jednorodzinnych da≈Çyby bardziej interesujƒÖce wyniki. 
            </li>
            <li>Co prawda jest zauwa≈ºalna bardzo du≈ºa korelacja miƒôdzy rokiem budowy a kamienicƒÖ, mo≈ºna przypuszczaƒá ≈ºe powinna byƒá jeszcze wiƒôksza. W≈õr√≥d ofert znajdowa≈Ço siƒô kilka kamienic, gdzie za rok budowy najprawdopodobniej podano rok generalnego remontu.
            </li>
            <li>InteresujƒÖca jest r√≥wnie≈º bliska zeru korelacja miƒôdzy tarasem a domem. Taras ma r√≥wnie≈º do≈õƒá wysokƒÖ korelacjƒô z cenƒÖ, powierzchniƒÖ i apartamentowcem, wiƒôc mo≈ºliwe jest ≈ºe dotyczƒÖ one np. rozleg≈Çych taras√≥w na dachach budynk√≥w.
            </li>
            <li>Stan mieszkania okaza≈Ç siƒô r√≥wnie≈º do≈õƒá nieznaczny w stosunku do ceny, niemniej rozk≈Çad korelacji - negatywny dla stanu do remontu i do wyko≈Ñczenia i pozytywny dla stanu do zamieszkania jest logiczny.
            </li>
          </div>
        
          </div>

          <div class="tresc modelowanie">
            <h4 id="modelowanie-header">Modelowanie</h4>
            Modelowanie przeprowadzono przy pomocy prostej regresji liniowej z biblioteki scikit-learn oraz sieci neuronowej Keras. Po oczyszczeniu danych pozosta≈Ço tylko dobranie danych dla wytrenowania modelu. 
            <br><br>
            
            Najpierw usuniƒôto kolumny 'pierwotny' (rynek) i 'do zamieszkania', poniewa≈º nie sƒÖ one ju≈º potrzebne - 0 w kolumnie 'do wyko≈Ñczenia' i 0 w kolumnie 'do remontu' wystarczƒÖ. Przy skorzystaniu z funkcji get_dummies mo≈ºna skorzystaƒá z drop_first=True by osiƒÖgnƒÖƒá ten efekt. Tu zosta≈Ço to zrobione dopiero na tym etapie w celu ja≈õniejszej wizualizacji korelacji. 
            <br><br>
            We wszystkich modelach test_size w Train-Test-Split ustawiono na 0.3 co oznacza, ≈ºe 70% danych zosta≈Ço przeznaczone na wytrenowanie modelu, a 30% na sprawdzenie. 
            <br><br>
            Do ewaluacji modelu wykorzystano:
            <li>MAE - Mean Absolute Error - ≈õredni b≈ÇƒÖd bezwzglƒôdny</li>
            <li>RMSE - Root Mean Squared Error - pierwiastek b≈Çƒôdu ≈õredniokwadratowego - bardziej wyczulony na du≈ºe b≈Çƒôdy, 
            mo≈ºna go ≈Çatwo interpretowaƒá dziƒôki pierwiastkowi (bez pierwiastka znany jako MSE)</li>
            <li>R¬≤ - wsp√≥≈Çczynnik determinacji - osiƒÖga warto≈õci od 0, do 1, wy≈ºsza warto≈õƒá oznacza lepiej dopasowanƒÖ liniƒô regresji</li>
            <br>

            $$MAE=\frac{1}{n}\sum^n_{i=1}|y_i-\hat{y_i}|$$	
            <!-- MAE - ≈õredni b≈ÇƒÖd bezwzglƒôdny - ≈õrednia z sumy warto≈õci bezwzglƒôdnych b≈Çƒôd√≥w -->
            $$RSME=\sqrt{\frac{1}{n}\sum^n_{i=1}(y_i-\hat{y_i})^2}$$
            $$R^2=1-\frac{\sum^n_{i=1}(y_i-\hat{y_i})^2}{\sum^n_{i=1}(y_i-\overline{y_i})^2}$$
            gdzie: 
            <li>\((y_i-\hat{y_i})^2\) to tzw. residuals, potƒôga r√≥≈ºnicy miƒôdzy warto≈õciƒÖ prawdziwƒÖ a warto≈õciƒÖ przewidywanƒÖ</li>
            <li>\((y_i-\overline{y_i})^2\) to wariancja, potƒôga r√≥≈ºnicy miƒôdzy prawdziwƒÖ warto≈õciƒÖ a ≈õredniƒÖ tego rodzaju warto≈õci</li>
            <!-- RMSE - pierwiastek b≈Çƒôdu ≈õredniokwadratowego - bardziej wyczulony na du≈ºe b≈Çƒôdy, mo≈ºna go ≈Çatwo interpretowaƒá dziƒôki pierwiastkowi (bez pierwiastka znany jako MSE) -->
            <br>MAE, MSE i RMSE sƒÖ warto≈õciami, kt√≥re chcemy zminimalizowaƒá podczas budowania modelu.
            <br><br>Modelowanie przeprowadzono dla kilku r√≥≈ºnych przedzia≈Ç√≥w - najpierw usuniƒôto mieszkania powy≈ºej 9 000 000 z≈Ç. Wyniki przedstawiono poni≈ºej. 


            <div class="card mb-6" style="max-width: 900px;">
              <div class="row g-0">
                <div class="col-md-8">
                  <img src="css\p1_images\9mil reg.png" class="img-fluid rounded-start" alt="...">
                </div>
                <div class="col-md-4">
                  <div class="card-body">
                    <h5 class="card-title">Regresja liniowa <br> do 9 mln z≈Ç</h5>
                    <li>MAE: 251 527 [z≈Ç]</li>
                    <li>RMSE: 393 270 [z≈Ç]</li>
                    <li>R¬≤: 0.80</li>     
                    <p class="card-text"><small class="text-body-secondary">Koszt mojego mieszkania: 365 607 z≈Ç</small></p>              
                  </div>
                </div>
              </div>
            </div>

            <div class="card mb-6" style="max-width: 900px;">
              <div class="row g-0">
                <div class="col-md-8">
                  <img src="css\p1_images\9mil keras.png" class="img-fluid rounded-start" alt="...">
                </div>
                <div class="col-md-4">
                  <div class="card-body">
                    <h5 class="card-title">Regresja TensorFlow<br> do 9 mln z≈Ç</h5>
                    <li>MAE: 697 458 [z≈Ç]</li>
                    <li>RMSE: 1 106 752 [z≈Ç]</li>
                    <li>R¬≤: 0.75</li>                    
                    <p class="card-text"><small class="text-body-secondary">Koszt mojego mieszkania: 531320 z≈Ç</small></p>
                  </div>
                </div>
              </div>
            </div>
            <br>
            Mimo wysokiego wyniku R¬≤ taki model nie jest zbyt praktyczny - ≈õrednie b≈Çƒôdy sƒÖ zbyt wysokie, w szczeg√≥lno≈õci 
            w przypadku RMSE dla sieci neuronowej TensorFlow gdzie RMSE wynosi ponad 1 mln z≈Ç, czyli trochƒô wiƒôcej ni≈º ≈õrednia cena mieszkania w zestawie danych. 
            Jest tu te≈º wyra≈∫nie widoczny efekt badania RMSE, kt√≥ry jest bardziej 'wyczulony' na warto≈õci mocno odbiegajƒÖce od warto≈õci ≈õrednich. 
            Dlatego w kolejnym podej≈õciu przedzia≈Ç danych ograniczono do cen od 125 000 do 2 500 000 mln z≈Ç. <br><br>
             
            
            <div class="card mb-6" style="max-width: 900px;">
              <div class="row g-0">
                <div class="col-md-8">
                  <img src="css\p1_images\2mil reg.png" class="img-fluid rounded-start" alt="...">
                </div>
                <div class="col-md-4">
                  <div class="card-body">
                    <h5 class="card-title">Regresja liniowa <br> do 2,5 mln z≈Ç</h5>
                    <li>MAE: 147 788 [z≈Ç]</li>
                    <li>RMSE: 211 835 [z≈Ç]</li>
                    <li>R¬≤: 0.75</li>     
                    <p class="card-text"><small class="text-body-secondary">Koszt mojego mieszkania: 494 160 z≈Ç</small></p>              
                  </div>
                </div>
              </div>
            </div>

            <div class="card mb-6" style="max-width: 900px;">
              <div class="row g-0">
                <div class="col-md-8">
                  <img src="css\p1_images\2mil keras.png" class="img-fluid rounded-start" alt="...">
                </div>
                <div class="col-md-4">
                  <div class="card-body">
                    <h5 class="card-title">Regresja TensorFlow<br> do 2,5 mln z≈Ç</h5>
                    <li>MAE: 412 673 [z≈Ç]</li>
                    <li>RMSE: 557 260 [z≈Ç]</li>
                    <li>R¬≤: 0.74</li>                    
                    <p class="card-text"><small class="text-body-secondary">Koszt mojego mieszkania: 531320 z≈Ç</small></p>
                  </div>
                </div>
              </div>
            </div>

            <br><br>

            <table class="table table-hover">
              <thead>
                <tr>
                  <th scope="col">Mieszkanie</th>
                  <th scope="col">LR <9 mln z≈Ç</th>
                  <th scope="col">TF <9 mln z≈Ç</th>
                  <th scope="col">LR <2,5 mln z≈Ç</th>
                  <th scope="col">TF <2,5 mln z≈Ç</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <th scope="row">37 m¬≤, blok, W≈Çochy</th>
                  <td>365 607 z≈Ç</td>
                  <td>531 320 z≈Ç</td>
                  <td>494 160 z≈Ç</td>
                  <td>531 320 z≈Ç</td>
                </tr>
                <tr>
                  <th scope="row">54 m¬≤, apartmanet, Kabaty</th>
                  <td>394 026 z≈Ç</td>
                  <td>628 492 z≈Ç</td>
                  <td>577 780 z≈Ç</td>
                  <td>667 709 z≈Ç</td>
                </tr>
                <tr>
                  <th scope="row">96 m¬≤, apartmanet, Natolin</th>
                  <td>1 501 197 z≈Ç</td>
                  <td>1 358 248 z≈Ç</td>
                  <td>1 397 107 z≈Ç</td>
                  <td>1 519 427 z≈Ç</td>

                </tr>
              </tbody>
            </table>

          </div>

        </div>
      </span>
        <div class="col-md-4"> <!-- SIDEBAR -->
          <div class="sticky">
            <p>Nawigacja:</p>
            <a href="#wstep-header">1. Wstƒôp</a> <br>
            <a href="#zebranie_danych-header">2. Zebranie danych</a> <br>
            <a href="#QGIS-header">3. Przetworzenie danych w QGIS</a> <br>
            <a href="#pandas-header">4. Oczyszczenie danych w Pandas</a> <br>
            <a href="#wizualizacja-header">5. Wizualizacja danych</a> <br>
            <a href="#uwagi-header" style="margin-left:15px">Uwagi dotyczƒÖce korelacji</a> <br>
            <a href="#modelowanie-header">6. Modelowanie</a> <br>
          </div>
        </div>
    </div>
      

    <script>hljs.highlightAll();</script>
  </body>
</html>