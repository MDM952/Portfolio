<!DOCTYPE html>
<html lang="en" dir="ltr">

    <head>
        <meta charset="utf-8">
        <title>Projekt III ü¶à</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
        <link rel="stylesheet" href="css/css_project_page.css">
        <link rel="stylesheet" href="css/cssmaster.css">
        <script src="scripts\copy mail.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Montserrat&display=swap" rel="stylesheet">
        <script src="https://kit.fontawesome.com/1c9ad4b785.js" crossorigin="anonymous"></script>

        <link rel="stylesheet" href="scripts\code highlight\styles\idea.min.css"/>
        <script src="scripts\code highlight\highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>

        <script type="text/javascript" id="MathJax-script" async
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
        </script>

        

      </head>
  <body>
      
    <section class="jumbotron text-center" id="top">
        <div class="container", style="padding: 40px;">
          <h2>Model przewidujƒÖcy jako≈õƒá horroru na podstawie jego tytu≈Çu 
            <br>(Niemal 100% skuteczno≈õci! Niezwykle praktyczny!)</h2>
          <p class="lead text-muted">
            Niezbyt powa≈ºny projekt dotyczƒÖcy przewidywania oceny horror√≥w klasy D na podstawie ich tytu≈Ç√≥w. 
            <br>Wizualizacja danych i model lasu losowego (random forest).
          </p>

          <div style="height: 40px;"></div>

          <div class="container">
            <div class="row justify-content-md-center">
              <div class="col col-lg-4">
                <div class="accordion" id="accordionPanelsStayOpenExample" style="width: 450px;">
                  <div class="accordion-item">
                    <h2 class="accordion-header" style="margin: auto;">
                      <button class="accordion-button" type="button" data-bs-toggle="collapse" 
                      data-bs-target="#panelsStayOpen-collapseTwelve" aria-expanded="true" aria-controls="panelsStayOpen-collapseTwelve">
                      Kontakt ‚Ü¥
                      </button>
                    </h2>
                    <div id="panelsStayOpen-collapseTwelve" class="accordion-collapse collapse" style="margin-top: 20px; margin-bottom: 20px">
                      <div class="accordion-body" style="padding: 5px" >
    <!-- The text field -->
    
                          <div class="container">
                            <div class="row" style="padding:0px">
                              <div class="col">
  
                                <div style="margin: auto; padding: auto;">
                                  <input type="text" 
                                  id="myInput" 
                                  class="form-control form-control-sm" 
                                  value="konrad.jarominiak0@gmail.com" disabled
                                 style="width: 220px">
                                </div>
  
  
                              </div>
                              <div class="col">
  
                                <div style="margin: auto; padding: auto;">
                                  <button type="button" class="btn btn-outline-secondary btn-sm" style="width: 140px; margin: 0;" onclick="myFunction()">skopiuj do schowka</button>
                                </div>
                              </div>
                            </div>
                            <div class="row">
                              <div class="col">
                                <div style="width: 220px; margin-top: 10px;">
                                  <a
                                  href="https://www.linkedin.com/in/konrad-jarominiak-941ba0294/"
                                  class="btn btn-outline-primary btn-sm"
                                  style="width: 120px; border-color: #0a66c2; "
                                  >
                                  LinkedIn
                                  </a>
                                </div>
  
                                </div>
                              <div class="col">
                                 
                              </div>
                            </div>
                          </div>
    
    
    
    
    <!-- The button used to copy the text -->
    
    
    <!-- The toast -->
                          <div aria-live="polite" aria-atomic="true" style="position: relative; min-height: 0px;">
                            <div class="toast" style="position: absolute; top: 0px; right: 0; width:250px">
                              <div class="toast-body">
                                Skopiowano do schowka!
                              </div>
                            </div>
                          </div>
                          
                      </div>
                    </div>
                  </div>
      
                </div>   
              </div>
  
              <div class="col col-lg-4">
                
  
                <div style="width: 450px; padding-top: 15px; padding-bottom: 15px;">
                  <a
                  href="index.html"
                  class="btn btn-secondary my-2"
                  >Powr√≥t do strony g≈Ç√≥wnej</a>
                </div>
  
              </div>
            </div>
          </div>


          <div class="true_center">
            <div class="row" style="margin:margin-top: 40px; width: 100%">
              <div class="col col-sm">
             </div>
              <div class="col col-sm">

              </div>
            </div>
          </div>





          

        </div>
    </section>

    <span class="border border-0">

    <div style="height: 30px;"></div>

    <div class="container">
      <div class="row">
        <div class="col-md-9"> <!--TU ZWIJAƒÜ-->

          <div class="tresc wstep">
            <h4 id="wstep-header">1. Wstƒôp</h4>
            Pomys≈Ç na ten projekt zrodzi≈Ç siƒô z przemy≈õle≈Ñ nad zatrzƒôsieniem niezaprzeczalnie fatalnych, tanich film√≥w na serwisach VOD, 
            kt√≥rych jedynym celem jest <a href="https://www.giantfreakinrobot.com/ent/watchbait-new-clickbait.html">przyciƒÖgniƒôcie</a> 
            widza swoim tytu≈Çem nawiƒÖzujƒÖcym do starych, s≈Çynnych film√≥w. 
            Przyk≈Çadowo multum film√≥w o rekinach udajƒÖcych sequele "Szczƒôk" Spielberg'a.
            <br> <br>  
            Czy mo≈ºna przewidzieƒá powodzenie takiego filmu na podstawie jego tytu≈Çu? 
            Ten projekt jest pr√≥bƒÖ utworzenia modelu, kt√≥ry przewiduje oceny horror√≥w i ich podr√≥bek na podstawie ich tytu≈Ç√≥w.
            <br><br>
            Projekt opiera siƒô na zestawie danych z <a href="https://www.kaggle.com/datasets/rounakbanik/the-movies-dataset?select=movies_metadata.csv">Kaggle</a>,
            kt√≥ry, wed≈Çug opisu, jest po≈ÇƒÖczeniem danych z <a href="https://www.kaggle.com/datasets/rounakbanik/the-movies-dataset?select=movies_metadata.csv">TMDB</a> i 
            <a href="https://grouplens.org/datasets/movielens/">MovieLens</a>.
            <br>
            Do wykonania niniejszego projektu wykorzystano biblioteki:
            <div style="height: 3px;"></div>

            <ul>
            <li>Pandas i Numpy do przetworzenia i oczyszczenia danych</li>
            <li>Matplotlib i Seaborn do wizualizacji danych</li>
            <li>sci-kit learn do stworzenia modelu</li>
            </ul>

          </div>

          <div class="tresc analiza_zestawu_danych">
            <h4 id="analiza_zestawu_danych-header">2. Analiza zestawu danych</h4>

            W tabeli znajdujƒÖ siƒô 24 kolumny dotyczƒÖce danych poszczeg√≥lnych film√≥w, np. tytu≈Ç, tagline, popularno≈õƒá, przych√≥d, opis, etc.
            Na potrzeby modelu, kolumny kt√≥re by≈Çyby przydatne to:

            <ul>
            <li>tytu≈Ç</li> 
            <li>gatunek</li>
            <li>bud≈ºet</li>
            <li>przych√≥d</li>
            <li>ocena</li>
            </ul>

            W pierwszej kolejno≈õci spisano listƒô cz≈Çon√≥w tytu≈Ç√≥w. Cze≈õƒá z nich mo≈ºe wyglƒÖdaƒá do≈õƒá dziwnie, np. 'Dea'.
            Taki cz≈Çon ma wy≈Çapaƒá tytu≈Çy zawierajƒÖce zar√≥wno 'Death' jak i 'Dead'. Cz≈Çony ≈ÇƒÖczƒÖ siƒô w tytu≈Çy jak np.
            'shark' i 'tornado' w <a href="https://www.imdb.com/title/tt2724064/">Sharknado</a>. 
            <br><br>
            Lista cz≈Çon√≥w przedstawia siƒô nastƒôpujƒÖco:
<div style="height: 9px;"></div>

            <div class="container text-left">
              <div class="row">

                <div class="col">
                  <li>3D</li>
                </div>
                <div class="col">
                  <li>American</li>
                </div>
                <div class="col">
                  <li>Asylum</li>
                </div>
                <div class="col">
                  <li>Blac</li>
                </div>
                <div class="col">
                  <li>Blood</li>
                </div>
                
                </div>
                <div class="row">
                
                <div class="col">
                  <li>Chainsaw</li>
                </div>
                <div class="col">
                  <li>Child</li>
                </div>
                <div class="col">
                  <li>Clown</li>
                </div>
                <div class="col">
                  <li>Conjur</li>
                </div>
                <div class="col">
                  <li>Corn</li>
                </div>
                
                </div>
                <div class="row">
                
                <div class="col">
                  <li>Cula</li>
                </div>
                <div class="col">
                  <li>Curs</li>
                </div>
                <div class="col">
                  <li>Dea</li>
                </div>
                <div class="col">
                  <li>Demon</li>
                </div>
                <div class="col">
                  <li>Devil</li>
                </div>
                
                </div>
                <div class="row">
                
                <div class="col">
                  <li>Dino</li>
                </div>
                <div class="col">
                  <li>Evil</li>
                </div>
                <div class="col">
                  <li>Exorc</li>
                </div>
                <div class="col">
                  <li>Fear</li>
                </div>
                <div class="col">
                  <li>Final</li>
                </div>
                
                </div>
                <div class="row">
                
                <div class="col">
                  <li>Geist</li>
                </div>
                <div class="col">
                  <li>Haunt</li>
                </div>
                <div class="col">
                  <li>House</li>
                </div>
                <div class="col">
                  <li>Kill</li>
                </div>
                <div class="col">
                  <li>Land</li>
                </div>
                
                </div>
                <div class="row">
                
                <div class="col">
                  <li>Monster</li>
                </div>
                <div class="col">
                  <li>Moon</li>
                </div>
                <div class="col">
                  <li>Mummy</li>
                </div>
                <div class="col">
                  <li>Nado</li>
                </div>
                <div class="col">
                  <li>Night</li>
                </div>
                
                </div>
                <div class="row">
                
                <div class="col">
                  <li>Nurse</li>
                </div>
                <div class="col">
                  <li>Ouija</li>
                </div>
                <div class="col">
                  <li>Psycho</li>
                </div>
                <div class="col">
                  <li>Scar</li>
                </div>
                <div class="col">
                  <li>Scream</li>
                </div>
                
                </div>
                <div class="row">
                
                <div class="col">
                  <li>Shark</li>
                </div>
                <div class="col">
                  <li>Stein</li>
                </div>
                <div class="col">
                  <li>Texas</li>
                </div>
                <div class="col">
                  <li>Town</li>
                </div>
                <div class="col">
                  <li>Vengeance</li>
                </div>
                
                </div>
                <div class="row">
                
                <div class="col">
                  <li>Ville</li>
                </div>
                <div class="col">
                  <li>Virus</li>
                </div>
                <div class="col">
                  <li>Witch</li>
                </div>
                <div class="col">
                  <li>Wolf</li>
                </div>
                <div class="col">
                  <li>Zombie</li>
                </div>
                
                </div>
                
            </div>

            <br><br>
            Nastƒôpnie utworzono funkcjƒô agregujƒÖcƒÖ tytu≈Çy do sprawdzenia ilo≈õci film√≥w z danymi cz≈Çonami.

            <pre><code>
shape_amount = {}

def check_amount(part_to_check):

    # czƒô≈õƒá weryfikujƒÖca
    print(f'Title part: "{part_to_check}"')
    print(f'Amount: {df[df["original_title"].str.contains(part_to_check, case=False)].shape[0]}')
    print(f'Avg score: {df[df["original_title"].str.contains(part_to_check, case=False)]["vote_average"].mean().round(2)}')

    # czƒô≈õƒá agregujƒÖca
    shape_amount[part_to_check] = df[df["original_title"].str.contains(part_to_check, case=False)].shape[0]
    

check_amount(random.sample(title_parts, 1)[0]) # sprawdzamy losowy cz≈Çon

# out:
Title part: "Moon"
Amount: 16
Avg score: 4.25
            </code></pre>

            Na podstawie danych zagregowanych do s≈Çownika utworzono dataframe i wykres kolumnowy z ilo≈õciƒÖ tytu≈Ç√≥w zawierajƒÖcƒÖ dany cz≈Çon. 
            <br> Wykres ten zawiera 1425 cz≈Çon√≥w, z czego 208 to duplikaty, co oznacza, 
            ≈ºe 17% tytu≈Ç√≥w jest przynajmniej dwucz≈Çonowa.

            <div class="accordion" id="accordionPanelsStayOpenExample">
              <div class="accordion-item">
                <h2 class="accordion-header">
                  <button class="accordion-button" type="button" data-bs-toggle="collapse" 
                  data-bs-target="#panelsStayOpen-collapseNine" aria-expanded="true" aria-controls="panelsStayOpen-collapseNine", style="padding: auto;">
                    <img src="css\p3_images\title parts amount.png" style="max-width: 100%; margin: auto;">                
                  </button> 
                </h2>
                <div id="panelsStayOpen-collapseNine" class="accordion-collapse collapse">
                  <div class="accordion-body">
  <pre><code>
sf = pd.DataFrame.from_dict(shape_amount, orient='index', columns=['amount'])
sf = sf.sort_values('amount', ascending=False)

fig, ax = plt.subplots(figsize=(9,6))
plt.xticks(rotation=90)
chart = sns.barplot(data=sf, x=sf.index, y='amount', palette='plasma')
chart.set_title('Rozk≈Çad czƒô≈õci tytu≈Ç√≥w')
chart.set(xlabel='Czƒô≈õƒá tytu≈Çu', ylabel='Ilo≈õƒá')
  </code></pre>                </div>
                </div>
              </div>
            </div>

            <br>
            Kolejno przefiltrowano zestaw danych tak, aby pozosta≈Çy tylko te horrory, kt√≥re zawierajƒÖ przynajmniej jeden cz≈Çon z naszej listy.
            Sprawdzono r√≥wnie≈º jaka ilo≈õƒá film√≥w zawiera dane dotyczƒÖce bud≈ºetu i przychodu. 
            Niestety znaczna wiƒôkszo≈õƒá z nich nie ma tych warto≈õci sprecyzowanych i ostatecznie kolumny 'budget' i 'revenue' zosta≈Çy usuniƒôte przed modelowaniem.
            Tak du≈ºe ilo≈õci brakujƒÖcych danych bardzo negatywnie wp≈Çynƒô≈Çyby na jako≈õƒá modelu. 
            <br> <br>



            <pre><code> <!-- Kod dla pokole≈Ñ i dystansu -->
watchbait_df = pd.DataFrame()

for i in title_parts:
    current_part = df[df["original_title"].str.contains(i, case=False)]
    print(f'"{i}" in titles: {current_part.shape[0]}; Average score: {current_part["vote_average"].mean().round(1)}')
    watchbait_df = pd.concat([watchbait_df, current_part], ignore_index=True)

# out:
"Zombie" in titles: 47; Average score: 4.5

print(f'Budget over 0: {watchbait_df[watchbait_df["budget"] > 0].shape[0]}')
print(f'Revenue over 0: {watchbait_df[watchbait_df["revenue"] > 0].shape[0]}')
print(f'Total amount of titles: {watchbait_df.shape[0]}')

# out:
Budget over 0: 419
Revenue over 0: 251
Total amount of titles: 1425
            </code></pre>

            Usuniƒôto r√≥wnie≈º filmy z ilo≈õciƒÖ ocen 0, 1 i 2. 
            Filmy z ilo≈õciƒÖ ocen r√≥wnƒÖ 3 mia≈Çy wystarczajƒÖco sensowne wyniki tzn. oceny by≈Çy niewiƒôksze ni≈º 7. 
            Gdyby ko≈Ñcowy rozmiar zestawu danych nie by≈Ç ma≈Çy (115 tytu≈Ç√≥w), odciƒôcie po ilo≈õci ocen oczywi≈õcie by zwiƒôkszono np. do 10.
            Kolejno przeprowadzono nastƒôpujƒÖce operacje:

            <li>Usuniƒôto duplikaty</li>
            <li>Ograniczono tabelƒô do tytu≈Çu, oceny i ilo≈õci ocen</li>
            <li>Przeprowadzon one-hot encoding cz≈Çon√≥w tytu≈Ç√≥w</li>
            <li>Utworzono uproszczonƒÖ kolumnƒô ocen - 'Rating' z trzema mo≈ºliwymi stopniami: 'Good', 'Decent', 'Awful'. Te warto≈õci bƒôdzie przewidywa≈Ç model. 
              Przedzia≈Çy wyznaczono na podstawie ko≈Ñcowego histogramu ocen, zamieszczonego poni≈ºej.</li>
            <li>Ograniczono tytu≈Çy tylko do tych, kt√≥re majƒÖ przynajmniej dwucz≈Çonowe tytu≈Çy - tu ilo≈õƒá film√≥w spad≈Ça do 115. </li>
            <br>

            <div class="accordion" id="accordionPanelsStayOpenExample">
              <div class="accordion-item">
                <h2 class="accordion-header">
                  <button class="accordion-button" type="button" data-bs-toggle="collapse" 
                  data-bs-target="#panelsStayOpen-collapseSeven" aria-expanded="true" aria-controls="panelsStayOpen-collapseSeven">
                    Kod dla procedur powy≈ºej
                  </button>
                </h2>
                <div id="panelsStayOpen-collapseSeven" class="accordion-collapse collapse">
                  <div class="accordion-body">
  
                    <pre><code>
  # usuniƒôcie duplikat√≥w
  print(f'Before duplicate removal: {df.shape[0]}')
  df = df.drop_duplicates()
  print(f'After duplicate removal: {df.shape[0]}\n')
  
  # out:
  Before duplicate removal: 1425
  After duplicate removal: 1218
  
  
  # ograniczenie df do istotnych kolumn
  df = df[['title', 'vote_average', 'vote_count']]
  
  
  # one-hot encoding cz≈Çon√≥w
  def get_part(title, part):
      if part.lower() in title.lower():
          return 1
      else:
          return 0
  
  for title_part in title_parts:
      df[title_part] = df['title'].apply(lambda x: get_part(x, title_part))
  
  
  def uniform_score(vote):
      if vote >= 6.5:
          return 'Good'
      elif vote >= 4 and vote < 6.5:
          return 'Decent'
      elif vote < 4:
          return 'Awful'
  
  df['Rating'] = df["vote_average"].apply(lambda x: uniform_score(x))
  
  
  # uciƒôcie do min. dwucz≈Çonowych film√≥w, to p√≥jdzie do modelowania
  df_cut = df[df["Title parts"] > 1]
                    </code></pre>
  
                  </div>
                </div>
              </div>
              <div class="accordion-item">
                <h2 class="accordion-header">
                  <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" 
                  data-bs-target="#panelsStayOpen-collapseEight" aria-expanded="false" aria-controls="panelsStayOpen-collapseEight">
  <img src="css\p3_images\histogram ocen.png" style="margin:auto" alt="">
                  </button>
                </h2>
                <div id="panelsStayOpen-collapseEight" class="accordion-collapse collapse">
                  <div class="accordion-body">
  
                    <pre><code>
sns.set_style('white')

plt.figure(figsize=(9, 5))
ax = sns.histplot(df_cut['vote_average'], binwidth=.2, color='#1d76bf',)

plt.xticks(np.arange(1, 9, 1))
plt.yticks(np.arange(0, 12, 2))
ax.set_title('Histogram ocen', fontdict={'fontsize':12})
ax.set_xlabel('≈örednia ocena', fontdict={'fontsize':11})
ax.set_ylabel('Czƒôsto≈õƒá', fontdict={'fontsize':11})
                    </code></pre>
  
                  </div>
                </div>
              </div>
            </div>
<br>


          </div>
            <div class="tresc analiza_zestawu_danych">
              <h4 id="wizualizacja-header">3. Sprawdzenie korelacji</h4>

              Przed rozpoczƒôciem modelowania sprawdzono, 
              czy w zestawie danych istnieje zale≈ºno≈õƒá miƒôdzy samymi cz≈Çonami tytu≈Ç√≥w a ocenƒÖ film√≥w.
              Dokonano tego zestawiajƒÖc korelacjƒô cz≈Çon√≥w do oceny (s≈Çupki) wraz samƒÖ ≈õredniƒÖ ocenƒÖ dla danego cz≈Çonu (linia).
              
              <br>
              
          <div class="accordion" id="accordionPanelsStayOpenExample">
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button" type="button" data-bs-toggle="collapse" 
                data-bs-target="#panelsStayOpen-collapseFivee" aria-expanded="true" aria-controls="panelsStayOpen-collapseFivee">
<img src="css\p3_images\titlepart and corr.png" style="width: 100%;" alt="">
                </button>
              </h2>
              <div id="panelsStayOpen-collapseFivee" class="accordion-collapse collapse">
                <div class="accordion-body">
                  <pre><code class="language-python">
# kolumna cz≈Çonu do oceny
corr_matrix = df_cut.corr()['vote_average'][1:]

# dodanie kolumny ocen do df, do naniesienia na wykresie jako liniƒô
dfc_cut = pd.concat([corr_matrix, pd.Series(avg_title_dict)], axis=1)
dfc_cut.columns = ['correlation', 'vote_average']

# poprawka i usuniƒôcie cz≈Çon√≥w bez korelacji
dfc_cut = dfc_cut.reset_index()
dfc_cut.columns = ['title', 'correlation', 'vote_average']
dfc_cut.dropna(inplace=True)

# wykres
fig, ax = plt.subplots(figsize=(10,7))
plt.xticks(rotation=90)
plt.rcParams['font.size'] = 8

# naniesienie korelacji jako s≈Çupki z sortowaniem po korelacji
ax = sns.barplot(data=dfc_cut.sort_values(by='correlation'), x='title', y='correlation', palette='magma')
ax.set_ylim(-0.35, 0.35)
ax.set_ylabel('Korelacja (s≈Çupki)', fontdict={'fontsize':9})

# naniesienie ocen jako linii z sortowaniem po korelacji
ax2 = ax.twinx()
sns.lineplot(data=dfc_cut.sort_values(by='correlation'), x='title', y='vote_average', ax=ax2, marker='.', color='royalblue')
ax2.set_ylabel('Vote Average', fontdict={'fontsize':10})
ax2.set_ylabel('≈örednia ocena (linia)')

# formatowanie
ax.set_xlabel('Cz≈Çon tytu≈Çu', fontdict={'fontsize':'10'})
plt.title('Korelacja i ≈õrednia ocena cz≈Çon√≥w tytu≈Ç√≥w', fontdict={'fontsize':11})
                    </code></pre>
                </div>
              </div>
            </div>
          </div>
          <li class="opis_wiz">
            Korelacje sƒÖ niskie, czego mo≈ºna siƒô by≈Ço spodziewaƒá.
          </li>

          <li class="opis_wiz">
            W niekt√≥rych cz≈Çonach wystƒôpuje dziwny stosunek korelacji do oceny, 
            w szczeg√≥lno≈õci "Shark" - cz≈Çon ten ma najni≈ºszƒÖ ≈õredniƒÖ ocenƒô film√≥w, jednak jego korelacja jest bliska 0.
            Byƒá mo≈ºe wynika to z wystƒôpowania innych cz≈Çon√≥w wraz z cz≈Çonem "Shark".

          </li>
          <li class="opis_wiz">
            Najgorszym cz≈Çonem okaza≈Ço siƒô "Zombie", co ma sens, przede wszystkim ze wzglƒôdu na czƒôsto≈õƒá tego cz≈Çonu. 
            
          </li>
          <li class="opis_wiz">
            Warto zn√≥w poruszyƒá problem braku r√≥wnowagi w ilo≈õci poszczeg√≥lnych atrybut√≥w i wp≈Çywu na korelacjƒô, jak w przypadku pokole≈Ñ w projekcie ocen us≈Çug lotniczych.
            Aby warto≈õci korelacji najlepiej oddawa≈Çy te zale≈ºno≈õci, istotne jest aby dane atrybuty by≈Çy w miarƒô r√≥wno reprezentowane. 
          </li>

          
          </div>

          <div class="tresc modelowanie">

            <h4 id="modelowanie-header">4. Modelowanie</h4>
            Do modelowania wykorzystano tzw. <span class="eng">las losowy</span> (ang. random forest), ≈õwietny model do klasyfikacji. 
            Metoda lasu losowego opiera siƒô na wykorzystywaniu wielu drzewek decyzyjnych, 
            gdzie ka≈ºdy z nich otrzymuje inny, losowo wybrany podzbi√≥r danych uczƒÖcych.

            <h6>Dzia≈Çanie drzewek decyzyjnych</h6>
            Drzewo decyzyjne polega na podzia≈Çach zestawu danych na podzbiory, w taki spos√≥b, 
            aby jak najlepiej rozr√≥≈ºniƒá je na podstawie danego atrybutu (np. pogoda - s≈Çonecznie/pochmurnie czy waga - powy≈ºej/poni≈ºej 7kg).
            

            <br><br>
            <div class="d-flex align-items-center justify-content-center">
              <figure class="figure mx-auto">
                <img src="css\p3_images\Drzewko decyzyjne v2.png" class="figure-img img-fluid rounded" alt="...">
                <figcaption class="figure-caption">Schemat budowy drzewa decyzyjnego</figcaption>
              </figure>
            </div>


            Podzia≈Ç zbior√≥w mo≈ºna oprzeƒá na kilku r√≥≈ºnych metodach, m.in. na wsp√≥≈Çczynniku Giniego, entropii lub przyro≈õcie informacj.
            Domy≈õlnym sposobem w bibliotece sci-kit learn to wsp. Giniego, czyli miarze nier√≥wnomierno≈õci (ang. measure of impurity), kt√≥ra w przypadku drzew decyzyjnych osiƒÖga warto≈õci od 0 do 0,5.
            Wz√≥r wyglƒÖda nastƒôpujƒÖco:

            $$G_i = 1 - \sum_{j=1}^C p^2_{i,j}$$

            gdzie: 
            <li>\(G_i\) to wsp√≥≈Çczynnik Giniego dla danego wƒôz≈Ça \(i\)</li>
            <li>\(C\) to il≈õƒá klas</li>
            <li>\(p^2_{i,j}\) to stosunek pr√≥bek w danym wƒô≈∫le \(i\), kt√≥re nale≈ºƒÖ do danej klasy \(j\)</li>
            <div style="height: 9px;"></div>
            Czyli przyk≈Çadowo: w wƒô≈∫le dzielƒÖcym zbi√≥r wg wieku (Wiek ‚â§ 32 lat) z 339 pr√≥bkami rozdzielono je na 272 pr√≥bek spe≈ÇniajƒÖcych warunek i 67 nie spe≈ÇniajƒÖcych. Wsp√≥≈Çczynnik Giniego dla tego wƒôz≈Ça wyni√≥s≈Ç:

            $$G = 1 - (272/339)^2 - (67/339)^2$$
            $$G = 1 - 0,64 - 0,04$$
            $$G = 0,32$$

            Im \(G\) jest bli≈ºsze 0, tym podzia≈Ç bƒôdzie bardziej jednoznaczny (np. \(G=0,12\) dla stosunku \(2-29\)), a klasyfikacja trafniejsza.

            Takie podzia≈Çy mo≈ºna tworzyƒá na wiele sposob√≥w, a zestaw danych mo≈ºna dzieliƒá, a≈º w ko≈Ñcowych odnogach drzewa (li≈õciach), znajdzie siƒô okre≈õlona wcze≈õniej minimalna ilo≈õƒá pr√≥bek, 
            lub pojedyncze klasy. W takim przypadku model zostatnie totalnie przeuczony.
            Niestety pojedyncze drzewa losowe nie sƒÖ zbyt trafnymi modelami, m.in. ze wzglƒôdu na ich podatno≈õƒá na przeuczenie.




            <br><br>
            <h6>Dzia≈Çanie lasu losowego</h6>
            <div style="height: 9px;"></div>
            Las losowy jest bardziej zaawansowanƒÖ wersjƒÖ drzewa decyzyjnego, kt√≥ra wykorzystuje wiele drzew oraz techniki <span class="eng">bagging</span> i <span class="eng">feature randomness</span>: 
            <li><span class="eng">bagging</span> (inaczej Bootstrap Aggregation) - losowe wybieranie pr√≥bek z powt√≥rzeniami, w jednym podzbiorze przekazanym do drzewa decyzyjnego mo≈ºe znale≈∫ƒá siƒô kilka takich samych pr√≥bek.</li>
            <li><span class="eng">feature randomness</span> - losowe wybieranie, jaka czƒô≈õƒá cech (kolumn zestawu danych np. wiek, waga) zostanƒÖ wykorzystane w wƒôz≈Çach drzewa. 
              W drzewach decyzyjnych model rozpatruje wszystkie cechy zbioru (ale niekoniecznie wykorzystuje wszystkie).</li>
              <div style="height: 9px;"></div>
              Techniki te redukujƒÖ powiƒÖzania miƒôdzy osobnymi drzewami decyzyjnymi lasu losowego, dziƒôki czemu mo≈ºna uniknƒÖƒá nadmiernego dopasowania danych.

            <br><br>
            Podczas modelowania wykorzystano GridSearch, czyli narzƒôdzie por√≥wnujƒÖce jako≈õƒá modeli, w zale≈ºno≈õci od warto≈õci parametr√≥w im nadanych, kt√≥re wyprowadza najlepsze parametry modelu. 
            Te parametry to:
            <li>n_estimators - ilo≈õƒá drzew w lesie, domy≈õlna ilo≈õƒá to 100</li> 
            <li>max_depth - maksymalna g≈Çƒôboko≈õƒá wƒôz≈Ç√≥w drzew, nadanie maksymalnej g≈Çƒôboko≈õci zapobiega nadmiernemu dopasowaniu</li>
            <li>min_samples_split - ile ga≈Çƒôzi wychodzi z wƒôz≈Ça</li>
            <li>max_features - ile cech bƒôdzie analizowane w modelu, jest to parametr decydujƒÖcy o w.w. feature randomness</li>

              Przedstawiony poni≈ºej las losowy przewiduje, kt√≥rƒÖ z ocen 'Good', 'Decent', 'Awful' otrzyma film na podstawie cz≈Çon√≥w tytu≈Ç√≥w.

              <pre><code>
X = df_cut.drop(["title", "vote_average", "Rating", "Title parts"], axis=1)
y = df_cut["Rating"]

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3)

from sklearn.model_selection import GridSearchCV

param_grid = {
	'n_estimators': [103, 104, 105],
	'max_depth': [10, 11, 12, None],
	'min_samples_split': [2, 4],
	'max_features': ['sqrt', 'log2']
}

grid_search = GridSearchCV(estimator=RandomForestClassifier(),
						  param_grid=param_grid,
						  verbose=True) # informacja o przebiegu

grid_search.fit(X_train, y_train)

grid_search.best_estimator_ 
forest = grid_search.best_estimator_

print(forest.score(X_test, y_test))
# out:
0.78125
              </code></pre>
              PoczƒÖtkowo, przed zastosowaniem wielu poprawek  w modelu i przed u≈ºyciem metody GridSearch modele osiƒÖga≈Çy celno≈õƒá poni≈ºej 50%. 
              Obecna celno≈õƒá modelu jest wiƒôc trochƒô zaskakujƒÖca. Pozosta≈Ço sprawdzenie na ile sensowne sƒÖ przewidziane przez model oceny.
              Najpierw wykonano funkcjƒô do ≈Çatwego sprawdzania oceny filmu.

              <pre><code>
def get_scoring(your_title):
    my_dict = {
        'title' : your_title
    }

    my_title = pd.DataFrame.from_dict([my_dict])

    for title_part in title_parts:
        my_title[title_part] = my_title['title'].apply(lambda x: get_part(x, title_part))

    return forest.predict(my_title.drop('title', axis=1))[0]
              </code></pre>

              Nastƒôpnie sprawdzono kilka tytu≈Ç√≥w i przewidziane dla nich oceny. Poni≈ºej przedstawiono kilka wynik√≥w. 
              

              <pre><code>
get_scoring("House of demons")
# out:
'Decent'

get_scoring("House of demon zombies") 
# out:
'Awful'

get_scoring("Blood of demon children")
# out:
'Decent'

get_scoring("Zombie devils and mummy of the moonscar") # tu wrzucono 5 cz≈Çon√≥w
# out:
'Decent'

get_scoring('Sharks vs zombies vs bloody mummy 3D')
# out:
'Awful'

get_scoring('Fear the Mummy!')
# out:
'Good'

get_scoring('American Exorcist')
# out:
'Decent'
              </code></pre>

            <h4 id="wnioski-header">5. Wnioski</h4>
              Model, kt√≥ry pierwotnie by≈Ç jedynie niepowa≈ºnym ≈ºartem, okaza≈Ç siƒô do≈õƒá celny. 
              Choƒá nie mo≈ºna o nim powiedzieƒá, ≈ºe ma prawdziwie praktyczne zastosowanie, spe≈Çnia on pierwotnie zamierzonƒÖ funkcjƒô. 
              Mo≈ºna powiedzieƒá, ≈ºe jest nieco bardziej zaawansowanƒÖ odmianƒÖ generator√≥w nazw zespo≈Ç√≥w heavy metalowych.
              Poni≈ºej zamieszczono parƒô wniosk√≥w i uwag.
            <li>Model by≈Ç oparty na bardzo ma≈Çej ilo≈õci danych, mimo to uda≈Ço siƒô co≈õ z nich wyciƒÖgnƒÖƒá.</li>
            <li>Model wskazuje wszystkie spo≈õr√≥d 3 mo≈ºliwych ocen.</li>
            <li>Ilo≈õƒá cz≈Çon√≥w nie ma znaczenia, model w pewnym sensie wyprowadza 'u≈õrednienie' cz≈Çon√≥w.</li>
            <li>Wcze≈õniej przedstawiona korelacja okaza≈Ça siƒô w ca≈Çkiem prawdziwa - np. cz≈Çon 'Zombie' zani≈ºa oceny tytu≈Ç√≥w, ale nie do takiego stopnia, ≈ºe ka≈ºdy film z tym cz≈Çonem dostanie ocenƒô 'Awful'.</li>
            <li>Ciekawe, jak na model wp≈Çynƒô≈Çaby obecno≈õƒá cech takich jak bud≈ºet i przych√≥d. 
              Najprostszym sposobem by≈Çoby sprawdzenie, czy film zarobi≈Ç lub nie, lub jaki jest stosunek bud≈ºetu do przychodu. 
              Najpewniej wiƒôkszo≈õƒá film√≥w, kt√≥re by na siebie nie zarobi≈Çy, mia≈Çyby negatywne oceny.
              Jednak mo≈ºe zaistnia≈Çaby taka sytuacja, gdzie film nie zarobi≈Ç na siebie, a otrzyma≈Ç pozytywnƒÖ ocenƒô. W jaki spos√≥b cz≈Çony tytu≈Çu takich film√≥w wp≈Çynƒô≈Çyby na model?</li>







          </div>

        </div>
      </span>
        <div class="col-md-3" style="padding-left: 36px;"> <!-- SIDEBAR -->
          <div class="sticky">
            <p>Nawigacja:</p>
            <a href="#top">1. Wstƒôp</a> <br>
            <a href="#analiza_zestawu_danych-header">2. Analiza zestawu danych</a> <br>
            <a href="#wizualizacja-header">3. Wizualizacja danych</a> <br>
            <a href="#modelowanie-header">4. Modelowanie</a> <br>
            <a href="#wnioski-header">5. Wnioski</a> <br>

            <hr style="width: 200px; margin-top: 26px; margin-bottom: 20px">

            <a href="#top">Powr√≥t do poczƒÖtku</a> <br>
          </div>
        </div>
    </div>
      
    <section class="jumbotron text-center">
      <div class="container", style="padding-top: 90px;">
        <p>
          <a href="#top" class="btn btn-outline-secondary my-2 botbuttons" >Powr√≥t do poczƒÖtku</a>
          <a href="index.html"class="btn btn-secondary my-2 botbuttons" >Powr√≥t do strony g≈Ç√≥wnej</a>
        </p>
      </div>
  </section>


    <div id="footer", class="bottom", style="font-size:0.77em;">      
          <p style="margin:5px;">&copy; <script>document.write(new Date().getFullYear());</script> Konrad Jarominiak</p>
          <p>Wykorzystano:
            <a href="https://getbootstrap.com/" class="footer-link">Bootsrap 5</a>,
            <a href="https://highlightjs.org/" class="footer-link">highlight.js</a>,
            <a href="https://www.mathjax.org/" class="footer-link">MathJax</a> </p>
      
        </div>

    <script>hljs.highlightAll();</script>
  </body>
</html>