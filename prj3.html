<!DOCTYPE html>
<html lang="en" dir="ltr">

    <head>
        <meta charset="utf-8">
        <title>Projekt III ğŸ¦ˆ</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
        <link rel="stylesheet" href="css/css_project_page.css">
        <link rel="stylesheet" href="css/cssmaster.css">
        <script src="scripts\copy mail.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Montserrat&display=swap" rel="stylesheet">
        <script src="https://kit.fontawesome.com/1c9ad4b785.js" crossorigin="anonymous"></script>

        <link rel="stylesheet" href="scripts\code highlight\styles\idea.min.css"/>
        <script src="scripts\code highlight\highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>

        <script type="text/javascript" id="MathJax-script" async
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
        </script>

        

      </head>
  <body>
      
    <section class="jumbotron text-center">
        <div class="container", style="padding: 40px;">
          <h2>Model przewidujÄ…cy jakoÅ›Ä‡ horroru na podstawie jego tytuÅ‚u 
            <br>(100% skutecznoÅ›ci! Niezwykle praktyczny!)</h2>
          <p class="lead text-muted">
            Niezbyt powaÅ¼ny projekt dotyczÄ…cy przewidywania oceny horrorÃ³w klasy D, na podstawie ich tytuÅ‚Ã³w. 
            <br>Wizualizacja danych i model drzewkowy (random forest).
          </p>

          <div style="height: 40px;"></div>

          <div class="container">
            <div class="row justify-content-md-center">
              <div class="col col-lg-4">
                <div class="accordion" id="accordionPanelsStayOpenExample" style="width: 450px;">
                  <div class="accordion-item">
                    <h2 class="accordion-header" style="margin: auto;">
                      <button class="accordion-button" type="button" data-bs-toggle="collapse" 
                      data-bs-target="#panelsStayOpen-collapseTwelve" aria-expanded="true" aria-controls="panelsStayOpen-collapseTwelve">
                      MÃ³j email â†´
                      </button>
                    </h2>
                    <div id="panelsStayOpen-collapseTwelve" class="accordion-collapse collapse" style="margin-top: 20px; margin-bottom: 20px">
                      <div class="accordion-body" >
    <!-- The text field -->
    
                        <div style="margin: auto">
                          <div class="row g-3 align-items-center">

                            <div class="col-auto" style="margin: 0px">
                              <input type="text" 
                                      id="myInput" 
                                      class="form-control form-control-sm" 
                                      value="konrad.jarominiak0@gmail.com" disabled
                                     style="width: 250px">
                            </div>
                            <div class="col-auto" style="margin: auto; padding:auto">
                              <button type="button" class="btn btn-outline-secondary btn-sm" onclick="myFunction()">skopiuj do schowka</button>
                            </div>
                          </div>
                        </div>
    
    
    
    
    <!-- The button used to copy the text -->
    
    
    <!-- The toast -->
                          <div aria-live="polite" aria-atomic="true" style="position: relative; min-height: 0px;">
                            <div class="toast" style="position: absolute; top: 0px; right: 0; width:250px">
                              <div class="toast-body">
                                Skopiowano do schowka!
                              </div>
                            </div>
                          </div>
                          
                      </div>
                    </div>
                  </div>
      
                </div>   
              </div>

              <div class="col col-lg-4">
                

                <div style="width: 450px; padding-top: 15px; padding-bottom: 15px;">
                  <a
                  href="index.html"
                  class="btn btn-secondary my-2"
                  >PowrÃ³t</a>
                </div>

              </div>
            </div>
          </div>


          <div class="true_center">
            <div class="row" style="margin:margin-top: 40px; width: 100%">
              <div class="col col-sm">
             </div>
              <div class="col col-sm">

              </div>
            </div>
          </div>





          

        </div>
    </section>

    <span class="border border-0">

    <div style="height: 30px;"></div>

    <div class="container">
      <div class="row">
        <div class="col-md-9"> <!--TU ZWIJAÄ†-->

          <div class="tresc wstep">
            <h4 id="wstep-header">1. WstÄ™p</h4>
            PomysÅ‚ na ten projekt zrodziÅ‚ siÄ™ z przemyÅ›leÅ„ nad zatrzÄ™sieniem niezaprzeczalnie fatalnych, tanich filmÃ³w na serwisach VOD, 
            ktÃ³rych jedynym celem jest <a href="https://www.giantfreakinrobot.com/ent/watchbait-new-clickbait.html">przyciÄ…gniÄ™cie</a> 
            widza swoim tytuÅ‚em nawiÄ…zujÄ…cym do starych, sÅ‚ynnych filmÃ³w. 
            Na przykÅ‚ad multum filmÃ³w o rekinach udajÄ…cych sequele "SzczÄ™k" Spielberg'a.
            <br> <br>  
            Czy moÅ¼na przewidzieÄ‡ powodzenie takiego filmu na podstawie jego tytuÅ‚u? 
            Ten projekt jest nieporadnÄ… prÃ³bÄ… utworzenia modelu, ktÃ³ry przewiduje oceny horrorÃ³w i ich podrÃ³bek na podstawie ich tytuÅ‚Ã³w.
            <br><br>
            Projekt opiera siÄ™ na zestawie danych z <a href="https://www.kaggle.com/datasets/rounakbanik/the-movies-dataset?select=movies_metadata.csv">Kaggle</a>,
            ktÃ³ry, wedÅ‚ug opisu, jest poÅ‚Ä…czeniem danych z <a href="https://www.kaggle.com/datasets/rounakbanik/the-movies-dataset?select=movies_metadata.csv">TMDB</a> i 
            <a href="https://grouplens.org/datasets/movielens/">MovieLens</a>.
            <br>
            Do wykonania niniejszego projektu wykorzystano biblioteki:
            <div style="height: 3px;"></div>

            <ul>
            <li>Pandas i Numpy do przetworzenia i oczyszczenia danych</li>
            <li>Matplotlib i Seaborn do wizualizacji danych</li>
            <li>sci-kit learn do stworzenia modeli</li>
            </ul>

          </div>

          <div class="tresc analiza_zestawu_danych">
            <h4 id="analiza_zestawu_danych-header">2. Analiza zestawu danych</h4>

            W tabeli znajdujÄ… siÄ™ aÅ¼ 24 kolumny dotyczÄ…ce danych poszczegÃ³lnych filmÃ³w, np. tytuÅ‚, tagline, popularnoÅ›Ä‡, przychÃ³d, opis, etc.
            Na potrzeby modelu, kolumny ktÃ³re byÅ‚yby przydatne to:

            <ul>
            <li>tytuÅ‚</li> 
            <li>gatunek</li>
            <li>budÅ¼et</li>
            <li>przychÃ³d</li>
            <li>ocena</li>
            </ul>

            W pierwszej kolejnoÅ›ci spisano listÄ™ czÅ‚onÃ³w tytuÅ‚Ã³w. CzeÅ›Ä‡ z nich moÅ¼e wyglÄ…daÄ‡ doÅ›Ä‡ dziwnie, np. 'Dea'.
            Taki czÅ‚on ma wyÅ‚apaÄ‡ tytuÅ‚y zawierajÄ…ce zarÃ³wno 'Death' jak i 'Dead' i zostaÄ‡ poÅ‚Ä…czone w tytuÅ‚ jak np.
            'shark' w <a href="https://www.imdb.com/title/tt2724064/">Sharknado</a>. 
            <br><br>
            Lista czÅ‚onÃ³w przedstawia siÄ™ nastÄ™pujÄ…co:
            <pre><code>
['Evil', 'Final', 'Night', 'Kill', 'Scar', 'Scream', 'Land', 'Nado', 'Wolf', 'Dea', 
'Moon', 'Chainsaw', 'American', 'Witch', 'Cannibal', 'Monster', 'Child', 'Haunt', 
'Fear', 'Clown', 'Curs', 'Blac', 'Devil', '3D', 'Asylum', 'Conjur', 'Ouija', 'Shark', 
'Ville', 'Town', 'Texas', 'Mummy', 'Corn', 'Exorc', 'Psycho', 'Dino', 'Virus', 'House', 
'Vengeance', 'Blood', 'Nurse', 'Demon', 'Zombie', 'Cula', 'Stein', 'Geist']
            </code></pre>


            <br>
            NastÄ™pnie utworzono funkcjÄ™ agregujÄ…cÄ… tytuÅ‚y do sprawdzenia iloÅ›ci filmÃ³w z danymi czÅ‚onami.

            <pre><code>
shape_amount = {}

def check_amount(part_to_check):

    # czÄ™Å›Ä‡ weryfikujÄ…ca
    print(f'Title part: "{part_to_check}"')
    print(f'Amount: {df[df["original_title"].str.contains(part_to_check, case=False)].shape[0]}')
    print(f'Avg score: {df[df["original_title"].str.contains(part_to_check, case=False)]["vote_average"].mean().round(2)}')

    # czÄ™Å›Ä‡ agregujÄ…ca
    shape_amount[part_to_check] = df[df["original_title"].str.contains(part_to_check, case=False)].shape[0]
    

check_amount(random.sample(title_parts, 1)[0]) # sprawdzamy losowy czÅ‚on

# out:
Title part: "Moon"
Amount: 16
Avg score: 4.25
            </code></pre>

            Na podstawie danych zagregowanych do sÅ‚ownika utworzono dataframe i wykres kolumnowy z iloÅ›ciÄ… tytuÅ‚Ã³w zawierajÄ…cÄ… dany czÅ‚on. 
            <br> Wykres ten zawiera 1425 czÅ‚onÃ³w, z czego 208 to duplikaty, co oznacza, 
            Å¼e 17% tytuÅ‚Ã³w jest przynajmniej dwuczÅ‚onowa.

            <div class="accordion" id="accordionPanelsStayOpenExample">
              <div class="accordion-item">
                <h2 class="accordion-header">
                  <button class="accordion-button" type="button" data-bs-toggle="collapse" 
                  data-bs-target="#panelsStayOpen-collapseNine" aria-expanded="true" aria-controls="panelsStayOpen-collapseNine", style="padding: auto;">
                    <img src="css\p3_images\title parts amount.png" style="max-width: 100%; margin: auto;">                
                  </button> 
                </h2>
                <div id="panelsStayOpen-collapseNine" class="accordion-collapse collapse">
                  <div class="accordion-body">
  <pre><code>
sf = pd.DataFrame.from_dict(shape_amount, orient='index', columns=['amount'])
sf = sf.sort_values('amount', ascending=False)

fig, ax = plt.subplots(figsize=(9,6))
plt.xticks(rotation=90)
chart = sns.barplot(data=sf, x=sf.index, y='amount', palette='plasma')
chart.set_title('RozkÅ‚ad czÄ™Å›ci tytuÅ‚Ã³w')
chart.set(xlabel='CzÄ™Å›Ä‡ tytuÅ‚u', ylabel='IloÅ›Ä‡')
  </code></pre>                </div>
                </div>
              </div>
            </div>

            <br>
            Kolejno przefiltrowano zestaw danych tak, aby pozostaÅ‚y tylko te horrory, ktÃ³re zawierajÄ… przynajmniej jeden czÅ‚on z naszej listy.
            Sprawdzono rÃ³wnieÅ¼ jaka iloÅ›Ä‡ filmÃ³w zawiera dane dotyczÄ…ce budÅ¼etu i przychodu. 
            Niestety znaczna wiÄ™kszoÅ›Ä‡ z nich nie ma tych wartoÅ›ci sprecyzowanych i ostatecznie kolumny 'budget' i 'revenue' zostaÅ‚y usuniÄ™te przed modelowaniem.
            Tak duÅ¼e iloÅ›ci brakujÄ…cych danych bardzo negatywnie wpÅ‚ynÄ™Å‚y by na jakoÅ›Ä‡ modelu. 
            <br> <br>



            <pre><code> <!-- Kod dla pokoleÅ„ i dystansu -->
watchbait_df = pd.DataFrame()

for i in title_parts:
    current_part = df[df["original_title"].str.contains(i, case=False)]
    print(f'"{i}" in titles: {current_part.shape[0]}; Average score: {current_part["vote_average"].mean().round(1)}')
    watchbait_df = pd.concat([watchbait_df, current_part], ignore_index=True)

# out:
"Zombie" in titles: 47; Average score: 4.5

print(f'Budget over 0: {watchbait_df[watchbait_df["budget"] > 0].shape[0]}')
print(f'Revenue over 0: {watchbait_df[watchbait_df["revenue"] > 0].shape[0]}')
print(f'Total amount of titles: {watchbait_df.shape[0]}')

# out:
Budget over 0: 419
Revenue over 0: 251
Total amount of titles: 1425
            </code></pre>

            UsuniÄ™to rÃ³wnieÅ¼ filmy z iloÅ›ciÄ… ocen 0, 1 i 2. 
            Filmy z iloÅ›ciÄ… ocen rÃ³wnÄ… 3 miaÅ‚y wystarczajÄ…co sensowne wyniki tzn. oceny byÅ‚y niewiÄ™ksze niÅ¼ 7. 
            Gdyby koÅ„cowy rozmiar zestawu danych nie byÅ‚ maÅ‚y (115 tytuÅ‚Ã³w), odciÄ™cie po iloÅ›ci ocen oczywiÅ›cie by zwiÄ™kszono.
            Kolejno przeprowadzono nastÄ™pujÄ…ce operacje:

            <li>UsuniÄ™to duplikaty</li>
            <li>Ograniczono tabelÄ™ do tytuÅ‚u, oceny i iloÅ›ci ocen</li>
            <li>Przeprowadzon one-hot encoding czÅ‚onÃ³w tytuÅ‚Ã³w</li>
            <li>Utworzono uproszczonÄ… kolumnÄ™ ocen - 'Rating' z trzema moÅ¼liwymi stopniami: 'Good', 'Decent', 'Awful'. Te wartoÅ›ci bÄ™dzie przewidywaÅ‚ model. 
              PrzedziaÅ‚y wyznaczono na podstawie koÅ„cowego histogramu ocen, zamieszczonego poniÅ¼ej.</li>
            <li>Ograniczono tytuÅ‚y tylko do tych, ktÃ³re majÄ… przynajmniej dwuczÅ‚onowe tytuÅ‚y - tu iloÅ›Ä‡ filmÃ³w spadÅ‚a do 115. </li>
            <br>
            <div class="accordion" id="accordionPanelsStayOpenExample">
              <div class="accordion-item">
                <h2 class="accordion-header">
                  <button class="accordion-button" type="button" data-bs-toggle="collapse" 
                  data-bs-target="#panelsStayOpen-collapseCode" aria-expanded="true" aria-controls="panelsStayOpen-collapseCode">
  Kod dla procedur powyÅ¼ej
                  </button>
                </h2>
                <div id="panelsStayOpen-collapseCode" class="accordion-collapse collapse">
                  <div class="accordion-body">
                    <pre><code>
# usuniÄ™cie duplikatÃ³w
print(f'Before duplicate removal: {df.shape[0]}')
df = df.drop_duplicates()
print(f'After duplicate removal: {df.shape[0]}\n')

# out:
Before duplicate removal: 1425
After duplicate removal: 1218


# ograniczenie df do istotnych kolumn
df = df[['title', 'vote_average', 'vote_count']]


# one-hot encoding czÅ‚onÃ³w
def get_part(title, part):
    if part.lower() in title.lower():
        return 1
    else:
        return 0

for title_part in title_parts:
    df[title_part] = df['title'].apply(lambda x: get_part(x, title_part))


# uproszczona ocena
def uniform_score(vote):
    if vote >= 7:
        return 'Great'
    elif vote >= 5 and vote < 7:
        return 'Decent'
    elif vote >=3 and vote < 5:
        return 'Bad'
    elif vote < 3:
        return 'Awful'

df['Rating'] = df["vote_average"].apply(lambda x: uniform_score(x))


# uciÄ™cie do min. dwuczÅ‚onowych filmÃ³w, to pÃ³jdzie do modelowania
df_cut = df[df["Title parts"] > 1]
                                  </code></pre>
                  </div>
                </div>
              </div>
  
            </div>
<br>
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                  data-bs-target="#panelsStayOpen-collapseThree" aria-expanded="false"
                  aria-controls="panelsStayOpen-collapseThree">
                  <img src="css\p3_images\histogram ocen.png" class="acc-image" alt="">
                </button>
              </h2>
              <div id="panelsStayOpen-collapseThree" class="accordion-collapse collapse">
                <div class="accordion-body">
                  <pre><code class="language-python">
scores = df.iloc[:, 7:21]
scores['satisfaction_v2'] = df['satisfaction_v2']

scores_melted = pd.melt(scores, id_vars=['satisfaction_v2'], var_name='score')
scores_melted['score'] = scores_melted['score'].map(service_dict)

plt.figure(figsize=(8,4))
plt.xticks(rotation=-90)
ax = sns.barplot(x='score', 
            y='value', 
            order=scores_melted.groupby('score').mean().sort_values('value').reindex().index.tolist(),
            hue='satisfaction_v2',
            data=scores_melted,
            palette={
                'satisfied':'#325288',
                'neutral or dissatisfied':'#FF5959'
            },
            errorbar=None)

plt.legend(loc='lower left',
           framealpha=0.9,
           title='Klienci:',
           labels=['Usatysfakcjonowani', 'Nieusatysfakcjonowani lub\nneutralni'])

ax.set(ylabel='Ocena', xlabel='',)
ax.set_title('Ocena usÅ‚ug w zaleÅ¼noÅ›ci od ogÃ³lnej satysfakcji', fontdict={'size': 11})

for patch in ax.patches:
    patch.set_edgecolor('black')
                        patch.set_linewidth(0.6)
                  </code></pre>
                </div>
              </div>
            </div>

          </div>
            <div class="tresc analiza_zestawu_danych">
              <h4 id="wizualizacja-header">3. Sprawdzenie korelacji</h4>


              

              <br>
              Przed rozpoczÄ™ciem modelowania sprawdzono, 
              czy w zestawie danych istnieje zaleÅ¼noÅ›Ä‡ miÄ™dzy samymi czÅ‚onami tytuÅ‚Ã³w a ocenÄ… filmÃ³w.
              Dokonano tego zestawiajÄ…c korelacjÄ™ czÅ‚onÃ³w do oceny (sÅ‚upki) wraz samÄ… Å›redniÄ… ocenÄ… dla danego czÅ‚onu (linia).
              
              <br>
              
          <div class="accordion" id="accordionPanelsStayOpenExample">
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button" type="button" data-bs-toggle="collapse" 
                data-bs-target="#panelsStayOpen-collapseFivee" aria-expanded="true" aria-controls="panelsStayOpen-collapseFivee">
<img src="css\p3_images\titlepart and corr.png" style="width: 100%;" alt="">
                </button>
              </h2>
              <div id="panelsStayOpen-collapseFivee" class="accordion-collapse collapse">
                <div class="accordion-body">
                  <pre><code class="language-python">
# kolumna czÅ‚onu do oceny
corr_matrix = df_cut.corr()['vote_average'][1:]

# dodanie kolumny ocen do df, do naniesienia na wykresie jako liniÄ™
dfc_cut = pd.concat([corr_matrix, pd.Series(avg_title_dict)], axis=1)
dfc_cut.columns = ['correlation', 'vote_average']

# poprawka i usuniÄ™cie czÅ‚onÃ³w bez korelacji
dfc_cut = dfc_cut.reset_index()
dfc_cut.columns = ['title', 'correlation', 'vote_average']
dfc_cut.dropna(inplace=True)

# wykres
fig, ax = plt.subplots(figsize=(10,7))
plt.xticks(rotation=90)
plt.rcParams['font.size'] = 8

# naniesienie korelacji jako sÅ‚upki z sortowaniem po korelacji
ax = sns.barplot(data=dfc_cut.sort_values(by='correlation'), x='title', y='correlation', palette='magma')
ax.set_ylim(-0.35, 0.35)
ax.set_ylabel('Korelacja (sÅ‚upki)', fontdict={'fontsize':9})

# naniesienie ocen jako linii z sortowaniem po korelacji
ax2 = ax.twinx()
sns.lineplot(data=dfc_cut.sort_values(by='correlation'), x='title', y='vote_average', ax=ax2, marker='.', color='royalblue')
ax2.set_ylabel('Vote Average', fontdict={'fontsize':10})
ax2.set_ylabel('Åšrednia ocena (linia)')

# formatowanie
ax.set_xlabel('CzÅ‚on tytuÅ‚u', fontdict={'fontsize':'10'})
plt.title('Korelacja i Å›rednia ocena czÅ‚onÃ³w tytuÅ‚Ã³w', fontdict={'fontsize':11})
                    </code></pre>
                </div>
              </div>
            </div>
          </div>
          <li class="opis_wiz">
            Korelacje sÄ… niskie, czego moÅ¼na siÄ™ byÅ‚o spodziewaÄ‡. Na szczÄ™Å›cie celem tego modelu jest dowcip, nie trafnoÅ›Ä‡ czy sÅ‚usznoÅ›Ä‡.
          </li>

          <li class="opis_wiz">
            W niektÃ³rych czÅ‚onach wystÄ™puje dziwny stosunek korelacji do oceny, 
            w szczegÃ³lnoÅ›ci "Shark" - czÅ‚on ten ma najniÅ¼szÄ… Å›redniÄ… ocenÄ™ filmÃ³w, jednak jego korelacja jest bliska 0.
            ByÄ‡ moÅ¼e wynika to z wystÄ™powania innych czÅ‚onÃ³w wraz z czÅ‚onem "Shark".

          </li>
          <li class="opis_wiz">
            Najgorszym czÅ‚onem okazaÅ‚o siÄ™ "Zombie", co ma sens, ze wzglÄ™du na czÄ™stoÅ›Ä‡ tego czÅ‚onu, ogÃ³lnÄ… sztampowoÅ›Ä‡ filmÃ³w o zombie i ich niskÄ… ocenÄ™. 
            Tu znÃ³w pojawia siÄ™ problem braku rÃ³wnowagi w iloÅ›ci poszczegÃ³lnych atrybutÃ³w i wpÅ‚ywu na korelacjÄ™, jak w przypadku pokoleÅ„ w projekcie ocen usÅ‚ug lotniczych.
            Aby wartoÅ›ci korelacji najlepiej oddawaÅ‚y te zaleÅ¼noÅ›ci, istotne jest aby dane atrybuty byÅ‚y w miarÄ™ rÃ³wno reprezentowane.
          </li>

          <br>

          <div class="accordion" id="accordionPanelsStayOpenExample">
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button" type="button" data-bs-toggle="collapse" 
                data-bs-target="#panelsStayOpen-collapseSeven" aria-expanded="true" aria-controls="panelsStayOpen-collapseSeven">
<img src="css\p2_images\Histogram odlegÅ‚oÅ›ci.png" style="max-width:100%; max-height: 100%; margin: auto;" alt="">                </button>
              </h2>
              <div id="panelsStayOpen-collapseSeven" class="accordion-collapse collapse">
                <div class="accordion-body">

                  <pre><code>
plt.figure(figsize=(8,4))
ax = sns.histplot(data=df['Flight Distance'], binwidth=200, color='#D80032')

ax.set_title('Histogram odlegÅ‚oÅ›ci', fontdict={'fontsize':11})
ax.set_xlabel('OdlegÅ‚oÅ›Ä‡ [mi]')
ax.set_ylabel('CzÄ™stoÅ›Ä‡')
                  </code></pre>

                </div>
              </div>
            </div>
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" 
                data-bs-target="#panelsStayOpen-collapseEight" aria-expanded="false" aria-controls="panelsStayOpen-collapseEight">
<img src="css\p2_images\Histogram opÃ³ÅºnieÅ„.png" style="width:100%" alt="">
                </button>
              </h2>
              <div id="panelsStayOpen-collapseEight" class="accordion-collapse collapse">
                <div class="accordion-body">

                  <pre><code>
# kod tylko dla prawego wykresu
plt.figure(figsize=(4,4))
ax = sns.histplot(data=df['Arrival Delay in Minutes'], bins=30, color='#F78CA2')
ax.set_title('Histogram opÃ³ÅºnieÅ„', fontdict={'fontsize':11})
ax.set_xlabel('OpÃ³Åºnienie przylotu [min]')
ax.set_ylabel('CzÄ™stoÅ›Ä‡')
                  </code></pre>

                </div>
              </div>
            </div>
          </div>
          <li class="opis_wiz">
            WyraÅºny spadek w iloÅ›ci odlegÅ‚oÅ›ci powyÅ¼ej 4000 mil przyjÄ™to za granicÄ™ 
            miÄ™dzy krÃ³tkim/dÅ‚ugim lotem przy tworzeniu kolumny 'simple distance' majÄ…cej uproÅ›ciÄ‡ i polepszyÄ‡ wydajnoÅ›Ä‡ przewidujÄ…cego modelu.
          </li>
          <li class="opis_wiz">
            OpÃ³Åºnienia w odlocie i przylocie sÄ… bardzo podobne, jednak nie sÄ… identyczne. Niemniej, jednÄ… z tych kolumn usuniÄ™to rÃ³wnieÅ¼ w celu usprawnienia modelu.
          </li>
<br>
          
          <div class="accordion" id="accordionPanelsStayOpenExample"> 
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button" type="button" data-bs-toggle="collapse"
                  data-bs-target="#panelsStayOpen-collapseOne" aria-expanded="true" aria-controls="panelsStayOpen-collapseOne">
                  <img src="css\p2_images\UsÅ‚ugi a pÅ‚eÄ‡.png" class="acc-image" alt="">
                </button>
              </h2>
              <div id="panelsStayOpen-collapseOne" class="accordion-collapse collapse">
                <div class="accordion-body">
                  <pre><code class="language-python">
scores = df.iloc[:, 7:21]
scores['Gender'] = df['Gender']

scores_melted = pd.melt(scores, id_vars=['Gender'], var_name='score')
scores_melted['score'] = scores_melted['score'].map(service_dict)


plt.figure(figsize=(8,4))
plt.xticks(rotation=-90)
ax = sns.barplot(x='score', 
            y='value', 
            order=scores_melted.groupby('score').mean().sort_values('value').reindex().index.tolist(),
            hue='Gender',
            data=scores_melted,
            palette={
                'Female':'#00ffbf',
                'Male' : '#ffbb33'
            },
            errorbar=None)

plt.legend(loc='lower left', labels=['Kobiety', 'MÄ™Å¼czyÅºni'])

ax.set(ylabel='Ocena', xlabel='',)
ax.set_title('Ocena usÅ‚ug w zaleÅ¼noÅ›ci od pÅ‚ci', fontdict={'size': 11})

for patch in ax.patches:
    patch.set_edgecolor('black')
    patch.set_linewidth(0.6)
                                                </code></pre>
                </div>
              </div>
            </div>
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                  data-bs-target="#panelsStayOpen-collapseTwo" aria-expanded="false" aria-controls="panelsStayOpen-collapseTwo">
                  <img src="css\p2_images\UsÅ‚ugi a pokolenia.png" class="acc-image" alt="">
                </button>
              </h2>
              <div id="panelsStayOpen-collapseTwo" class="accordion-collapse collapse">
                <div class="accordion-body">
                  <pre><code class="language-python">
scores = df.iloc[:, 7:21]
scores['Generation'] = df['Generation']

scores_melted = pd.melt(scores, id_vars=['Generation'], var_name='score')
scores_melted['score'] = scores_melted['score'].map(service_dict)

hue_order = ['Silent Generation', 'Boomer', 'GenX', 'Millenial', 'Zoomer']

plt.figure(figsize=(8,4))
plt.xticks(rotation=-90)
ax = sns.barplot(x='score', 
y='value', 
order=scores_melted.groupby('score').mean().sort_values('value').reindex().index.tolist(),
hue='Generation',
hue_order=hue_order,
data=scores_melted,
palette='rocket',
errorbar=None)

plt.legend(loc='lower left', )

ax.set(ylabel='Ocena', xlabel='',)
ax.set_title('Ocena usÅ‚ug w zaleÅ¼noÅ›ci od pokolenia', fontdict={'size': 11})

for patch in ax.patches:
patch.set_edgecolor('#191717')
patch.set_linewidth(0.4)
                                                </code></pre>
                </div>
              </div>
            </div>

            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                  data-bs-target="#panelsStayOpen-collapseThree" aria-expanded="false"
                  aria-controls="panelsStayOpen-collapseThree">
                  <img src="css\p2_images\UsÅ‚ugi a lojalnoÅ›Ä‡.png" class="acc-image" alt="">
                </button>
              </h2>
              <div id="panelsStayOpen-collapseThree" class="accordion-collapse collapse">
                <div class="accordion-body">
                  <pre><code class="language-python">
scores = df.iloc[:, 7:21]
scores['Customer Type'] = df['Customer Type']

scores_melted = pd.melt(scores, id_vars=['Customer Type'], var_name='score')
scores_melted['score'] = scores_melted['score'].map(service_dict)

plt.figure(figsize=(8,4))
plt.xticks(rotation=-90)
ax = sns.barplot(x='score', 
            y='value', 
            order=scores_melted.groupby('score').mean().sort_values('value').reindex().index.tolist(),
            hue='Customer Type',
            data=scores_melted,
            palette={
                'Loyal Customer':'#B85C38',
                'disloyal Customer':'#2D2424'
            },
            errorbar=None)

plt.legend(loc='lower left',
           framealpha=0.9,
           title='Klienci:',
           labels=['Lojalni', 'Nielojalni'])

ax.set(ylabel='Ocena', xlabel='',)
ax.set_title('Ocena usÅ‚ug w zaleÅ¼noÅ›ci od lojalnoÅ›ci', fontdict={'size': 11})

for patch in ax.patches:
    patch.set_edgecolor('#080202')
    patch.set_linewidth(0.6)
                  </code></pre>
                </div>
              </div>
            </div>
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                  data-bs-target="#panelsStayOpen-collapseFour" aria-expanded="false"
                  aria-controls="panelsStayOpen-collapseFour">
                  <img src="css\p2_images\UsÅ‚ugi a klasa.png" class="acc-image" alt="">
                </button>
              </h2>
              <div id="panelsStayOpen-collapseFour" class="accordion-collapse collapse">
                <div class="accordion-body">
                  <pre><code class="language-python">
scores = df.iloc[:, 7:21]
scores['Class'] = df['Class']

scores_melted = pd.melt(scores, id_vars=['Class'], var_name='score')
scores_melted['score'] = scores_melted['score'].map(service_dict)

hue_order = ['Eco', 'Eco Plus', 'Business']

plt.figure(figsize=(8,4))
plt.xticks(rotation=-90)
ax = sns.barplot(x='score', 
            y='value', 
            order=scores_melted.groupby('score').mean().sort_values('value').reindex().index.tolist(),
            hue='Class',
            hue_order=hue_order,
            data=scores_melted,
            palette='mako_r',
            errorbar=None)

plt.legend(loc='lower left',
           framealpha=0.9,
           title='Klasa:',)

ax.set(ylabel='Ocena', xlabel='',)
ax.set_title('Ocena usÅ‚ug w zaleÅ¼noÅ›ci od klasy', fontdict={'size': 11})

for patch in ax.patches:
    patch.set_edgecolor('#080202')
    patch.set_linewidth(0.6)
                  </code></pre>
                </div>
              </div>
            </div>

            <div class="opis_wiz"></div>
            <li>
              Jedyna usÅ‚uga wyÅ¼ej oceniona przez mÄ™Å¼czyzn niÅ¼ przez kobiety to dogodnoÅ›Ä‡ czasowa wylotu / odlotu. 
              TÄ… usÅ‚ugÄ™ najwyÅ¼ej ocenili klienci z pokolenia Z, ktÃ³rzy ogÃ³lnie doÅ›Ä‡ nisko oceniali wiÄ™kszoÅ›Ä‡ usÅ‚ug.
              RozkÅ‚ad ocen miÄ™dzy pokoleniami i pÅ‚ciami nie jest aÅ¼ tak znaczÄ…cy. WiÄ™ksze rÃ³Å¼nice widoczne sÄ… w kolejnych kategoriach.
            </li>
            <li>
              ZaleÅ¼noÅ›Ä‡ ocen w kontekÅ›cie ogÃ³lnej satysfakcji jest doÅ›Ä‡ logiczna, usatysfakcjonowani klienci w wiÄ™kszoÅ›ci dawali duÅ¼o wyÅºsze oceny.
              Co ciekawe lokalizacja bramek i dogodnoÅ›Ä‡ czasowa wylotu / odlotu zostaÅ‚a wyÅ¼ej oceniona przez nieusatysfakcjonowanych i neutralnych klientÃ³w.
              Najgorzej ocenieone przez nich usÅ‚ugi to wygoda siedzeÅ„ (jak wiÄ™kszoÅ›Ä‡ klientÃ³w) i jakoÅ›Ä‡ rozrywki, 
              ktÃ³ra z kolei zostaÅ‚a najwyÅ¼ej oceniana przez usatsfakcjonowanych klientÃ³w.
            </li>
            <li>
              Znaczenie jakoÅ›ci rozrywki rÃ³wnieÅ¼ zdaje siÄ™ byÄ‡ najistotniejsze pod wzglÄ™dem lojalnoÅ›ci klientÃ³w. 
              Nielojalni klienci najgorzej ocenili rozrwykÄ™, widoczna teÅ¼ jest tu najwiÄ™ksza rÃ³Å¼nica ocen miÄ™dzy klientami lojalnymi a nielojalnymi.
            </li>
            <li>
              OkazaÅ‚o siÄ™ teÅ¼ Å¼e, klienci z klasÄ… biznesowÄ… sÄ… bardziej zadowoleni z zapewnionych usÅ‚ug. 
              Warto zaznaczyÄ‡, Å¼e ci klienci ocenili lokalizacjÄ™ i dogodnoÅ›Ä‡ czasowÄ… odlotu i przylotu niÅ¼ej niÅ¼ pozostali klienci. 
              DogodnoÅ›Ä‡ czasowa powinna byÄ‡ niezaleÅ¼ne od klasy, czyli jest to coÅ› czego pieniÄ…dze nie kupiÄ… i najwyraÅºniej zwiÄ…zane z tym niedogodnienia bolÄ… bardziej. 

              Jest to rÃ³wnieÅ¼ widoczne w porÃ³wnaniu typu podrÃ³Å¼y (nieprzedstawiona na wykresach), 
              gdzie klienci podrÃ³Å¼ujÄ…cy osobiÅ›cie ocenili tÄ™ 'usÅ‚ugÄ™' Å›rednio o ponad 0,5 punkta wyÅ¼ej niÅ¼ podrÃ³Å¼ujÄ…cy biznesowo.

              OczywiÅ›cie, wygoda siedzeÅ„ rÃ³wnieÅ¼ zostaÅ‚a najniÅ¼ej oceniona przez klientÃ³w z klasy biznesowej. 
            </li>
          </div>

<br>




          <br>
          <div class="wiz_uwagi">
            <h6 id="uwagi-header">Uwagi dotyczÄ…ce korelacji</h6>
            <li>
              Na podstawie wykresu korelacji moÅ¼na wywnioskowaÄ‡, Å¼e jakoÅ›Ä‡ rozrywki jest najbardziej istotnym czynnikiem wpÅ‚ywajÄ…cym na dyssatysfakcjÄ™ klienta, 
              a pozostaÅ‚e usÅ‚ugi nie majÄ… aÅ¼ tak duÅ¼ego znaczenia.

            </li>
            <li>
              Z kolei w przypadku usatsfakcjonowanych klientÃ³w, wiÄ™kszoÅ›Ä‡ ocen wysoko ze sobÄ… koreluje. MoÅ¼na wnioskowaÄ‡, Å¼e jeÅ›li klient jest zadowolony, oceni on wysoko kaÅ¼dÄ… z nich, 
              w przeciwieÅ„stwie do klientÃ³w nieusatysfakcjonowanych, ktÃ³rzy np. nisko oceniÄ… tylko jednÄ… usÅ‚ugÄ™, a resztÄ™ bardziej neutralnie (moÅ¼e to lepiej napisaÄ‡.).
            </li>
            <li>
              SpoÅ›rÃ³d usÅ‚ug, dogodnoÅ›Ä‡ czasowa odlotu / przylotu i lokalizacja bramek ma maÅ‚e znaczenie dla nieusatysfakcjonowanych klientÃ³w. 
              SÄ… to dwie usÅ‚ugi wyÅ¼ej przez nich oceniane niÅ¼ klienci usatysfakcjonowani.
            </li>
            <li>
              Dystans lotu ma zerowe korelacje z ocenÄ… usÅ‚ug, poza, co prawda doÅ›Ä‡ niskim, wynikiem korelacji -0,1 dla wygody siedzeÅ„. 
              OsobiÅ›cie spodziewaÅ‚em siÄ™, Å¼e bÄ™dzie on nieco bardziej znaczÄ…cy, niemniej to logiczne, Å¼e wraz z dÅ‚uÅ¼szym lotem, niewygodne siedzenie daje siÄ™ we znaki.
            </li>
            <li>
              ZauwaÅ¼alna jest pewna anomalia przy korelacji wieku z pokoleniam -  
              najwyÅ¼sza korelacja wieku zaznacza siÄ™ dla pokolenia Baby Boomers, a nie starszej Silent Generation. 
              MoÅ¼na to wytÅ‚umaczyÄ‡ znacznie niÅ¼szÄ… iloÅ›ciÄ… klientÃ³w z Silent Generation - niezbyt normalnÄ… dystrybucjÄ… wieku.
              Anomalia ta teÅ¼ podkreÅ›la problematykÄ™ one hot encoding-u, czyli tworzeniem nowych kolumn wartoÅ›ciami 0-1 reprezentujÄ…cymi obecnoÅ›Ä‡ pojedynczego atrybutu. 
            </li>
          </div>
          
          </div>

          <div class="tresc modelowanie">
            <h4 id="modelowanie-header">Modelowanie</h4>
            Do modelowania wykorzystano tzw. las losowy (ang. random forest), czyli Å›wietnÄ… metodÄ™ klasyfikacyjnÄ…. 
            Metoda lasu losowego opiera siÄ™ na wykorzystywaniu wielu drzewek decyzyjnych, 
            gdzie kaÅ¼dy z nich otrzymuje inny, losowo wybrany podzbiÃ³r danych uczÄ…cych.
            <br><br>
            <h6>DziaÅ‚anie drzewek decyzyjnych</h6>
            


            Regresja logistyczna polega na funkcji sigmoidalnej, wykorzystujÄ…cej regresjÄ™ liniowÄ…, w taki sposÃ³b, Å¼e wartoÅ›ci mieszczÄ… siÄ™ w zakresie od 0 do 1.
            WartoÅ›ci te zwykle dzieli siÄ™ na te powyÅ¼ej i poniÅ¼ej wartoÅ›ci 0,5 (prÃ³g ten moÅ¼na zmieniÄ‡), klasyfikujÄ…c je do odpowiedniej kategorii. 
            
            Regresja liniowa polega na znalezieniu zaleÅ¼noÅ›ci miÄ™dzy wartoÅ›ciÄ… przewidywanÄ… (zmienna objaÅ›niana)
            a predyktorami (zmienne objaÅ›niajÄ…ce) poprzez dopasowanie wag predyktorÃ³w. 
            RÃ³wnania regresji logistycznej i liniowej przedstawia siÄ™ nastÄ™pujÄ…co: 

            $$y = Î²_0 + Î²_1 x_1 + Î²_2 x_2 + \dots + Î²_n x_n + \epsilon$$

            gdzie: 
            <li>\(y\) to zmienna objaÅ›niana, zaleÅ¼na, to co model przewiduje</li>
            <li>\(x_i\) to zmienna objaÅ›niajÄ…ca, niezaleÅ¼na, inaczej predyktor</li>
            <li>\(Î²_i\) to wspÃ³Å‚czynnik regresji, element ktÃ³ry dobiera model podczas trenowania </li>
            <li>\(\epsilon\) to nieskracalny bÅ‚Ä…d modelu</li>
            
            $$P = \frac{1}{1+e^{-z}}$$
            gdzie: 
            <li>\(P\) to prawdopodobieÅ„stwo, w przedziale 0-1, im bliÅ¼ej progu odciÄ™cia (tu 0,5) tym mniej pewna klasyfikacja</li>
            <li>\(e\) to liczba Eulera (~2,71828)</li>
            <li>\(z\) to zmienna objaÅ›niajÄ…ca, niezaleÅ¼na, tutaj \(y\), rÃ³wnanie regresji liniowej</li>
 
            <br>
            <img src="css\p2_images\logreg.png" style="width: 98%; max-height: 400px; margin: auto; object-fit: contain; padding: 15px;" alt="">
            <br><br>

            <br>
            Przed modelowaniem usuniÄ™to kolumnÄ™ Arrival Delay in Minutes, 
            poniewaÅ¼ niemal caÅ‚kowicie pokrywa siÄ™ z Departure Delay in Minutes, wszystkie kolumny wykorzystane do one hot encoding-u, 
            np. 'satisfaction_v2' i zostawiajÄ…c tylko 'satisifed' z wartoÅ›ciami 0 albo 1 oraz score_avg.
            Ponadto utworzono kolumnÄ™ 'simple distance', wskazujÄ…cÄ… czy lot byÅ‚ dÅ‚uÅ¼szy od 4250 mil, czy nie. 
            Tu rÃ³wnieÅ¼ usuniÄ™to pierwotnÄ… kolumnÄ™ dystansu oraz kolumnÄ™ wieku.
            <br><br>
            Modelowania wykonano dwa razy, za pierwszym razem bez uproszczonego dystansu i bez uzupeÅ‚nionych Å›rednimi ocenami usÅ‚ug wedÅ‚ug pÅ‚ci i bez uproszczonego dystansu.
            W poprawionej wersji danych do o modelowania odrzucono kolumny poszczegÃ³lnych pokoleÅ„ na rzecz kolumny utworzonej poprzez ordinal-encoding z wartoÅ›ciami od 1 do 5, reprezentujÄ…cymi kaÅ¼de pokolenie.
            DziÄ™ki temu moÅ¼na byÅ‚o porÃ³wnaÄ‡ efekty poprawienia zestawu danych. 
            We wszystkich modelach test_size w Train-Test-Split ustawiono na 0.3 co oznacza, Å¼e 70% danych zostaÅ‚o przeznaczone na wytrenowanie modelu, 
            a 30% na sprawdzenie. 
            <br><br>
            Do ewaluacji modeli wykorzystano raport klasyfikacyjny i <a href="https://pl.wikipedia.org/wiki/Tablica_pomy%C5%82ek">tablicÄ™ pomyÅ‚ek</a> z biblioteki sklearn.metrics. 
            Raport klasyfikacyjny opiera siÄ™ na nastÄ™pujÄ…cych miarach: <br>
            <li class="tablica-pomylek">True positive - prawdziwie pozytywna</li>
            <li class="tablica-pomylek">True negative - prawdziwie negatywna</li>
            <li class="tablica-pomylek">True positive - faÅ‚szywie pozytywna</li>
            <li class="tablica-pomylek">True positive - faÅ‚szywie negatywna</li>

            <li class="tablica-pomylek">Accuracy - dokÅ‚adnoÅ›Ä‡, 
              \(\frac{correct\text{ }predictions}{all\text{ }predictions}\)
               - dobrze siÄ™ sprawdza przy wyrÃ³wnanej proporcji badanego atrybutu</li>
               
            <li class="tablica-pomylek">Recall - czuÅ‚oÅ›Ä‡, 
              \(\frac{true\text{ }positives}{true\text{ }positives + false\text{ }negatives}\)
               - odsetek prawdziwych pozytywÃ³w</li>

            <li class="tablica-pomylek">Precision - precyzja, 
              \(\frac{true\text{ }positives}{true\text{ }positives + false\text{ }positves}\)
               - brane pod uwagÄ™ tylko pozytywy, ile z nich jest prawdziwych</li>

            <li class="tablica-pomylek">F1-Score - 
              \(2*\frac{precision \text{ } * \text{ } recall}{precision \text{ } + \text{ } recall}\)
               - kombinacja (Å›rednia harmoniczna) czuÅ‚oÅ›ci i precyzji, 
               eliminuje znaczne odchylenia i znajduje zastosowanie w rÃ³wnieÅ¼ zestawach danych z rÃ³Å¼nÄ… dystrybucjÄ… badanego atrybutu</li>

              <br>
            <div class="center-h5s">
              <h5>Surowe dane, brak lojalnoÅ›ci klienta</h5>
            </div>

            <div style="display: flex; justify-content: center; ">
              <div class="table-responsive table-bordered" style="width: 100%; max-width: 450px; margin: auto; object-fit: contain; padding: 10px;">
                <table class="table" style="padding: 10px; margin: 10px;">
                  <tr>
                      <td> </td>
                      <td>precision</td>
                      <td>recall</td>
                      <td>f1-score</td>
                      <td>amount</td>
                  </tr>
                  <tr>
                      <td>0</td>
                      <td>0,91</td>
                      <td>0,95</td>
                      <td>0,93</td>
                      <td>31932</td>
                  </tr>
                  <tr>
                      <td>1</td>
                      <td>0,70</td>
                      <td>0,56</td>
                      <td>0,62</td>
                      <td>7032</td>
                  </tr>
                  <tr>
                      <td></td>
                      <td></td>
                      <td></td>
                      <td></td>
                      <td></td>
                  </tr>
                  <tr>
                      <td>accuracy</td>
                      <td></td>
                      <td></td>
                      <td>0,88</td>
                      <td>38964</td>
                  </tr>
                  <tr>
                      <td>macro avg</td>
                      <td>0,80</td>
                      <td>0,75</td>
                      <td>0,78</td>
                      <td>38964</td>
                  </tr>
                  <tr>
                      <td>weighted avg</td>
                      <td>0,87</td>
                      <td>0,88</td>
                      <td>0,87</td>
                      <td>38964</td>
                  </tr>
              </table>
              </div>
              <div class="table-responsive table-bordered" style="width: 100%; max-width: 350px; margin: auto; object-fit: contain; padding: 10px;">
                <table class="table" style="padding: 10px; margin: 10px;">
                  <tr>
                      <td></td>
                      <td>Predicted 0</td>
                      <td>Predicted 1</td>
                  </tr>
                  <tr>
                      <td>Actual 0</td>
                      <td>30223</td>
                      <td>1709</td>
                  </tr>
                  <tr>
                      <td>Actual 1</td>
                      <td>3074</td>
                      <td>3958</td>
                  </tr>
              </table>
              </div>
            </div>

            <br><br>

            <div class="center-h5s">
              <h5>Surowe dane, satysfakcja klienta</h5>
            </div>


            <div style="display: flex; justify-content: center; ">
              <div class="table-responsive table-bordered" style="width: 100%; max-width: 450px; margin: auto; object-fit: contain; padding: 10px;">
                <table class="table" style="padding: 10px; margin: 10px;">
                  <tr>
                    <td>#</td>
                    <td>precision</td>
                    <td>recall</td>
                    <td>f1-score</td>
                    <td>amount</td>
                </tr>
                <tr>
                    <td>0</td>
                    <td>0,80</td>
                    <td>0,78</td>
                    <td>0,79</td>
                    <td>17598</td>
                </tr>
                <tr>
                    <td>1</td>
                    <td>0,82</td>
                    <td>0,84</td>
                    <td>0,83</td>
                    <td>7032</td>
                </tr>
                <tr>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>accuracy</td>
                    <td></td>
                    <td></td>
                    <td>0,81</td>
                    <td>38964</td>
                </tr>
                <tr>
                    <td>macro avg</td>
                    <td>0,81</td>
                    <td>0,81</td>
                    <td>0,81</td>
                    <td>38964</td>
                </tr>
                <tr>
                    <td>weighted avg</td>
                    <td>0,81</td>
                    <td>0,81</td>
                    <td>0,81</td>
                    <td>38964</td>
                </tr>
            </table>
              </div>
              <div class="table-responsive table-bordered" style="width: 100%; max-width: 350px; margin: auto; object-fit: contain; padding: 10px;">
                <table class="table" style="padding: 10px; margin: 10px;">
                  <tr>
                    <td></td>
                    <td>Predicted 0</td>
                    <td>Predicted 1</td>
                </tr>
                <tr>
                    <td>Actual  0</td>
                    <td>13711</td>
                    <td>3887</td>
                </tr>
                <tr>
                    <td>Actual 1</td>
                    <td>3327</td>
                    <td>18039</td>
                </tr>
            </table>
              </div>
            </div>
            
            Jak widaÄ‡, model przewidujÄ…cy lojalnoÅ›Ä‡ klienta miaÅ‚ doÅ›Ä‡ duÅ¼y problem z przewidywaniem faktycznie nielojalnych klientÃ³w. 
            Najprawdopodobniej wynika to z dysproporcji miÄ™dzy iloÅ›ciÄ… lojalnych a nielojalnych klientÃ³w (ok. 16%).
            Proporcja usatsfakcjonowanych do nieusatysfakcjonowanych jest bardziej wyrÃ³wnana (ok. 54%).

            <br><br>

            <div class="center-h5s">
              <h5>Poprawione dane, brak lojalnoÅ›ci klienta</h5>
            </div>

            <div style="display: flex; justify-content: center; ">
              <div class="table-responsive table-bordered" style="width: 100%; max-width: 450px; margin: auto; object-fit: contain; padding: 10px;">
                <table class="table" style="padding: 10px; margin: 10px;">
                  <tr>
                    <td></td>
                    <td>precision</td>
                    <td>recall</td>
                    <td>f1-score</td>
                    <td>support</td>
                </tr>
                <tr>
                    <td>0</td>
                    <td>0,92</td>
                    <td>0,94</td>
                    <td>0,93</td>
                    <td>31932</td>
                </tr>
                <tr>
                    <td>1</td>
                    <td>0,71</td>
                    <td>0,62</td>
                    <td>0,66</td>
                    <td>7032</td>
                </tr>
                <tr>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>accuracy</td>
                    <td></td>
                    <td></td>
                    <td>0,88</td>
                    <td>38964</td>
                </tr>
                <tr>
                    <td>macro avg</td>
                    <td>0,81</td>
                    <td>0,78</td>
                    <td>0,79</td>
                    <td>38964</td>
                </tr>
                <tr>
                    <td>weighted avg</td>
                    <td>0,88</td>
                    <td>0,88</td>
                    <td>0,88</td>
                    <td>38964</td>
                </tr>
            </table>
              </div>
              <div class="table-responsive table-bordered" style="width: 100%; max-width: 350px; margin: auto; object-fit: contain; padding: 10px;">
                <table class="table" style="padding: 10px; margin: 10px;">
                  <tr>
                    <td></td>
                    <td>Przewidziane 0</td>
                    <td>Przewidziane 1</td>
                </tr>
                <tr>
                    <td>Prawdziwe 0</td>
                    <td>30150</td>
                    <td>1782</td>
                </tr>
                <tr>
                    <td>Prawdziwe 1</td>
                    <td>2706</td>
                    <td>4326</td>
                </tr>
            </table>
              </div>
            </div>

            <br><br>

            <div class="center-h5s">
              <h5>Poprawione dane, satysfakcja klienta</h5>
            </div>


            <div style="display: flex; justify-content: center; ">
              <div class="table-responsive table-bordered" style="width: 100%; max-width: 450px; margin: auto; object-fit: contain; padding: 10px;">
                <table class="table" style="padding: 10px; margin: 10px;">
                  <tr>
                    <td></td>
                    <td>precision</td>
                    <td>recall</td>
                    <td>f1-score</td>
                    <td>support</td>
                </tr>
                <tr>
                    <td>0</td>
                    <td>0,84</td>
                    <td>0,82</td>
                    <td>0,83</td>
                    <td>17598</td>
                </tr>
                <tr>
                    <td>1</td>
                    <td>0,86</td>
                    <td>0,88</td>
                    <td>0,87</td>
                    <td>21366</td>
                </tr>
                <tr>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>accuracy</td>
                    <td></td>
                    <td></td>
                    <td>0,85</td>
                    <td>38964</td>
                </tr>
                <tr>
                    <td>macro avg</td>
                    <td>0,85</td>
                    <td>0,85</td>
                    <td>0,85</td>
                    <td>38964</td>
                </tr>
                <tr>
                    <td>weighted avg</td>
                    <td>0,85</td>
                    <td>0,85</td>
                    <td>0,85</td>
                    <td>38964</td>
                </tr>
            </table>
              </div>
              <div class="table-responsive table-bordered" style="width: 100%; max-width: 350px; margin: auto; object-fit: contain; padding: 10px;">
                <table class="table" style="padding: 10px; margin: 10px;">
                  <tr>
                    <td></td>
                    <td>Predicted 0</td>
                    <td>Predicted 1</td>
                </tr>
                <tr>
                    <td>Actual  0</td>
                    <td>14474</td>
                    <td>3124</td>
                </tr>
                <tr>
                    <td>Actual 1</td>
                    <td>2660</td>
                    <td>18706</td>
                </tr>
            </table>
              </div>
            </div>



            <div style="height: 5px;"></div>
            Poprawienie danych pozytywnie wpÅ‚ynÄ™Å‚o na wiÄ™kszoÅ›Ä‡ miar - jedyne miejsce w ktÃ³rym model siÄ™ nieznacznie pogorszyÅ‚ to recall dla lojalnoÅ›ci.
            PatrzÄ…c na F-1 Score przewidywanie lojalnoÅ›ci poprawiÅ‚o siÄ™, jednak problem z rozpoznawaniem nielojalnych klientÃ³w pozostaÅ‚.
            CelnoÅ›Ä‡ poprawiÅ‚a siÄ™ o 295 (zmiana mniejsza niÅ¼ 1%) przypadkÃ³w poprawnie rozpoznanych w przypadku lojalnoÅ›ci i o  1 430 przypadkÃ³w w przypadku satysfakcji (zmiana 4%).
            <div style="height: 5px;"></div>

            <br><br>
            W przypadku gdy chcielibyÅ›my przewidzieÄ‡ pojedynczy przykÅ‚ad, moÅ¼na sprawdziÄ‡ pewnoÅ›Ä‡ (prawdopodobieÅ„stwo) przynaleÅ¼oÅ›ci do danej klasy przy pomocy poniÅ¼szego kodu:

            <div style="display: flex; justify-content: center; padding: 10px; margin: 10px;">
              <pre><code>
sample = Xl_test.sample(n=1)
pred = logmodel.predict(sample)
log_probs = logmodel.predict_log_proba(sample)[:,1]
probs = np.exp(log_probs)
print(f'Wynik: {pred}\n 
        PrawdopodobieÅ„stwo: {probs}\n 
        Logarytm prawdopodobieÅ„stwa: {log_probs}')

# out:
Wynik: [0]
PrawdopodobieÅ„stwo: [0.05414234] 
Logarytm prawdopodobieÅ„stwa: [-2.91613885]
                            </code></pre>
                            <pre><code>
            


            </code></pre>
          </div>
          Czyli w tym przypadku doÅ›Ä‡ pewna przynaleÅ¼noÅ›Ä‡ do lojalnych klientÃ³w - prawdopodobieÅ„stwo bardzo bliskie 0.
          <br><br>
            <h4 id="wnioski-header">7. Wnioski</h4>
            <h6>
              Na podstawie wynikÃ³w z tabeli oraz interpretacji wykresÃ³w i bÅ‚Ä™dÃ³w wyciÄ…gniÄ™to nastÄ™pujÄ…ce wnioski:
            </h6>
            <li>Modele okazaÅ‚y siÄ™ doÅ›Ä‡ celne, z wyjÄ…tkiem przewidywania nielojalnych klientÃ³w</li>
            <li>KNiemal wszystkie usÅ‚ugi sÄ… lepiej oceniane przez kobiety niÅ¼ mÄ™Å¼czyÅºn</li>
            <li>Dana linia lotnicza powinna wymieniÄ‡ siedzenia w swoich samolotach</li>
            <li>PieniÄ…dze nie kupiÄ… lepszych czasÃ³w odlotÃ³w/przylotÃ³w, chyba Å¼e posiadamy prywatny odrzutowiec</li>
            <li>Jednym z najisotniejszych problemÃ³w jest jakoÅ›Ä‡ rozrywki na pokÅ‚adzie - najlepiej nie polegaÄ‡ na jakoÅ›ci filmÃ³w dostÄ™pnych podczas lotu</li>
          
            <br>
            <h6>Sugestie jak ulepszyÄ‡ modele:
            </h6>
            <li>SprawdziÄ‡ czy uzupeÅ‚nie brakujÄ…cych ocen usÅ‚ug wg innych kryteriÃ³w np. Å›rednia dla danej usÅ‚ugi dla danego pokolenia przyniosÅ‚aby lepszy efekt, 
              lub sprÃ³bowanie uzupeÅ‚nienia danych Å›rednimi wartoÅ›ciami dla dwÃ³ch kryteriÃ³w np. i pÅ‚eÄ‡ i pokolenie.
            </li>
            <li>
              ZastosowaÄ‡ GridSearch aby znaleÅºÄ‡ najlepszy prÃ³g odciÄ™cia, inny niÅ¼ 0,5.
            </li>






          </div>

        </div>
      </span>
        <div class="col-md-3"> <!-- SIDEBAR -->
          <div class="sticky">
            <p>Nawigacja:</p>
            <a href="#wstep-header">1. WstÄ™p</a> <br>
            <a href="#analiza_zestawu_danych-header">2. Analiza zestawu danych</a> <br>
            <a href="#wizualizacja-header">3. Wizualizacja danych</a> <br>
            <a href="#uwagi-header" style="margin-left:15px">Uwagi dotyczÄ…ce korelacji</a> <br>
            <a href="#modelowanie-header">6. Modelowanie</a> <br>
            <a href="#wnioski-header">7. Wnioski</a> <br>
          </div>
        </div>
    </div>
      


    <div id="footer", class="bottom", style="font-size:0.77em;">      
          <p style="margin:5px;">&copy; <script>document.write(new Date().getFullYear());</script> Konrad Jarominiak</p>
          <p>Wykorzystano:
            <a href="https://getbootstrap.com/" class="footer-link">Bootsrap 5</a>,
            <a href="https://highlightjs.org/" class="footer-link">highlight.js</a>,
            <a href="https://www.mathjax.org/" class="footer-link">MathJax</a> </p>
      
        </div>

    <script>hljs.highlightAll();</script>
  </body>
</html>