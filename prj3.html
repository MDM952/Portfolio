<!DOCTYPE html>
<html lang="en" dir="ltr">

    <head>
        <meta charset="utf-8">
        <title>Projekt III ğŸ¦ˆ</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
        <link rel="stylesheet" href="css/css_project_page.css">
        <link rel="stylesheet" href="css/cssmaster.css">
        <script src="scripts\copy mail.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Montserrat&display=swap" rel="stylesheet">
        <script src="https://kit.fontawesome.com/1c9ad4b785.js" crossorigin="anonymous"></script>

        <link rel="stylesheet" href="scripts\code highlight\styles\idea.min.css"/>
        <script src="scripts\code highlight\highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>

        <script type="text/javascript" id="MathJax-script" async
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
        </script>

        

      </head>
  <body>
      
    <section class="jumbotron text-center">
        <div class="container", style="padding: 40px;">
          <h2>Model przewidujÄ…cy jakoÅ›Ä‡ horroru na podstawie jego tytuÅ‚u 
            <br>(Niemal 100% skutecznoÅ›ci! Niezwykle praktyczny!)</h2>
          <p class="lead text-muted">
            Niezbyt powaÅ¼ny projekt dotyczÄ…cy przewidywania oceny horrorÃ³w klasy D na podstawie ich tytuÅ‚Ã³w. 
            <br>Wizualizacja danych i model lasu losowego (random forest).
          </p>

          <div style="height: 40px;"></div>

          <div class="container">
            <div class="row justify-content-md-center">
              <div class="col col-lg-4">
                <div class="accordion" id="accordionPanelsStayOpenExample" style="width: 450px;">
                  <div class="accordion-item">
                    <h2 class="accordion-header" style="margin: auto;">
                      <button class="accordion-button" type="button" data-bs-toggle="collapse" 
                      data-bs-target="#panelsStayOpen-collapseTwelve" aria-expanded="true" aria-controls="panelsStayOpen-collapseTwelve">
                      MÃ³j email â†´
                      </button>
                    </h2>
                    <div id="panelsStayOpen-collapseTwelve" class="accordion-collapse collapse" style="margin-top: 20px; margin-bottom: 20px">
                      <div class="accordion-body" >
    <!-- The text field -->
    
                        <div style="margin: auto">
                          <div class="row g-3 align-items-center">

                            <div class="col-auto" style="margin: 0px">
                              <input type="text" 
                                      id="myInput" 
                                      class="form-control form-control-sm" 
                                      value="konrad.jarominiak0@gmail.com" disabled
                                     style="width: 250px">
                            </div>
                            <div class="col-auto" style="margin: auto; padding:auto">
                              <button type="button" class="btn btn-outline-secondary btn-sm" onclick="myFunction()">skopiuj do schowka</button>
                            </div>
                          </div>
                        </div>
    
    
    
    
    <!-- The button used to copy the text -->
    
    
    <!-- The toast -->
                          <div aria-live="polite" aria-atomic="true" style="position: relative; min-height: 0px;">
                            <div class="toast" style="position: absolute; top: 0px; right: 0; width:250px">
                              <div class="toast-body">
                                Skopiowano do schowka!
                              </div>
                            </div>
                          </div>
                          
                      </div>
                    </div>
                  </div>
      
                </div>   
              </div>

              <div class="col col-lg-4">
                

                <div style="width: 450px; padding-top: 15px; padding-bottom: 15px;">
                  <a
                  href="index.html"
                  class="btn btn-secondary my-2"
                  >PowrÃ³t</a>
                </div>

              </div>
            </div>
          </div>


          <div class="true_center">
            <div class="row" style="margin:margin-top: 40px; width: 100%">
              <div class="col col-sm">
             </div>
              <div class="col col-sm">

              </div>
            </div>
          </div>





          

        </div>
    </section>

    <span class="border border-0">

    <div style="height: 30px;"></div>

    <div class="container">
      <div class="row">
        <div class="col-md-9"> <!--TU ZWIJAÄ†-->

          <div class="tresc wstep">
            <h4 id="wstep-header">1. WstÄ™p</h4>
            PomysÅ‚ na ten projekt zrodziÅ‚ siÄ™ z przemyÅ›leÅ„ nad zatrzÄ™sieniem niezaprzeczalnie fatalnych, tanich filmÃ³w na serwisach VOD, 
            ktÃ³rych jedynym celem jest <a href="https://www.giantfreakinrobot.com/ent/watchbait-new-clickbait.html">przyciÄ…gniÄ™cie</a> 
            widza swoim tytuÅ‚em nawiÄ…zujÄ…cym do starych, sÅ‚ynnych filmÃ³w. 
            Na przykÅ‚ad multum filmÃ³w o rekinach udajÄ…cych sequele "SzczÄ™k" Spielberg'a.
            <br> <br>  
            Czy moÅ¼na przewidzieÄ‡ powodzenie takiego filmu na podstawie jego tytuÅ‚u? 
            Ten projekt jest nieporadnÄ… prÃ³bÄ… utworzenia modelu, ktÃ³ry przewiduje oceny horrorÃ³w i ich podrÃ³bek na podstawie ich tytuÅ‚Ã³w.
            <br><br>
            Projekt opiera siÄ™ na zestawie danych z <a href="https://www.kaggle.com/datasets/rounakbanik/the-movies-dataset?select=movies_metadata.csv">Kaggle</a>,
            ktÃ³ry, wedÅ‚ug opisu, jest poÅ‚Ä…czeniem danych z <a href="https://www.kaggle.com/datasets/rounakbanik/the-movies-dataset?select=movies_metadata.csv">TMDB</a> i 
            <a href="https://grouplens.org/datasets/movielens/">MovieLens</a>.
            <br>
            Do wykonania niniejszego projektu wykorzystano biblioteki:
            <div style="height: 3px;"></div>

            <ul>
            <li>Pandas i Numpy do przetworzenia i oczyszczenia danych</li>
            <li>Matplotlib i Seaborn do wizualizacji danych</li>
            <li>sci-kit learn do stworzenia modeli</li>
            </ul>

          </div>

          <div class="tresc analiza_zestawu_danych">
            <h4 id="analiza_zestawu_danych-header">2. Analiza zestawu danych</h4>

            W tabeli znajdujÄ… siÄ™ aÅ¼ 24 kolumny dotyczÄ…ce danych poszczegÃ³lnych filmÃ³w, np. tytuÅ‚, tagline, popularnoÅ›Ä‡, przychÃ³d, opis, etc.
            Na potrzeby modelu, kolumny ktÃ³re byÅ‚yby przydatne to:

            <ul>
            <li>tytuÅ‚</li> 
            <li>gatunek</li>
            <li>budÅ¼et</li>
            <li>przychÃ³d</li>
            <li>ocena</li>
            </ul>

            W pierwszej kolejnoÅ›ci spisano listÄ™ czÅ‚onÃ³w tytuÅ‚Ã³w. CzeÅ›Ä‡ z nich moÅ¼e wyglÄ…daÄ‡ doÅ›Ä‡ dziwnie, np. 'Dea'.
            Taki czÅ‚on ma wyÅ‚apaÄ‡ tytuÅ‚y zawierajÄ…ce zarÃ³wno 'Death' jak i 'Dead' i zostaÄ‡ poÅ‚Ä…czone w tytuÅ‚ jak np.
            'shark' w <a href="https://www.imdb.com/title/tt2724064/">Sharknado</a>. 
            <br><br>
            Lista czÅ‚onÃ³w przedstawia siÄ™ nastÄ™pujÄ…co:
            <pre><code>
['Evil', 'Final', 'Night', 'Kill', 'Scar', 'Scream', 'Land', 'Nado', 'Wolf', 'Dea', 
'Moon', 'Chainsaw', 'American', 'Witch', 'Cannibal', 'Monster', 'Child', 'Haunt', 
'Fear', 'Clown', 'Curs', 'Blac', 'Devil', '3D', 'Asylum', 'Conjur', 'Ouija', 'Shark', 
'Ville', 'Town', 'Texas', 'Mummy', 'Corn', 'Exorc', 'Psycho', 'Dino', 'Virus', 'House', 
'Vengeance', 'Blood', 'Nurse', 'Demon', 'Zombie', 'Cula', 'Stein', 'Geist']
            </code></pre>


            <br>
            NastÄ™pnie utworzono funkcjÄ™ agregujÄ…cÄ… tytuÅ‚y do sprawdzenia iloÅ›ci filmÃ³w z danymi czÅ‚onami.

            <pre><code>
shape_amount = {}

def check_amount(part_to_check):

    # czÄ™Å›Ä‡ weryfikujÄ…ca
    print(f'Title part: "{part_to_check}"')
    print(f'Amount: {df[df["original_title"].str.contains(part_to_check, case=False)].shape[0]}')
    print(f'Avg score: {df[df["original_title"].str.contains(part_to_check, case=False)]["vote_average"].mean().round(2)}')

    # czÄ™Å›Ä‡ agregujÄ…ca
    shape_amount[part_to_check] = df[df["original_title"].str.contains(part_to_check, case=False)].shape[0]
    

check_amount(random.sample(title_parts, 1)[0]) # sprawdzamy losowy czÅ‚on

# out:
Title part: "Moon"
Amount: 16
Avg score: 4.25
            </code></pre>

            Na podstawie danych zagregowanych do sÅ‚ownika utworzono dataframe i wykres kolumnowy z iloÅ›ciÄ… tytuÅ‚Ã³w zawierajÄ…cÄ… dany czÅ‚on. 
            <br> Wykres ten zawiera 1425 czÅ‚onÃ³w, z czego 208 to duplikaty, co oznacza, 
            Å¼e 17% tytuÅ‚Ã³w jest przynajmniej dwuczÅ‚onowa.

            <div class="accordion" id="accordionPanelsStayOpenExample">
              <div class="accordion-item">
                <h2 class="accordion-header">
                  <button class="accordion-button" type="button" data-bs-toggle="collapse" 
                  data-bs-target="#panelsStayOpen-collapseNine" aria-expanded="true" aria-controls="panelsStayOpen-collapseNine", style="padding: auto;">
                    <img src="css\p3_images\title parts amount.png" style="max-width: 100%; margin: auto;">                
                  </button> 
                </h2>
                <div id="panelsStayOpen-collapseNine" class="accordion-collapse collapse">
                  <div class="accordion-body">
  <pre><code>
sf = pd.DataFrame.from_dict(shape_amount, orient='index', columns=['amount'])
sf = sf.sort_values('amount', ascending=False)

fig, ax = plt.subplots(figsize=(9,6))
plt.xticks(rotation=90)
chart = sns.barplot(data=sf, x=sf.index, y='amount', palette='plasma')
chart.set_title('RozkÅ‚ad czÄ™Å›ci tytuÅ‚Ã³w')
chart.set(xlabel='CzÄ™Å›Ä‡ tytuÅ‚u', ylabel='IloÅ›Ä‡')
  </code></pre>                </div>
                </div>
              </div>
            </div>

            <br>
            Kolejno przefiltrowano zestaw danych tak, aby pozostaÅ‚y tylko te horrory, ktÃ³re zawierajÄ… przynajmniej jeden czÅ‚on z naszej listy.
            Sprawdzono rÃ³wnieÅ¼ jaka iloÅ›Ä‡ filmÃ³w zawiera dane dotyczÄ…ce budÅ¼etu i przychodu. 
            Niestety znaczna wiÄ™kszoÅ›Ä‡ z nich nie ma tych wartoÅ›ci sprecyzowanych i ostatecznie kolumny 'budget' i 'revenue' zostaÅ‚y usuniÄ™te przed modelowaniem.
            Tak duÅ¼e iloÅ›ci brakujÄ…cych danych bardzo negatywnie wpÅ‚ynÄ™Å‚y by na jakoÅ›Ä‡ modelu. 
            <br> <br>



            <pre><code> <!-- Kod dla pokoleÅ„ i dystansu -->
watchbait_df = pd.DataFrame()

for i in title_parts:
    current_part = df[df["original_title"].str.contains(i, case=False)]
    print(f'"{i}" in titles: {current_part.shape[0]}; Average score: {current_part["vote_average"].mean().round(1)}')
    watchbait_df = pd.concat([watchbait_df, current_part], ignore_index=True)

# out:
"Zombie" in titles: 47; Average score: 4.5

print(f'Budget over 0: {watchbait_df[watchbait_df["budget"] > 0].shape[0]}')
print(f'Revenue over 0: {watchbait_df[watchbait_df["revenue"] > 0].shape[0]}')
print(f'Total amount of titles: {watchbait_df.shape[0]}')

# out:
Budget over 0: 419
Revenue over 0: 251
Total amount of titles: 1425
            </code></pre>

            UsuniÄ™to rÃ³wnieÅ¼ filmy z iloÅ›ciÄ… ocen 0, 1 i 2. 
            Filmy z iloÅ›ciÄ… ocen rÃ³wnÄ… 3 miaÅ‚y wystarczajÄ…co sensowne wyniki tzn. oceny byÅ‚y niewiÄ™ksze niÅ¼ 7. 
            Gdyby koÅ„cowy rozmiar zestawu danych nie byÅ‚ maÅ‚y (115 tytuÅ‚Ã³w), odciÄ™cie po iloÅ›ci ocen oczywiÅ›cie by zwiÄ™kszono.
            Kolejno przeprowadzono nastÄ™pujÄ…ce operacje:

            <li>UsuniÄ™to duplikaty</li>
            <li>Ograniczono tabelÄ™ do tytuÅ‚u, oceny i iloÅ›ci ocen</li>
            <li>Przeprowadzon one-hot encoding czÅ‚onÃ³w tytuÅ‚Ã³w</li>
            <li>Utworzono uproszczonÄ… kolumnÄ™ ocen - 'Rating' z trzema moÅ¼liwymi stopniami: 'Good', 'Decent', 'Awful'. Te wartoÅ›ci bÄ™dzie przewidywaÅ‚ model. 
              PrzedziaÅ‚y wyznaczono na podstawie koÅ„cowego histogramu ocen, zamieszczonego poniÅ¼ej.</li>
            <li>Ograniczono tytuÅ‚y tylko do tych, ktÃ³re majÄ… przynajmniej dwuczÅ‚onowe tytuÅ‚y - tu iloÅ›Ä‡ filmÃ³w spadÅ‚a do 115. </li>
            <br>

            <div class="accordion" id="accordionPanelsStayOpenExample">
              <div class="accordion-item">
                <h2 class="accordion-header">
                  <button class="accordion-button" type="button" data-bs-toggle="collapse" 
                  data-bs-target="#panelsStayOpen-collapseSeven" aria-expanded="true" aria-controls="panelsStayOpen-collapseSeven">
                    Kod dla procedur powyÅ¼ej
                  </button>
                </h2>
                <div id="panelsStayOpen-collapseSeven" class="accordion-collapse collapse">
                  <div class="accordion-body">
  
                    <pre><code>
  # usuniÄ™cie duplikatÃ³w
  print(f'Before duplicate removal: {df.shape[0]}')
  df = df.drop_duplicates()
  print(f'After duplicate removal: {df.shape[0]}\n')
  
  # out:
  Before duplicate removal: 1425
  After duplicate removal: 1218
  
  
  # ograniczenie df do istotnych kolumn
  df = df[['title', 'vote_average', 'vote_count']]
  
  
  # one-hot encoding czÅ‚onÃ³w
  def get_part(title, part):
      if part.lower() in title.lower():
          return 1
      else:
          return 0
  
  for title_part in title_parts:
      df[title_part] = df['title'].apply(lambda x: get_part(x, title_part))
  
  
  def uniform_score(vote):
      if vote >= 6.5:
          return 'Good'
      elif vote >= 4 and vote < 6.5:
          return 'Decent'
      elif vote < 4:
          return 'Awful'
  
  df['Rating'] = df["vote_average"].apply(lambda x: uniform_score(x))
  
  
  # uciÄ™cie do min. dwuczÅ‚onowych filmÃ³w, to pÃ³jdzie do modelowania
  df_cut = df[df["Title parts"] > 1]
                    </code></pre>
  
                  </div>
                </div>
              </div>
              <div class="accordion-item">
                <h2 class="accordion-header">
                  <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" 
                  data-bs-target="#panelsStayOpen-collapseEight" aria-expanded="false" aria-controls="panelsStayOpen-collapseEight">
  <img src="css\p3_images\histogram ocen.png" style="margin:auto" alt="">
                  </button>
                </h2>
                <div id="panelsStayOpen-collapseEight" class="accordion-collapse collapse">
                  <div class="accordion-body">
  
                    <pre><code>
sns.set_style('white')

plt.figure(figsize=(9, 5))
ax = sns.histplot(df_cut['vote_average'], binwidth=.2, color='#1d76bf',)

plt.xticks(np.arange(1, 9, 1))
plt.yticks(np.arange(0, 12, 2))
ax.set_title('Histogram ocen', fontdict={'fontsize':12})
ax.set_xlabel('Åšrednia ocena', fontdict={'fontsize':11})
ax.set_ylabel('CzÄ™stoÅ›Ä‡', fontdict={'fontsize':11})
                    </code></pre>
  
                  </div>
                </div>
              </div>
            </div>
<br>


          </div>
            <div class="tresc analiza_zestawu_danych">
              <h4 id="wizualizacja-header">3. Sprawdzenie korelacji</h4>


              

              <br>
              Przed rozpoczÄ™ciem modelowania sprawdzono, 
              czy w zestawie danych istnieje zaleÅ¼noÅ›Ä‡ miÄ™dzy samymi czÅ‚onami tytuÅ‚Ã³w a ocenÄ… filmÃ³w.
              Dokonano tego zestawiajÄ…c korelacjÄ™ czÅ‚onÃ³w do oceny (sÅ‚upki) wraz samÄ… Å›redniÄ… ocenÄ… dla danego czÅ‚onu (linia).
              
              <br>
              
          <div class="accordion" id="accordionPanelsStayOpenExample">
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button" type="button" data-bs-toggle="collapse" 
                data-bs-target="#panelsStayOpen-collapseFivee" aria-expanded="true" aria-controls="panelsStayOpen-collapseFivee">
<img src="css\p3_images\titlepart and corr.png" style="width: 100%;" alt="">
                </button>
              </h2>
              <div id="panelsStayOpen-collapseFivee" class="accordion-collapse collapse">
                <div class="accordion-body">
                  <pre><code class="language-python">
# kolumna czÅ‚onu do oceny
corr_matrix = df_cut.corr()['vote_average'][1:]

# dodanie kolumny ocen do df, do naniesienia na wykresie jako liniÄ™
dfc_cut = pd.concat([corr_matrix, pd.Series(avg_title_dict)], axis=1)
dfc_cut.columns = ['correlation', 'vote_average']

# poprawka i usuniÄ™cie czÅ‚onÃ³w bez korelacji
dfc_cut = dfc_cut.reset_index()
dfc_cut.columns = ['title', 'correlation', 'vote_average']
dfc_cut.dropna(inplace=True)

# wykres
fig, ax = plt.subplots(figsize=(10,7))
plt.xticks(rotation=90)
plt.rcParams['font.size'] = 8

# naniesienie korelacji jako sÅ‚upki z sortowaniem po korelacji
ax = sns.barplot(data=dfc_cut.sort_values(by='correlation'), x='title', y='correlation', palette='magma')
ax.set_ylim(-0.35, 0.35)
ax.set_ylabel('Korelacja (sÅ‚upki)', fontdict={'fontsize':9})

# naniesienie ocen jako linii z sortowaniem po korelacji
ax2 = ax.twinx()
sns.lineplot(data=dfc_cut.sort_values(by='correlation'), x='title', y='vote_average', ax=ax2, marker='.', color='royalblue')
ax2.set_ylabel('Vote Average', fontdict={'fontsize':10})
ax2.set_ylabel('Åšrednia ocena (linia)')

# formatowanie
ax.set_xlabel('CzÅ‚on tytuÅ‚u', fontdict={'fontsize':'10'})
plt.title('Korelacja i Å›rednia ocena czÅ‚onÃ³w tytuÅ‚Ã³w', fontdict={'fontsize':11})
                    </code></pre>
                </div>
              </div>
            </div>
          </div>
          <li class="opis_wiz">
            Korelacje sÄ… niskie, czego moÅ¼na siÄ™ byÅ‚o spodziewaÄ‡. Na szczÄ™Å›cie celem tego modelu jest dowcip, nie trafnoÅ›Ä‡ czy sÅ‚usznoÅ›Ä‡.
          </li>

          <li class="opis_wiz">
            W niektÃ³rych czÅ‚onach wystÄ™puje dziwny stosunek korelacji do oceny, 
            w szczegÃ³lnoÅ›ci "Shark" - czÅ‚on ten ma najniÅ¼szÄ… Å›redniÄ… ocenÄ™ filmÃ³w, jednak jego korelacja jest bliska 0.
            ByÄ‡ moÅ¼e wynika to z wystÄ™powania innych czÅ‚onÃ³w wraz z czÅ‚onem "Shark".

          </li>
          <li class="opis_wiz">
            Najgorszym czÅ‚onem okazaÅ‚o siÄ™ "Zombie", co ma sens, ze wzglÄ™du na czÄ™stoÅ›Ä‡ tego czÅ‚onu, ogÃ³lnÄ… sztampowoÅ›Ä‡ filmÃ³w o zombie i ich niskÄ… ocenÄ™. 
            Tu znÃ³w pojawia siÄ™ problem braku rÃ³wnowagi w iloÅ›ci poszczegÃ³lnych atrybutÃ³w i wpÅ‚ywu na korelacjÄ™, jak w przypadku pokoleÅ„ w projekcie ocen usÅ‚ug lotniczych.
            Aby wartoÅ›ci korelacji najlepiej oddawaÅ‚y te zaleÅ¼noÅ›ci, istotne jest aby dane atrybuty byÅ‚y w miarÄ™ rÃ³wno reprezentowane.
          </li>

          
          </div>

          <div class="tresc modelowanie">
            <h4 id="modelowanie-header">Modelowanie</h4>
            Do modelowania wykorzystano tzw. las losowy (ang. random forest), Å›wietnÄ… metodÄ™ klasyfikacyjnÄ…. 
            Metoda lasu losowego opiera siÄ™ na wykorzystywaniu wielu drzewek decyzyjnych, 
            gdzie kaÅ¼dy z nich otrzymuje inny, losowo wybrany podzbiÃ³r danych uczÄ…cych.
            <br><br>
            <h6>DziaÅ‚anie drzewek decyzyjnych</h6>
            Drzewo decyzyjne polega na podziaÅ‚ach zestawu danych na podzbiory, w taki sposÃ³b, 
            aby jak najlepiej rozrÃ³Å¼niÄ‡ je na podstawie danego atrybutu (np. pogoda - sÅ‚onecznie/pochmurnie czy waga - powyÅ¼ej/poniÅ¼ej 7kg).
            Decyzje jak podzieliÄ‡ zbiÃ³r opierajÄ… siÄ™ na funckjach entropii (minimalizuje nieporzÄ…dek w podziale, jak dobrze dane zostaÅ‚y podzielone) i 
            przyrostu informacji (information gain, bada poprawÄ™ w jakoÅ›ci klasyfikacji).
            Takich podziaÅ‚Ã³w moÅ¼na zastosowaÄ‡ wiele, w przypadku jednego atrybutu nie musi to byÄ‡ teÅ¼ tylko podziaÅ‚ na 2.

            Zestaw danych moÅ¼na dzieliÄ‡, aÅ¼ w koÅ„cowych odnogach drzewka, czyli liÅ›ciach, znajdÄ… siÄ™ pojedyncze klasy. 


            <div class="d-flex align-items-center justify-content-center">
              <figure class="figure mx-auto">
                <img src="css\p3_images\Drzewko decyzyjne v2.png" class="figure-img img-fluid rounded" alt="...">
                <figcaption class="figure-caption">Schemat budowy drzewa decyzyjnego</figcaption>
              </figure>
            </div>
            
            <h6>DziaÅ‚anie lasu losowego</h6>
            Niestety skomplikowane i duÅ¼e zestawy danych wiÄ…Å¼Ä… siÄ™ z przeuczeniem modelu drzewa decyzyjnego i zatraceniem jego uniwersalnoÅ›ci - 
            pojedyncze drzewo decyzyjne moÅ¼e byÄ‡ zbudowane na bardzo wiele sposobÃ³w, z rÃ³Å¼nymi wÄ™zÅ‚ami i przez to rÃ³Å¼nymi, maÅ‚o celnymi wynikami.
            <br><br>
            Las losowy jest bardziej zaawansowanÄ… wersjÄ… drzewa decyzyjnego, ktÃ³ra wykorzystuje wiele drzew, bagging oraz feature randomness: 
            <li>bagging (inaczej Bootstrap Aggregation) - losowe wybieranie prÃ³bek z powtÃ³rzeniami, w jednym podzbiorze przekazanym do drzewa decyzyjnego moÅ¼e znaleÅºÄ‡ siÄ™ kilka takich samych prÃ³bek.</li>
            <li>feature randomness - losowe wybieranie, jaka czÄ™Å›Ä‡ cech (kolumn zestawu danych np. wiek, waga) zostanÄ… wykorzystane w wÄ™zÅ‚ach drzewa. 
              W drzewach decyzyjnych model rozpatruje wszystkie cechy zbioru.</li>
            Techniki te redukujÄ… powiÄ…zania miÄ™dzy osobnymi drzewami decyzyjnymi lasu losowego, dziÄ™ki czemu moÅ¼na uniknÄ…Ä‡ nadmiernego dopasowania danych.

            <br><br>
            Podczas modelowania wykorzystano GridSearch, czyli narzÄ™dzie porÃ³wnujÄ…ce jakoÅ›Ä‡ modeli, w zaleÅ¼noÅ›ci od wartoÅ›ci parametrÃ³w im nadanych. Te parametry to:
            <li>n_estimators - iloÅ›Ä‡ drzew w lesie, domyÅ›lna iloÅ›Ä‡ to 100</li> 
            <li>max_depth - maksymalna gÅ‚Ä™bokoÅ›Ä‡ wÄ™zÅ‚Ã³w drzew, nadanie maksymalnej gÅ‚Ä™bokoÅ›ci zapobiega nadmiernemu dopasowaniu</li>
            <li>min_samples_split - ile gaÅ‚Ä™zi wychodzi z wÄ™zÅ‚a</li>
            <li>max_features - ile cech bÄ™dzie analizowane w modelu, jest to parametr decydujÄ…cy o w.w. feature randomness</li>

              Przedstawiony poniÅ¼ej las losowy przewiduje, ktÃ³rÄ… z ocen 'Good', 'Decent', 'Awful' otrzyma film na podstawie czÅ‚onÃ³w tytuÅ‚Ã³w.

              <pre><code>
X = df_cut.drop(["title", "vote_average", "Rating", "Title parts"], axis=1)
y = df_cut["Rating"]

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3)

from sklearn.model_selection import GridSearchCV

param_grid = {
	'n_estimators': [103, 104, 105],
	'max_depth': [10, 11, 12, None],
	'min_samples_split': [2, 4],
	'max_features': ['sqrt', 'log2']
}

grid_search = GridSearchCV(estimator=RandomForestClassifier(),
						  param_grid=param_grid,
						  verbose=True) # informacja o przebiegu

grid_search.fit(X_train, y_train)

grid_search.best_estimator_ 
forest = grid_search.best_estimator_

print(forest.score(X_test, y_test))
# out:
0.78125
              </code></pre>
              PoczÄ…tkowo, przed zastosowaniem wielu poprawek  w modelu i przed uÅ¼yciem metody GridSearch modele osiÄ…gaÅ‚y celnoÅ›Ä‡ poniÅ¼ej 50%. 
              Obecna calnoÅ›Ä‡ modelu jest dla mnie nieco zaskakujÄ…ca. PozostaÅ‚o sprawdzenie na ile sensowne sÄ… przewidziane przez model oceny.
              Najpierw wykonano funkcjÄ™ do Å‚atwego sprawdzania oceny filmu.

              <pre><code>
def get_scoring(your_title):
    my_dict = {
        'title' : your_title
    }

    my_title = pd.DataFrame.from_dict([my_dict])

    for title_part in title_parts:
        my_title[title_part] = my_title['title'].apply(lambda x: get_part(x, title_part))

    return forest.predict(my_title.drop('title', axis=1))[0]
              </code></pre>

              NastÄ™pnie sprawdzono kilka tytuÅ‚Ã³w i przewidziane dla nich oceny. PoniÅ¼ej przedstawiono kilka wynikÃ³w.

              <pre><code>
get_scoring("House of demons")
# out:
'Decent'

get_scoring("House of demon zombies")
# out:
'Awful'

get_scoring("Blood of demon children")
# out:
'Decent'

get_scoring("Zombie devils and mummy of the moonscar") # tu wrzucono 5 czÅ‚onÃ³w
# out:
'Decent'

get_scoring('Sharks vs zombies vs bloody mummy 3D')
# out:
'Awful'

get_scoring('Fear the Mummy!')
# out:
'Good'

get_scoring('American Exorcist')
# out:
'Decent'
              </code></pre>



            <br><br>
            <h4 id="wnioski-header">7. Wnioski</h4>
              Model, ktÃ³ry pierwotnie byÅ‚ jedynie niepowaÅ¼nym Å¼artem, okazaÅ‚ siÄ™ doÅ›Ä‡ celny. 
              ChoÄ‡ nie moÅ¼na o nim powiedzieÄ‡, Å¼e ma prawdziwie praktyczne zastosowanie, speÅ‚nia on pierwotnie zamierzonÄ… funkcjÄ™. PoniÅ¼ej zamieszczono parÄ™ wnioskÃ³w i uwag.
            <li>Model byÅ‚ oparty na bardzo maÅ‚ej iloÅ›ci danych, mimo to udaÅ‚o siÄ™ coÅ› z nich wyciÄ…gnÄ…Ä‡.</li>
            <li>Model wskazuje wszystkie spoÅ›rÃ³d 3 moÅ¼liwych ocen.</li>
            <li>IloÅ›Ä‡ czÅ‚onÃ³w nie ma znaczenia, model w pewnym sensie wyprowadza 'uÅ›rednienie' czÅ‚onÃ³w.</li>
            <li>WczeÅ›niej przedstawiona korelacja okazaÅ‚a siÄ™ w caÅ‚kiem prawdziwa - np. czÅ‚on 'Zombie' zaniÅ¼a oceny tytuÅ‚Ã³w, ale nie do takiego stopnia, Å¼e kaÅ¼dy film z tym czÅ‚onem dostanie ocenÄ™ 'Awful'.</li>
            <li>Ciekawe, jak na model wpÅ‚ynÄ™Å‚aby by obecnoÅ›Ä‡ cech takich jak budÅ¼et i przychÃ³d. 
              Najprostszym sposobem byÅ‚oby sprawdzenie, czy film zarobiÅ‚ lub nie, lub jaki jest stosunek budÅ¼etu do przychodu. 
              Najpewniej wiÄ™kszoÅ›Ä‡ filmÃ³w, ktÃ³re na siebie nie zarobiÅ‚y miaÅ‚yby negatywne oceny.
              Jednak moÅ¼e zaistniaÅ‚a by taka sytuacja, gdzie film nie zarobiÅ‚ na siebie, a otrzymaÅ‚ pozytywnÄ… ocenÄ™. W jaki sposÃ³b czÅ‚ony tytuÅ‚u takich filmÃ³w wpÅ‚ynÄ™Å‚yby na model?</li>







          </div>

        </div>
      </span>
        <div class="col-md-3"> <!-- SIDEBAR -->
          <div class="sticky">
            <p>Nawigacja:</p>
            <a href="#wstep-header">1. WstÄ™p</a> <br>
            <a href="#analiza_zestawu_danych-header">2. Analiza zestawu danych</a> <br>
            <a href="#wizualizacja-header">3. Wizualizacja danych</a> <br>
            <a href="#uwagi-header" style="margin-left:15px">Uwagi dotyczÄ…ce korelacji</a> <br>
            <a href="#modelowanie-header">6. Modelowanie</a> <br>
            <a href="#wnioski-header">7. Wnioski</a> <br>
          </div>
        </div>
    </div>
      


    <div id="footer", class="bottom", style="font-size:0.77em;">      
          <p style="margin:5px;">&copy; <script>document.write(new Date().getFullYear());</script> Konrad Jarominiak</p>
          <p>Wykorzystano:
            <a href="https://getbootstrap.com/" class="footer-link">Bootsrap 5</a>,
            <a href="https://highlightjs.org/" class="footer-link">highlight.js</a>,
            <a href="https://www.mathjax.org/" class="footer-link">MathJax</a> </p>
      
        </div>

    <script>hljs.highlightAll();</script>
  </body>
</html>